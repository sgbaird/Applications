(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    238153,       6233]
NotebookOptionsPosition[    220116,       5856]
NotebookOutlinePosition[    222345,       5914]
CellTagsIndexPosition[    222258,       5909]
WindowTitle->EmbedStructure
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[GridBox[{
   {Cell["MAXRD SYMBOL", "PacletNameCell"], Cell[TextData[{
     Cell[BoxData[
      ActionMenuBox[
       FrameBox[
        InterpretationBox[Cell[TextData[{
          "Tutorials",
          StyleBox[" \[FilledDownTriangle]", "AnchorBarArrow",
           StripOnInput->False]
         }]],
         TextCell[
          Row[{"Tutorials", 
            Style[" \[FilledDownTriangle]", "AnchorBarArrow"]}]]],
        StripOnInput->False], {"\<\"Using the rotation options\"\>":>
       Documentation`HelpLookup["paclet:MaXrd/tutorial/UsingRotationMaps"]},
       Appearance->None,
       MenuAppearance->Automatic,
       MenuStyle->"Tutorials"]],
      LineSpacing->{1.4, 0}],
     "\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\
\[ThickSpace]",
     Cell[BoxData[
      ActionMenuBox[
       FrameBox[
        InterpretationBox[Cell[TextData[{
          "See Also",
          StyleBox[" \[FilledDownTriangle]", "AnchorBarArrow",
           StripOnInput->False]
         }]],
         TextCell[
          Row[{"See Also", 
            Style[" \[FilledDownTriangle]", "AnchorBarArrow"]}]]],
        StripOnInput->False], {"\<\"$CrystalData\"\>":>
       Documentation`HelpLookup[
       "paclet:MaXrd/ref/$CrystalData"], "\<\"CrystalPlot\"\>":>
       Documentation`HelpLookup[
       "paclet:MaXrd/ref/CrystalPlot"], "\<\"ExpandCrystal\"\>":>
       Documentation`HelpLookup[
       "paclet:MaXrd/ref/ExpandCrystal"], "\<\"DistortStructure\"\>":>
       Documentation`HelpLookup[
       "paclet:MaXrd/ref/DistortStructure"], "\<\"SynthesiseStructure\"\>":>
       Documentation`HelpLookup[
       "paclet:MaXrd/ref/SynthesiseStructure"], \
"\<\"SimulateDiffractionPattern\"\>":>Documentation`HelpLookup[
       "paclet:MaXrd/ref/SimulateDiffractionPattern"], \
"\<\"GetCrystalMetric\"\>":>Documentation`HelpLookup[
       "paclet:MaXrd/ref/GetCrystalMetric"], "\<\"GetLatticeParameters\"\>":>
       Documentation`HelpLookup[
       "paclet:MaXrd/ref/GetLatticeParameters"], "\<\"InputCheck\"\>":>
       Documentation`HelpLookup[
       "paclet:MaXrd/ref/InputCheck"], "\<\"ToStandardSetting\"\>":>
       Documentation`HelpLookup[
       "paclet:MaXrd/ref/ToStandardSetting"], "\<\"CrystalFormulaUnits\"\>":>
       Documentation`HelpLookup[
       "paclet:MaXrd/ref/CrystalFormulaUnits"], "\<\"ExportCrystalData\"\>":>
       Documentation`HelpLookup["paclet:MaXrd/ref/ExportCrystalData"]},
       Appearance->None,
       MenuAppearance->Automatic,
       MenuStyle->"SeeAlso"]],
      LineSpacing->{1.4, 0}],
     "\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\
\[ThickSpace]",
     Cell[BoxData[
      ActionMenuBox[
       FrameBox[
        InterpretationBox[Cell[TextData[{
          "Related Guides",
          StyleBox[" \[FilledDownTriangle]", "AnchorBarArrow",
           StripOnInput->False]
         }]],
         TextCell[
          Row[{"Related Guides", 
            Style[" \[FilledDownTriangle]", "AnchorBarArrow"]}]]],
        StripOnInput->
         False], {"\<\"MaXrd: Mathematica X-ray diffraction package\"\>":>
       Documentation`HelpLookup["paclet:MaXrd/guide/MaXrd"]},
       Appearance->None,
       MenuAppearance->Automatic,
       MenuStyle->"MoreAbout"]],
      LineSpacing->{1.4, 0}],
     "\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\
\[ThickSpace]",
     Cell[BoxData[
      ActionMenuBox[
       FrameBox[
        InterpretationBox[Cell[TextData[{
          "URL",
          StyleBox[" \[FilledDownTriangle]", "AnchorBarArrow",
           StripOnInput->False]
         }]],
         TextCell[
          Row[{"URL", 
            Style[" \[FilledDownTriangle]", "AnchorBarArrow"]}]]],
        StripOnInput->False], {"\<\"MaXrd/ref/EmbedStructure\"\>":>
       None, "\<\"Copy Wolfram Documentation Center URL\"\>":>
       Module[{DocumentationSearch`Private`nb$}, 
        DocumentationSearch`Private`nb$ = NotebookPut[
           Notebook[{
             Cell["MaXrd/ref/EmbedStructure"]}, Visible -> False]]; 
        SelectionMove[DocumentationSearch`Private`nb$, All, Notebook]; 
        FrontEndTokenExecute[DocumentationSearch`Private`nb$, "Copy"]; 
        NotebookClose[DocumentationSearch`Private`nb$]; Null], 
       Delimiter, "\<\"Copy web URL\"\>":>
       Module[{DocumentationSearch`Private`nb$}, 
        DocumentationSearch`Private`nb$ = NotebookPut[
           Notebook[{
             Cell[
              BoxData[
               MakeBoxes[
                Hyperlink[
                "http://reference.wolfram.com/language/MaXrd/ref/\
EmbedStructure.html"], StandardForm]], "Input", TextClipboardType -> 
              "PlainText"]}, Visible -> False]]; 
        SelectionMove[DocumentationSearch`Private`nb$, All, Notebook]; 
        FrontEndTokenExecute[DocumentationSearch`Private`nb$, "Copy"]; 
        NotebookClose[DocumentationSearch`Private`nb$]; 
        Null], "\<\"Go to web URL\"\>":>FrontEndExecute[{
         NotebookLocate[{
           URL[
            StringJoin[
             If[
              TrueQ[DocumentationBuild`Make`Private`wsmlinkQ$17111], 
              "http://reference.wolfram.com/system-modeler/", 
              "http://reference.wolfram.com/language/"], 
             "MaXrd/ref/EmbedStructure", ".html"]], None}]}]},
       Appearance->None,
       MenuAppearance->Automatic,
       MenuStyle->"URLMenu"]],
      LineSpacing->{1.4, 0}]
    }], "AnchorBar"]}
  }]], "AnchorBarGrid",
 CellID->1],

Cell[CellGroupData[{

Cell[TextData[{
 Cell["EmbedStructure", "ObjectName"],
 Cell[BoxData[
  TemplateBox[{8},
   "Spacer1"]]],
 Cell[BoxData[""], "ObjectNameTranslation"]
}], "ObjectNameGrid"],

Cell[BoxData[GridBox[{
   {"", Cell[TextData[{
     Cell[BoxData[
      RowBox[{
       TemplateBox[{
         Cell[
          TextData["EmbedStructure"]], "paclet:MaXrd/ref/EmbedStructure"},
        "RefLink",
        BaseStyle->{"InlineFormula"}], "[", 
       RowBox[{
        StyleBox["guestUnits", "TI"], ",", 
        StyleBox["targetPositions", "TI"], ",", 
        StyleBox["hostCrystal", "TI"]}], "]"}]], "InlineFormula"],
     " \[LineSeparator]embeds ",
     Cell[BoxData[
      StyleBox["guestUnits", "TI"]], "InlineFormula"],
     " at ",
     Cell[BoxData[
      StyleBox["targetPositions", "TI"]], "InlineFormula"],
     " into ",
     Cell[BoxData[
      StyleBox["hostCrystal", "TI"]], "InlineFormula"],
     "."
    }]]}
  }]], "Usage",
 GridBoxOptions->{
 GridBoxBackground->{"Columns" -> {{None}}, "Rows" -> {{None}}}},
 CellID->982511436]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[Cell[BoxData[
 ButtonBox[Cell[TextData[{
   Cell[BoxData[
    TemplateBox[{6},
     "Spacer1"]]],
   "Details and Options"
  }], "NotesFrameText"],
  Appearance->{Automatic, None, "Normal", Automatic},
  BaseStyle->None,
  ButtonFunction:>(FrontEndExecute[{
     FrontEnd`SelectionMove[
      FrontEnd`SelectedNotebook[], All, ButtonCell], 
     FrontEndToken["OpenCloseGroup"], 
     FrontEnd`SelectionMove[
      FrontEnd`SelectedNotebook[], After, CellContents]}]& ),
  Evaluator->None,
  Method->"Preemptive"]]]], "NotesSection",
 WholeCellGroupOpener->True,
 CellGroupingRules->{"SectionGrouping", 50},
 CellID->1971639738],

Cell["", "SectionHeaderSpacer"],

Cell[TextData[{
 "This function mutates ",
 Cell[BoxData[
  StyleBox["hostCrystal", "TI"]], "InlineFormula"],
 ". Use the ",
 Cell[BoxData["\"\<NewLabel\>\""], "InlineFormula"],
 " option to create a new structure/crystal instance."
}], "Notes",
 CellID->924159584],

Cell[TextData[{
 "In the following, by ",
 Cell[BoxData[
  StyleBox["entity", "TI"]], "InlineFormula"],
 " we mean either the symbol of a chemical element (",
 StyleBox["e.g.",
  FontSlant->"Italic"],
 " ",
 Cell[BoxData["\"\<Fe\>\""], "InlineFormula"],
 " or ",
 Cell[BoxData["\"\<Au\>\""], "InlineFormula"],
 ") or a key in the ",
 Cell[BoxData[
  TemplateBox[{
    Cell[
     TextData["$CrystalData"]], "paclet:MaXrd/ref/$CrystalData"},
   "RefLink",
   BaseStyle->{"InlineFormula"}]], "InlineFormula"],
 " association (",
 StyleBox["e.g.",
  FontSlant->"Italic"],
 " ",
 Cell[BoxData["\"\<Diamond\>\""], "InlineFormula"],
 " or ",
 Cell[BoxData["\"\<LanthanumHexaboride\>\""], "InlineFormula"],
 "). The ",
 Cell[BoxData[
  StyleBox["guestUnits", "TI"]], "InlineFormula"],
 " can take these forms:"
}], "Notes",
 CellID->1990679746],

Cell[BoxData[GridBox[{
   {Cell["      ", "TableRowIcon"], 
    RowBox[{"{", 
     StyleBox["entity", "TI"], "}"}], Cell[
    "a single crystal object or chemical element", "TableText"]},
   {Cell["      ", "TableRowIcon"], 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox[
       StyleBox["entity", "TI"], 
       StyleBox["1", "TR"]], ",", " ", 
      SubscriptBox[
       StyleBox["entity", "TI"], 
       StyleBox["2", "TR"]], ",", " ", 
      StyleBox["\[Ellipsis]", "TR"]}], "}"}], Cell[
    "a list of several crystals or elements", "TableText"]},
   {Cell["      ", "TableRowIcon"], 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        SubscriptBox[
         StyleBox["p", "TI"], 
         StyleBox["1", "TR"]], ",", 
        SubscriptBox[
         StyleBox["p", "TI"], 
         StyleBox["2", "TR"]], ",", 
        StyleBox["\[Ellipsis]", "TR"]}], "}"}], "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        SubscriptBox[
         StyleBox["entity", "TI"], 
         StyleBox["1", "TR"]], ",", 
        SubscriptBox[
         StyleBox["entity", "TI"], 
         StyleBox["2", "TR"]], ",", 
        StyleBox["\[Ellipsis]", "TR"]}], "}"}]}], "}"}], Cell[
    "a shuffled distribution of such entities", "TableText"]},
   {Cell["      ", "TableRowIcon"], 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       SubscriptBox[
        StyleBox["cond", "TI"], 
        StyleBox["1", "TR"]], "\[Rule]", 
       SubscriptBox[
        StyleBox["entity", "TI"], 
        StyleBox["1", "TR"]]}], ",", 
      RowBox[{
       SubscriptBox[
        StyleBox["cond", "TI"], 
        StyleBox["2", "TR"]], "\[Rule]", 
       SubscriptBox[
        StyleBox["entity", "TI"], 
        StyleBox["2", "TR"]]}], ",", 
      StyleBox["\[Ellipsis]", "TR"]}], "}"}], Cell[TextData[{
     "a list of ",
     Cell[BoxData[
      TemplateBox[{
        Cell[
         TextData["Condition"]], "paclet:ref/Condition"},
       "RefLink",
       BaseStyle->{"InlineFormula"}]], "InlineFormula"],
     " rules that constrain the placement of entities"
    }], "TableText"]}
  }]], "2ColumnTableMod",
 GridBoxOptions->{
 GridBoxBackground->{
  "Columns" -> {{None}}, "Rows" -> {None, None, None, {None}}},
 GridBoxDividers->{"Rows" -> {{True, True, True, True, True}}}},
 CellID->2028755750],

Cell[TextData[{
 "When using a list of ",
 Cell[BoxData[
  TemplateBox[{
    Cell[
     TextData["Condition"]], "paclet:ref/Condition"},
   "RefLink",
   BaseStyle->{"InlineFormula"}]], "InlineFormula"],
 "s, each coordinate in ",
 Cell[BoxData[
  StyleBox["targetPosition", "TI"]], "InlineFormula"],
 " will pass through the conditions in order. If the coordinate tuple does \
not match any of them, the last entry in ",
 Cell[BoxData[
  StyleBox["guestUnits", "TI"]], "InlineFormula"],
 " will be used as default."
}], "Notes",
 CellID->37393551],

Cell[TextData[{
 "The special label ",
 Cell[BoxData["\"\<Void\>\""], "InlineFormula"],
 " can be used to signal a vacancy/absence of embedding."
}], "Notes",
 CellID->1605903337],

Cell[TextData[{
 "Chemical element symbols can also be used in ",
 Cell[BoxData[
  StyleBox["guestUnits", "TI"]], "InlineFormula"],
 ", and will correspond to insertion of single atoms of the given type."
}], "Notes",
 CellID->178674951],

Cell[TextData[{
 Cell[BoxData[
  StyleBox["targetPosition", "TI"]], "InlineFormula"],
 " should be a list of three-dimensional coordinate tuples."
}], "Notes",
 CellID->255599014],

Cell["Options:", "Notes",
 CellID->1067943069],

Cell[BoxData[GridBox[{
   {Cell["      ", "TableRowIcon"], "\"\<DataFile\>\"", 
    RowBox[{"FileNameJoin", "[", 
     RowBox[{"{", 
      RowBox[{
      "$MaXrdPath", ",", "\"\<UserData\>\"", ",", "\"\<CrystalData.m\>\""}], 
      "}"}], "]"}], Cell["path to data file", "TableText"]},
   {Cell["      ", "TableRowIcon"], "\"\<Distortions\>\"", 
    RowBox[{"{", 
     RowBox[{"0", ",", " ", "0", ",", " ", "0"}], "}"}], Cell[TextData[{
     "set shift amplitudes [",
     Cell[BoxData[
      FormBox["\[CapitalARing]", TraditionalForm]], "InlineMath"],
     "] (constant or range)"
    }], "TableText"]},
   {Cell["      ", "TableRowIcon"], "\"\<DistortionType\>\"", 
    "\"\<Cartesian\>\"", Cell[TextData[{
     "interpret distortions in terms of \[ARing]ngstr\[ODoubleDot]ms in the x\
\[Dash]y\[Dash]z directions (",
     StyleBox["\"Cartesian\"", "InlineCode"],
     ") or fractions of host unit cell in a\[Dash]b\[Dash]c directions (",
     StyleBox["\"Crystallographic\"", "InlineCode"],
     ")"
    }], "TableText"]},
   {Cell["      ", "TableRowIcon"], "\"\<MatchHostSize\>\"", 
    ButtonBox["True",
     BaseStyle->"Link",
     ButtonData->"paclet:ref/True"], Cell[TextData[{
     "expand ",
     Cell[BoxData[
      StyleBox["targetPositions", "TI"]], "InlineFormula"],
     " to match host structure size"
    }], "TableText"]},
   {Cell["      ", "TableRowIcon"], "\"\<NewLabel\>\"", "\"\<\>\"", Cell[
    TextData[{
     "label to use for the new structure (will overwrite ",
     Cell[BoxData[
      StyleBox["hostCrystal", "TI"]], "InlineFormula"],
     " by default)"
    }], "TableText"]},
   {Cell["      ", "TableRowIcon"], "\"\<OverlapPrecedence\>\"", "\"\<\>\"", 
    Cell[TextData[{
     "which atom group to keep if there are overlapping atoms (",
     Cell[BoxData["\"\<Host\>\""], "InlineFormula"],
     " or ",
     Cell[BoxData["\"\<Guest\>\""], "InlineFormula"],
     ")"
    }], "TableText"]},
   {Cell["      ", "TableRowIcon"], "\"\<OverlapRadius\>\"", "1.0", Cell[
    TextData[{
     "threshold [",
     Cell[BoxData[
      FormBox["\[CapitalARing]", TraditionalForm]], "InlineMath"],
     "] for asserting overlap"
    }], "TableText"]},
   {Cell["      ", "TableRowIcon"], "\"\<ShowProgess\>\"", 
    ButtonBox["False",
     BaseStyle->"Link",
     ButtonData->"paclet:ref/False"], Cell[
    "whether to display a progress bar", "TableText"]},
   {Cell["      ", "TableRowIcon"], "\"\<TrimBoundary\>\"", "\"\<None\>\"", 
    Cell["\<\
procedure to remove atoms at our outside boundaries after embedding\
\>", "TableText"]}
  }]], "3ColumnTableMod",
 GridBoxOptions->{
 GridBoxBackground->{
  "Columns" -> {{None}}, 
   "Rows" -> {None, None, None, None, None, None, None, None, {None}}},
 GridBoxDividers->{
  "Rows" -> {{True, True, True, True, True, True, True, True, True, True}}}},
 CellID->1917123225],

Cell[TextData[{
 "Rotation options (see also the tutorial ",
 StyleBox[ButtonBox["Using the rotation options",
  BaseStyle->"Link",
  ButtonData->"paclet:MaXrd/tutorial/UsingRotationMaps"],
  FontSlant->"Italic"],
 "):"
}], "Notes",
 CellID->956015342],

Cell[BoxData[GridBox[{
   {Cell["      ", "TableRowIcon"], "\"\<RotationAnchorReference\>\"", 
    "\"\<Unit\>\"", Cell[
    "which type of point to perform rotation about", "TableText"]},
   {Cell["      ", "TableRowIcon"], "\"\<RotationAnchorShift\>\"", 
    RowBox[{"{", 
     RowBox[{"0", ",", " ", "0", ",", " ", "0"}], "}"}], Cell[
    "translation of the anchor point", "TableText"]},
   {Cell["      ", "TableRowIcon"], "\"\<RotationAxes\>\"", 
    RowBox[{
     ButtonBox["IdentityMatrix",
      BaseStyle->"Link",
      ButtonData->"paclet:ref/IdentityMatrix"], "[", "3", "]"}], Cell[
    "three vectors defining the rotation axes", "TableText"]},
   {Cell["      ", "TableRowIcon"], "\"\<Rotations\>\"", 
    RowBox[{"{", 
     RowBox[{"0", ",", " ", "0", ",", " ", "0"}], "}"}], Cell[TextData[{
     "set rotation angles [",
     Cell[BoxData[
      FormBox["\[Degree]", TraditionalForm]], "InlineMath"],
     "] (constant or range)"
    }], "TableText"]}
  }]], "3ColumnTableMod",
 GridBoxOptions->{
 GridBoxBackground->{
  "Columns" -> {{None}}, "Rows" -> {None, None, None, {None}}},
 GridBoxDividers->{"Rows" -> {{True, True, True, True, True}}}},
 CellID->1566765895],

Cell[TextData[{
 Cell[BoxData["\"\<Distortions\>\""], "InlineFormula"],
 " should be a list of three entries, each either being a number describing a \
constant shift or a pair of numbers describing a minimum\[Dash]maximum range \
for the shift. Each time a unit is to be placed at a targeted position, \
either the constant shift or a pseudorandom number in the given range is \
added to its position. The input numbers are assumed to be in either \
\[ARing]ngstr\[ODoubleDot]ms or fractional coordinates of the ",
 Cell[BoxData[
  StyleBox["hostCrystal", "TI"]], "InlineFormula"],
 "'s unit cell (see the ",
 Cell[BoxData["\"\<DistortionType\>\""], "InlineFormula"],
 " option).\[LineSeparator]",
 Cell[BoxData["\"\<Rotations\>\""], "InlineFormula"],
 " works analogously, but corresponds to a rotation transformation. The input \
is then assumed to describe a rotation about the axes specified by ",
 Cell[BoxData["\"\<RotationAxes\>\""], "InlineFormula"],
 " option. Values are assumed to be in the unit of radians."
}], "Notes",
 CellID->128330510],

Cell[TextData[{
 Cell[BoxData["\"\<Distortions\>\""], "InlineFormula"],
 " and ",
 Cell[BoxData["\"\<Rotations\>\""], "InlineFormula"],
 " input can be mixed numbers and pairs of numbers, or a list of rules where \
conditions on coordinates point to such numbers or pairs of numbers. If no \
conditions match a given coordinate tuple no distortion/rotation is \
performed. Some examples:"
}], "Notes",
 CellID->323180187],

Cell[BoxData[GridBox[{
   {Cell["      ", "TableRowIcon"], 
    RowBox[{"\"\<Distortions\>\"", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"{", 
        RowBox[{"2", ",", "5"}], "}"}], ",", "3"}], "}"}]}], Cell[TextData[{
     "distorts each embedded structure by a random amount between ",
     Cell[BoxData[
      FormBox[
       RowBox[{"2", " ", "\[Dash]", 
        RowBox[{"5", "\[CapitalARing]"}]}], TraditionalForm]], "InlineMath"],
     " in the ",
     Cell[BoxData[
      FormBox["y", TraditionalForm]], "InlineMath"],
     "-direction and a constant amount by ",
     Cell[BoxData[
      FormBox[
       RowBox[{"3", "\[CapitalARing]"}], TraditionalForm]], "InlineMath"],
     " in the ",
     Cell[BoxData[
      FormBox["z", TraditionalForm]], "InlineMath"],
     "-direction."
    }], "TableText"]},
   {Cell["      ", "TableRowIcon"], 
    RowBox[{"\"\<Rotations\>\"", "\[Rule]", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"x_", ",", "y_", ",", "z_"}], "}"}], "/;", 
        RowBox[{"y", ">", "2"}]}], "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"90", "\[Degree]"}], ",", "0", ",", 
         RowBox[{"25", "\[Degree]"}]}], "}"}]}], "\[IndentingNewLine]", 
      "}"}]}], Cell[TextData[{
     "rotates all embedded structures placed at a position such that ",
     Cell[BoxData[
      FormBox[
       RowBox[{"y", ">", "2"}], TraditionalForm]], "InlineMath"],
     " by ",
     Cell[BoxData[
      FormBox[
       RowBox[{"90", "\[Degree]"}], TraditionalForm]], "InlineMath"],
     " about the ",
     Cell[BoxData[
      FormBox["x", TraditionalForm]], "InlineMath"],
     "-axis and ",
     Cell[BoxData[
      FormBox[
       RowBox[{"25", "\[Degree]"}], TraditionalForm]], "InlineMath"],
     " about the ",
     Cell[BoxData[
      FormBox["z", TraditionalForm]], "InlineMath"],
     "-axis."
    }], "TableText"]}
  }]], "2ColumnTableMod",
 GridBoxOptions->{
 GridBoxBackground->{"Columns" -> {{None}}, "Rows" -> {None, {None}}},
 GridBoxDividers->{"Rows" -> {{True, True, True}}}},
 CellID->1854789889],

Cell["\<\
When using conditions, each coordinate that is to be tested will fall through \
the list of conditions until the first match occurs. If no condition match, \
the rotation/distortion for that input will be zero.\
\>", "Notes",
 CellID->700200527],

Cell[TextData[{
 "The following settings are available for ",
 Cell[BoxData["\"\<TrimBoundary\>\""], "InlineFormula"],
 ":"
}], "Notes",
 CellID->633941708],

Cell[BoxData[GridBox[{
   {Cell["      ", "TableRowIcon"], "\"\<Box\>\"", Cell["\<\
deletes all atoms with any coordinate being negative or larger than the host \
structure size \
\>", "TableText"]},
   {Cell["      ", "TableRowIcon"], "\"\<None\>\"", Cell[
    "no filtering is performed", "TableText"]},
   {Cell["      ", "TableRowIcon"], "\"\<OuterEdges\>\"", Cell[TextData[{
     "deletes all atoms with any ",
     Cell[BoxData[
      FormBox[
       RowBox[{"(", 
        RowBox[{"x", ",", "y"}], ")"}], TraditionalForm]], "InlineMath"],
     " being negative or larger than the host structure size"
    }], "TableText"]}
  }]], "2ColumnTableMod",
 GridBoxOptions->{
 GridBoxBackground->{"Columns" -> {{None}}, "Rows" -> {None, None, {None}}},
 GridBoxDividers->{"Rows" -> {{True, True, True, True}}}},
 CellID->837998243],

Cell[TextData[{
 "The default action of ",
 Cell[BoxData["\"\<OverlapPrecedence\>\""], "InlineFormula"],
 " is to ",
 StyleBox["not",
  FontSlant->"Italic"],
 " check for any overlapping atoms. Checks are only performed if it is set to \
either ",
 Cell[BoxData["\"\<Host\>\""], "InlineFormula"],
 " or ",
 Cell[BoxData["\"\<Guest\>\""], "InlineFormula"],
 "."
}], "Notes",
 CellID->1920663168],

Cell[TextData[{
 Cell[BoxData[
  TemplateBox[{
    Cell[
     TextData["Chop"]], "paclet:ref/Chop"},
   "RefLink",
   BaseStyle->{"InlineFormula"}]], "InlineFormula"],
 " is applied to all coordinates with a tolerance of ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["10", 
    RowBox[{"-", "6"}]], TraditionalForm]], "InlineMath"],
 "."
}], "Notes",
 CellID->991443164],

Cell["", "SectionFooterSpacer"]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  TemplateBox[{6},
   "Spacer1"]]],
 "Examples",
 "\[NonBreakingSpace]\[NonBreakingSpace]",
 Cell["(13)", "ExampleCount"]
}], "PrimaryExamplesSection",
 WholeCellGroupOpener->True,
 CellTags->"PrimaryExamplesSection",
 CellID->1676403356],

Cell[CellGroupData[{

Cell[TextData[{
 "Basic Examples",
 "\[NonBreakingSpace]\[NonBreakingSpace]",
 Cell["(5)", "ExampleCount"]
}], "ExampleSection", "ExampleSection",
 WholeCellGroupOpener->True,
 CellID->325755652],

Cell[TextData[{
 "In this example we embed a single iron atom into ",
 StyleBox["Ice",
  FontSlant->"Italic"],
 ". Let use place it at ",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", 
    RowBox[{"0.5", ",", "0.5", ",", "0.5"}], ")"}], TraditionalForm]], 
  "InlineMath"],
 " in the ice structure."
}], "ExampleText",
 CellID->1912593623],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"EmbedStructure", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"{", "\"\<Fe\>\"", "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"0.5", ",", "0.5", ",", "0.5"}], "}"}], "}"}], ",", 
   "\[IndentingNewLine]", "\"\<Ice\>\"", ",", "\[IndentingNewLine]", 
   RowBox[{"\"\<NewLabel\>\"", "\[Rule]", "\"\<IronIce\>\""}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->"In[1]:=",
 CellID->133271135],

Cell[BoxData["\<\"IronIce\"\>"], "Output",
 CellLabel->"Out[1]=",
 CellID->210866368]
}, Open  ]],

Cell[TextData[{
 "We can use ",
 Cell[BoxData[
  TemplateBox[{
    Cell[
     TextData["CrystalPlot"]], "paclet:MaXrd/ref/CrystalPlot"},
   "RefLink",
   BaseStyle->{"InlineFormula"}]], "InlineFormula"],
 " to visualise the new structure:"
}], "ExampleText",
 CellID->404399049],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CrystalPlot", "[", 
  RowBox[{"\"\<IronIce\>\"", ",", 
   RowBox[{"ViewPoint", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"0.0", ",", 
      RowBox[{"-", "4.8"}], ",", "3.4"}], "}"}]}]}], "]"}]], "Input",
 CellLabel->"In[2]:=",
 CellID->1617847216],

Cell[BoxData[
 Graphics3DBox[{
   {RGBColor[1, 0, 0], Arrow3DBox[Line3DBox[{{0, 0, 0}, {7.82, 0., 0.}}]]}, 
   {RGBColor[0, 1, 0], 
    Arrow3DBox[Line3DBox[{{0, 0, 0}, {-3.91, 6.77231865759431, 0.}}]]}, 
   {RGBColor[0, 0, 1], Arrow3DBox[Line3DBox[{{0, 0, 0}, {0., 0., 7.36}}]]}, 
   {GrayLevel[0], 
    Line3DBox[{{-3.91, 6.77231865759431, 0.}, {3.91, 6.77231865759431, 0.}}]}, 
   {GrayLevel[0], 
    Line3DBox[{{7.82, 0., 0.}, {3.91, 6.77231865759431, 0.}}]}, 
   {GrayLevel[0], Line3DBox[{{7.82, 0., 0.}, {7.82, 0., 7.36}}]}, 
   {GrayLevel[0], 
    Line3DBox[{{-3.91, 6.77231865759431, 0.}, {-3.91, 6.77231865759431, 
     7.36}}]}, 
   {GrayLevel[0], 
    Line3DBox[{{3.91, 6.77231865759431, 0.}, {3.91, 6.77231865759431, 
     7.36}}]}, 
   {GrayLevel[0], Line3DBox[{{0., 0., 7.36}, {7.82, 0., 7.36}}]}, 
   {GrayLevel[0], 
    Line3DBox[{{0., 0., 7.36}, {-3.91, 6.77231865759431, 7.36}}]}, 
   {GrayLevel[0], 
    Line3DBox[{{-3.91, 6.77231865759431, 7.36}, {3.91, 6.77231865759431, 
     7.36}}]}, 
   {GrayLevel[0], 
    Line3DBox[{{7.82, 0., 7.36}, {3.91, 6.77231865759431, 7.36}}]}, 
   {RGBColor[0.800498, 0.201504, 0.192061], Opacity[1.], 
    SphereBox[{{2.606406, 0., 0.46}, {5.213594, 0., 6.9}}, 0.66]}, 
   {RGBColor[0.65, 0.7, 0.7], Opacity[1.], 
    SphereBox[{{2.606406, 0., 1.28064}, {3.42516, 0., 0.19136}, {5.62649, 
     0.7110934590474025, 7.176}}, 0.31]}, 
   {RGBColor[0.878431, 0.4, 0.2], Opacity[1.], 
    SphereBox[{{1.955, 3.386159328797155, 3.68}}, 1.32]}},
  ControllerMethod -> Automatic,
  AlignmentPoint->Center,
  AspectRatio->Automatic,
  Axes->False,
  AxesEdge->Automatic,
  AxesLabel->None,
  AxesOrigin->Automatic,
  AxesStyle->{},
  Background->None,
  BaseStyle->{},
  BaselinePosition->Automatic,
  BoxRatios->Automatic,
  BoxStyle->{},
  Boxed->False,
  ClipPlanes->None,
  ClipPlanesStyle->Automatic,
  ColorOutput->Automatic,
  ContentSelectable->Automatic,
  ControllerLinking->False,
  ControllerPath->Automatic,
  CoordinatesToolOptions:>Automatic,
  DisplayFunction->Identity,
  Epilog->{},
  FaceGrids->None,
  FaceGridsStyle->{},
  FormatType->TraditionalForm,
  ImageMargins->0.,
  ImagePadding->All,
  ImageSize->Automatic,
  ImageSizeRaw->Automatic,
  LabelStyle->{},
  Lighting->"Neutral",
  Method->Automatic,
  PlotLabel->None,
  PlotRange->All,
  PlotRangePadding->Automatic,
  PlotRegion->Automatic,
  PreserveImageOptions->Automatic,
  Prolog->{},
  RotationAction->"Fit",
  SphericalRegion->True,
  Ticks->Automatic,
  TicksStyle->{},
  TouchscreenAutoZoom->False,
  ViewAngle->Automatic,
  ViewCenter->Automatic,
  ViewMatrix->Automatic,
  ViewPoint->{0., -4.8, 3.4},
  ViewProjection->Automatic,
  ViewRange->All,
  ViewVector->Automatic,
  ViewVertical->{0, 0, 1}]], "Output",
 CellLabel->"Out[2]=",
 CellID->2003036261]
}, Open  ]],

Cell[TextData[{
 "Note that we have embedded iron into the asymmetric unit of ",
 StyleBox["Ice",
  FontSlant->"Italic"],
 " (consisting of five atoms). If we wanted to put it in an ice \
network/structure, we could have used ",
 Cell[BoxData[
  TemplateBox[{
    Cell[
     TextData["ExpandCrystal"]], "paclet:MaXrd/ref/ExpandCrystal"},
   "RefLink",
   BaseStyle->{"InlineFormula"}]], "InlineFormula"],
 " on ",
 StyleBox["Ice",
  FontSlant->"Italic"],
 " beforehand."
}], "ExampleText",
 CellID->1488703067],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[Cell["\t", "ExampleDelimiter"],
  $Line = 0; Null]], "ExampleDelimiter",
 CellID->1314178903],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CrystalPlot", "@", 
  RowBox[{"EmbedStructure", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", "\"\<GalliumArsenide\>\"", "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"0.75", ",", "0.75", ",", "0.75"}], "}"}], "}"}], ",", 
    "\[IndentingNewLine]", "\"\<Sodalite\>\"", ",", 
    RowBox[{"\"\<NewLabel\>\"", "\[Rule]", "\"\<DemoStructure\>\""}]}], 
   "]"}]}]], "Input",
 CellLabel->"In[1]:=",
 CellID->1530433439],

Cell[BoxData[
 Graphics3DBox[{
   {RGBColor[1, 0, 0], Arrow3DBox[Line3DBox[{{0, 0, 0}, {8.875, 0., 0.}}]]}, 
   {RGBColor[0, 1, 0], Arrow3DBox[Line3DBox[{{0, 0, 0}, {0., 8.875, 0.}}]]}, 
   {RGBColor[0, 0, 1], Arrow3DBox[Line3DBox[{{0, 0, 0}, {0., 0., 8.875}}]]}, 
   {GrayLevel[0], Line3DBox[{{0., 8.875, 0.}, {8.875, 8.875, 0.}}]}, 
   {GrayLevel[0], Line3DBox[{{8.875, 0., 0.}, {8.875, 8.875, 0.}}]}, 
   {GrayLevel[0], Line3DBox[{{8.875, 0., 0.}, {8.875, 0., 8.875}}]}, 
   {GrayLevel[0], Line3DBox[{{0., 8.875, 0.}, {0., 8.875, 8.875}}]}, 
   {GrayLevel[0], Line3DBox[{{8.875, 8.875, 0.}, {8.875, 8.875, 8.875}}]}, 
   {GrayLevel[0], Line3DBox[{{0., 0., 8.875}, {8.875, 0., 8.875}}]}, 
   {GrayLevel[0], Line3DBox[{{0., 0., 8.875}, {0., 8.875, 8.875}}]}, 
   {GrayLevel[0], Line3DBox[{{0., 8.875, 8.875}, {8.875, 8.875, 8.875}}]}, 
   {GrayLevel[0], Line3DBox[{{8.875, 0., 8.875}, {8.875, 8.875, 8.875}}]}, 
   {RGBColor[0.658708, 0.492173, 0.842842], Opacity[1.], 
    SphereBox[{{1.5770875, 1.5770875, 1.5770875}}, 1.66]}, 
   {RGBColor[0.8913, 0.631904, 0.627399], Opacity[1.], 
    SphereBox[{{2.21875, 0., 4.4375}}, 1.21]}, 
   {RGBColor[0.941176, 0.784314, 0.627451], Opacity[1.], 
    SphereBox[{{2.21875, 4.4375, 0.}}, 1.11]}, 
   {RGBColor[0.800498, 0.201504, 0.192061], Opacity[1.], 
    SphereBox[{{1.2309625, 1.31705, 3.8828125}}, 0.66]}, 
   {RGBColor[0.412698, 0.932689, 0.166398], Opacity[1.], 
    SphereBox[{{0., 0., 0.}}, 1.02]}, 
   {RGBColor[0.800757, 0.542666, 0.533513], Opacity[1.], 
    SphereBox[{{6.65625, 6.65625, 6.65625}}, 1.22]}, 
   {RGBColor[0.741176, 0.501961, 0.890196], Opacity[1.], 
    SphereBox[{{8.0696, 8.0696, 8.0696}}, 1.19]}},
  ControllerMethod -> Automatic,
  AlignmentPoint->Center,
  AspectRatio->Automatic,
  Axes->False,
  AxesEdge->Automatic,
  AxesLabel->None,
  AxesOrigin->Automatic,
  AxesStyle->{},
  Background->None,
  BaseStyle->{},
  BaselinePosition->Automatic,
  BoxRatios->Automatic,
  BoxStyle->{},
  Boxed->False,
  ClipPlanes->None,
  ClipPlanesStyle->Automatic,
  ColorOutput->Automatic,
  ContentSelectable->Automatic,
  ControllerLinking->False,
  ControllerPath->Automatic,
  CoordinatesToolOptions:>Automatic,
  DisplayFunction->Identity,
  Epilog->{},
  FaceGrids->None,
  FaceGridsStyle->{},
  FormatType->TraditionalForm,
  ImageMargins->0.,
  ImagePadding->All,
  ImageSize->Automatic,
  ImageSizeRaw->Automatic,
  LabelStyle->{},
  Lighting->"Neutral",
  Method->Automatic,
  PlotLabel->None,
  PlotRange->All,
  PlotRangePadding->Automatic,
  PlotRegion->Automatic,
  PreserveImageOptions->Automatic,
  Prolog->{},
  RotationAction->"Fit",
  SphericalRegion->True,
  Ticks->Automatic,
  TicksStyle->{},
  TouchscreenAutoZoom->False,
  ViewAngle->Automatic,
  ViewCenter->Automatic,
  ViewMatrix->Automatic,
  ViewPoint->{1.3, -2.4, 2.},
  ViewProjection->Automatic,
  ViewRange->All,
  ViewVector->Automatic,
  ViewVertical->{0, 0, 1}]], "Output",
 CellLabel->"Out[1]=",
 CellID->1920323709]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[Cell["\t", "ExampleDelimiter"],
  $Line = 0; Null]], "ExampleDelimiter",
 CellID->80019424],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CrystalPlot", "[", 
  RowBox[{
   RowBox[{"EmbedStructure", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\"\<Fe\>\"", ",", "\"\<Tc\>\"", ",", "\"\<Ni\>\""}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"1", "/", "2"}], ",", 
        RowBox[{"1", "/", "2"}], ",", 
        RowBox[{"1", "/", "2"}]}], "}"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"ExpandCrystal", "[", 
      RowBox[{"\"\<Silicon\>\"", ",", 
       RowBox[{"{", 
        RowBox[{"3", ",", "3", ",", "3"}], "}"}]}], "]"}], ",", 
     RowBox[{"\"\<NewLabel\>\"", "\[Rule]", "\"\<DemoStructure\>\""}]}], 
    "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"ViewPoint", "\[Rule]", "Left"}]}], "]"}]], "Input",
 CellLabel->"In[1]:=",
 CellID->995987951],

Cell[BoxData[
 Graphics3DBox[{
   {RGBColor[1, 0, 0], Arrow3DBox[Line3DBox[{{0, 0, 0}, {5.43088, 0., 0.}}]]}, 
   {RGBColor[0, 1, 0], Arrow3DBox[Line3DBox[{{0, 0, 0}, {0., 5.43088, 0.}}]]}, 
   {RGBColor[0, 0, 1], Arrow3DBox[Line3DBox[{{0, 0, 0}, {0., 0., 5.43088}}]]}, 
   {GrayLevel[0], Line3DBox[{{0., 5.43088, 0.}, {5.43088, 5.43088, 0.}}]}, 
   {GrayLevel[0], Line3DBox[{{5.43088, 0., 0.}, {5.43088, 5.43088, 0.}}]}, 
   {GrayLevel[0], Line3DBox[{{5.43088, 0., 0.}, {5.43088, 0., 5.43088}}]}, 
   {GrayLevel[0], Line3DBox[{{0., 5.43088, 0.}, {0., 5.43088, 5.43088}}]}, 
   {GrayLevel[0], 
    Line3DBox[{{5.43088, 5.43088, 0.}, {5.43088, 5.43088, 5.43088}}]}, 
   {GrayLevel[0], Line3DBox[{{0., 0., 5.43088}, {5.43088, 0., 5.43088}}]}, 
   {GrayLevel[0], Line3DBox[{{0., 0., 5.43088}, {0., 5.43088, 5.43088}}]}, 
   {GrayLevel[0], 
    Line3DBox[{{0., 5.43088, 5.43088}, {5.43088, 5.43088, 5.43088}}]}, 
   {GrayLevel[0], 
    Line3DBox[{{5.43088, 0., 5.43088}, {5.43088, 5.43088, 5.43088}}]}, 
   {RGBColor[0.941176, 0.784314, 0.627451], Opacity[1.], 
    SphereBox[CompressedData["
1:eJyF1y9o1WEUxvHLDAbT0CCC4EAdgiCYhsVrsGhb14mg0T8gtslAmE1MFkVW
ZtvagmAYVq2CIMiKCFa7uPIYPj8e3nD5cc499/1933Oe95z3Lt19uHpvYTab
fTv8HDn8PJutvln58POqz3cb5z9tLh+bj+z2TNyD/V8vFheOz29vrD/5fWP2
/xm/zxbXbLlfzj/urj06OeG4v3X57/r7pQl//PJnHd+3s//q686P0xPupwdv
F7dvnZ3w60981pF/88zRc19OLE/4t7e+3zz1/OKEP375s478r+88Xvnz+cKE
f+/g+tq1K5cm/PoTn3XMu3yjeshtncyXHMnvqE6tHvLLG1uu2O4jtvoJj1zh
kStx+mOrn7xP/cSvfsKpfuJXP3mf+gmPOkm8/sSrn7xP/YzOg/pxn+pV/YRv
dE7aeZBf/cSvfsKpfuJXP+FRP+FRJ4nXn3j1E07zHdu8xrYOsdVPeMxreMxr
4vTHzvf2nVG/tz5tDuR3o75uH219qvUj+Uf9Rv7WhxI36iueY/n1ux/5R3qX
v52DrDPStTqSX796tO+P8m19Wh3UT8ur+2hzos0D+eUb2e2pfuSSfxTXbLnV
j/NLfvXj/PJ96sf5Jb9+55fc6mc0j9WPfdb3qR/nV5vTbR7Lb35H9TDv1kl+
8+j8anVq9ZBfXueX/O7D+SW/XM4v+fU7v9TN6L6vntr/gPxudK93frV7UrsP
yT+6b8rf7qFZZ3SvdH61c9LOg/yj+4787R6UuNG9xvklv37r4bkdzVvPR5vD
6qfNVedXu6e2+6j8o34vf5sD6qf1dedA61OtH8k/6jfytz6kflpfsQ/Jr9/9
2DdHend/7Ryon6Zrz0H7n9D+D8g/yrf8rQ7qp+XVOrQ50eaB/PKN7PZUP3LJ
P4pr9j88S4ut
     "], 1.11]}, 
   {RGBColor[0.878431, 0.4, 0.2], Opacity[1.], 
    SphereBox[{{2.71544, 2.71544, 2.71544}, {2.71544, 8.14632, 2.71544}, {
     2.71544, 13.577200000000001`, 2.71544}, {8.14632, 2.71544, 2.71544}, {
     8.14632, 8.14632, 2.71544}, {8.14632, 13.577200000000001`, 2.71544}, {
     13.577200000000001`, 2.71544, 2.71544}, {13.577200000000001`, 8.14632, 
     2.71544}, {13.577200000000001`, 13.577200000000001`, 2.71544}}, 1.32]}, 
   {RGBColor[0.234466, 0.669394, 0.701499], Opacity[1.], 
    SphereBox[{{2.71544, 2.71544, 8.14632}, {2.71544, 8.14632, 8.14632}, {
     2.71544, 13.577200000000001`, 8.14632}, {8.14632, 2.71544, 8.14632}, {
     8.14632, 8.14632, 8.14632}, {8.14632, 13.577200000000001`, 8.14632}, {
     13.577200000000001`, 2.71544, 8.14632}, {13.577200000000001`, 8.14632, 
     8.14632}, {13.577200000000001`, 13.577200000000001`, 8.14632}}, 1.47]}, 
   {RGBColor[0.313725, 0.815686, 0.313725], Opacity[1.], 
    SphereBox[{{2.71544, 2.71544, 13.577200000000001`}, {2.71544, 8.14632, 
     13.577200000000001`}, {2.71544, 13.577200000000001`, 
     13.577200000000001`}, {8.14632, 2.71544, 13.577200000000001`}, {8.14632, 
     8.14632, 13.577200000000001`}, {8.14632, 13.577200000000001`, 
     13.577200000000001`}, {13.577200000000001`, 2.71544, 
     13.577200000000001`}, {13.577200000000001`, 8.14632, 
     13.577200000000001`}, {13.577200000000001`, 13.577200000000001`, 
     13.577200000000001`}}, 1.24]}},
  ControllerMethod -> Automatic,
  AlignmentPoint->Center,
  AspectRatio->Automatic,
  Axes->False,
  AxesEdge->Automatic,
  AxesLabel->None,
  AxesOrigin->Automatic,
  AxesStyle->{},
  Background->None,
  BaseStyle->{},
  BaselinePosition->Automatic,
  BoxRatios->Automatic,
  BoxStyle->{},
  Boxed->False,
  ClipPlanes->None,
  ClipPlanesStyle->Automatic,
  ColorOutput->Automatic,
  ContentSelectable->Automatic,
  ControllerLinking->False,
  ControllerPath->Automatic,
  CoordinatesToolOptions:>Automatic,
  DisplayFunction->Identity,
  Epilog->{},
  FaceGrids->None,
  FaceGridsStyle->{},
  FormatType->TraditionalForm,
  ImageMargins->0.,
  ImagePadding->All,
  ImageSize->Automatic,
  ImageSizeRaw->Automatic,
  LabelStyle->{},
  Lighting->"Neutral",
  Method->Automatic,
  PlotLabel->None,
  PlotRange->All,
  PlotRangePadding->Automatic,
  PlotRegion->Automatic,
  PreserveImageOptions->Automatic,
  Prolog->{},
  RotationAction->"Fit",
  SphericalRegion->True,
  Ticks->Automatic,
  TicksStyle->{},
  TouchscreenAutoZoom->False,
  ViewAngle->Automatic,
  ViewCenter->Automatic,
  ViewMatrix->Automatic,
  ViewPoint->Left,
  ViewProjection->Automatic,
  ViewRange->All,
  ViewVector->Automatic,
  ViewVertical->{0, 0, 1}]], "Output",
 CellLabel->"Out[1]=",
 CellID->1737701996]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[Cell["\t", "ExampleDelimiter"],
  $Line = 0; Null]], "ExampleDelimiter",
 CellID->962783331],

Cell[TextData[{
 "In this example we will work with ",
 StyleBox["ice",
  FontSlant->"Italic"],
 " as our host structure. Let us see if we can find a special position to \
embed atoms in\[Ellipsis]"
}], "ExampleText",
 CellID->1283129296],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"spcgr", "=", 
  RowBox[{"GetSymmetryData", "[", 
   RowBox[{"\"\<Ice\>\"", ",", "\"\<Symbol\>\""}], "]"}]}]], "Input",
 CellLabel->"In[1]:=",
 CellID->36276483],

Cell[BoxData["\<\"\\!\\(\\*SubscriptBox[\\(P6\\), \\(3\\)]\\)cm\"\>"], \
"Output",
 CellLabel->"Out[1]=",
 CellID->268131607]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"$GroupSymbolRedirect", "[", "spcgr", "]"}], "[", 
   "\"\<SpecialPositions\>\"", "]"}], "\[LeftDoubleBracket]", "3", 
  "\[RightDoubleBracket]"}]], "Input",
 CellLabel->"In[2]:=",
 CellID->1467962770],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{"\<\"Multiplicity\"\>", "\[Rule]", "4"}], ",", 
   RowBox[{"\<\"WyckoffLetter\"\>", "\[Rule]", "\<\"b\"\>"}], ",", 
   RowBox[{"\<\"SiteSymmetry\"\>", "\[Rule]", "\<\"3..\"\>"}], ",", 
   RowBox[{"\<\"Coordinates\"\>", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        FractionBox["1", "3"], ",", 
        FractionBox["2", "3"], ",", "\<\"z\"\>"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        FractionBox["2", "3"], ",", 
        FractionBox["1", "3"], ",", 
        RowBox[{
         FractionBox["1", "2"], "+", "\<\"z\"\>"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        FractionBox["1", "3"], ",", 
        FractionBox["2", "3"], ",", 
        RowBox[{
         FractionBox["1", "2"], "+", "\<\"z\"\>"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        FractionBox["2", "3"], ",", 
        FractionBox["1", "3"], ",", "\<\"z\"\>"}], "}"}]}], "}"}]}]}], 
  "\[RightAssociation]"}]], "Output",
 CellLabel->"Out[2]=",
 CellID->639750468]
}, Open  ]],

Cell[TextData[{
 "\[Ellipsis] taking the ",
 Cell[BoxData[
  FormBox[
   RowBox[{"4", " \[NegativeMediumSpace]", "b"}], TraditionalForm]], 
  "InlineMath"],
 " site, for example, which is shown above. Atoms located at ",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", 
    RowBox[{
     RowBox[{"1", "/", "3"}], ",", "\[MediumSpace]", 
     RowBox[{"2", "/", "3"}], ",", "\[MediumSpace]", "z"}], ")"}], 
   TraditionalForm]], "InlineMath"],
 " have this site symmetry. Let us put nickel in there, and use a host \
structure that is ",
 Cell[BoxData[
  FormBox[
   RowBox[{"4", "\[Times]", "3", "\[Times]", "1"}], TraditionalForm]], 
  "InlineMath"],
 " unit cells of ice:"
}], "ExampleText",
 CellID->1308050109],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CrystalPlot", "[", 
  RowBox[{
   RowBox[{"EmbedStructure", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\"\<Ni\>\"", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"1", "/", "3"}], ",", 
        RowBox[{"2", "/", "3"}], ",", "0.5"}], "}"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"ExpandCrystal", "[", 
      RowBox[{"\"\<Ice\>\"", ",", 
       RowBox[{"{", 
        RowBox[{"4", ",", "3", ",", "1"}], "}"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<NewLabel\>\"", "\[Rule]", "\"\<NickelIce\>\""}]}], "]"}], 
   ",", "\[IndentingNewLine]", 
   RowBox[{"\"\<UnitCellDisplay\>\"", "\[Rule]", "\"\<None\>\""}]}], 
  "]"}]], "Input",
 CellLabel->"In[3]:=",
 CellID->1668268251],

Cell[BoxData[
 Graphics3DBox[{
   {RGBColor[0.800498, 0.201504, 0.192061], Opacity[1.], 
    SphereBox[CompressedData["
1:eJxllk1IVGEYhSdToR+YUQYLBaFhktEkRU1SZ5i7CVpEUCG0sJTBQFc5Ki5K
hCAhCiqIFgotwlUgKAhCETUpREaBYSkN/UdUm6Aoito0l/udO9znE9wcXt55
53vOcM6uzOmjp0pCodBs4X9z4b/vzeO54XypEzJ/2dTWjZmh12lP/3l/bfLl
wa5wiSN95/D1u6OF+QOV3eFUuBJ61N9zdelXoudKxDHzOc1LN/vT2i99taxv
ZazwuXtfPFjIV9X4+1OJ5sWRfDS3/dCOxmQ45us95s7bI5feb7tW5+tmT1p7
tH+u/sJARUV1TvPSq82d2h+8P5rz9uzx9w89ae/bnY7lZtr/TN6abvL1pLkz
0bR4IxlucYLvWerv0f6Gp5mO0Xzcn5c+b+7Ufukns4Mf3c/90PusPH6kzd//
/G0sEynMS9e8925xi6/Z75BvvXePxdd7twaLr/m+DvlmvfdxyHfdu9Mh3yrj
K/I1vBzyPeG9g0O+/cZX5Gv845Bvv/E/+cr/5Bs1d5JvlfE/+cr/5Dtg7iTf
R8b/5Gv0NPl6Pmyx+I5PnrvXO9to8f1cu3rTnSdfz4dtFt+l892fIgXu5Hux
tnPfxPdmi+/ld4e73M8lX+Nzi6/uJN9N2bUxdz/5mt+dQ766k3yTxv/kK/+T
r+4k33njf/KV/8lXd5Kv+Z065Gt+1w75et+r0+IbOdvbX5Not/h2bHyrqyjM
k6/3zkmL78KZld8jBe7k+2r9+J3B5f0W36nEw5j7ueQrX5Gv7iTfY/U//rn7
yVe+Il/dSb7yP/nKV+SrO8lX/idf+Yp8dSf5yv/kKz+Tb6Z14mv535TFsaz1
y7jLi1zEl+8sXnw3vT/fQe/J78Ucn55y/2qsHJfOHA/qxV6x7K5f2uKwV0hn
r5DOHNd+5rh05rh09grtZ6+Qzl4RvL+Y49rPHJfOHA++Z7FXaD97hXT2CunM
fe1nT9A8c1zzzHHpzHHp7BXaz14hnb1COnNc+5njwc8t5rh09grtZ68IvkOx
VwTnizlO/5Mvczx4f7FX0P/ky14hnbmv/ewJmmeOa545Lp05Lp29QvvZK6Sz
V0hnjgf3F3Ocd5Ive0Xw+8YtvuwVQX82WHyZ47yTfNkr6H/yZa+QztzXfvaE
4PdKWnyZ49KZ48F37rT4sldIZ6+Qzhynr8iXOS6dvYK+Il/2CvqffJnjvJN8
2SvoK/Jlr6D/yZc9QfPMfc2zJ2ieua959gTNM/c1z56g+f/FZ6gL
     "], 0.66]}, 
   {RGBColor[0.65, 0.7, 0.7], Opacity[1.], SphereBox[CompressedData["
1:eJxll3tQ1WUaxw+KYFDCQUQiLwjEHEC5CAc5Ap130NUuiLaukl2UyHaiDVzU
UdYUvGHrRk4tYnnvtlvmrpctbSMGTjUZXrbV1SjOFqKUpe5qEpXltO1h3uf7
zvh9/ceZZ555fs95Ps/n+f0YU77glw8PcDgcBUEOx8DA/2VdR/Yu9Acrh/z7
KnPe3JUr+rw63td2sr7z9vyIAQrx2IVNLYsD+b+ImhVRGBFF8WhTp/fCiIF/
+3ioknwf8hGX+l7UR/z4oLLDSwLPTf/ondf9MbeY+oWuzIOL/NG+G4uHjy2I
SDDx+6XPtxY9eSa8MdnEpY4XdVB/b8rvH3E643zIRzxO+kT96/uP9uk6aab+
b4/llt3qTfC9lHu1fteWDBMvkD5dGQe3F0SMV9fPM9jUQf3Uf5R7FvuTTD7i
+6RP1Ed8bnVFT/9zz847EZJ0d46pf+p0QnlkIB9x5Ou5JVl8pb5ivim6H4uv
nluqxVd+r2K+1Xo+ivl26D4V842RvWK+wksx3wf0HBTznS97xXxlfxTznS/7
z3yx/8w3WvpkvjGy/8wX+898H5E+mW+77D/zlbiX+eo9HG/xXV6/qnXeX8Za
fL8cdfyF/nzmq/cwx+L77tpZX0QGuDPfP4ya6K69kmnx3dBdkt//XOYre27x
RZ/MN6j65JL++sxXvFPMF30y3wLZf+aL/We+6JP57pP9Z77Yf+aLPpmveKqY
r3itmK/+XRMtvpGPz5t/iyvX4uv5+FKyM5DPfPWcCyy+ry87/P2iAHfm+2nH
Pc0V7+VZfDe7DiX0P5f5Yq+YL/pkvjNTeq/112e+2Cvmiz6ZL/af+WKvmC/6
ZL7Yf+aLvWK+6JP5Yv+ZL/aZ+ZZn154P+bHQ4jgo+6vl/byYC/jynMGL54b5
8xwwT/5dfesL7mj+dbjZk2e2nglZXtvu1fFrbX/OPbf3UnOoQnzatk8vz9gY
pA4s2v7moYVDKO40dVJLa5598uoQJfk+5CMu9b2oj/jzzb1zdoSeNt8DqD+m
sWFb/YoYn6rxD0pZlqi4z7VT20NHu2418ad1HfM9gPpHWtNW/1wZ60M+4iXS
J+pfH3ea9zjq9wQ9PHNPZKLvsf2fZRxdnWn1edPmU5mH5mSZ+Hd6zqYO6r/5
bM6Ui4OTTD7ix6RP1Ef8dyE3/TR0W7x576P+zgP/Ts8pHWniyNf9JFt8j+r6
ivlKPxZfPTeXxTdB/17FfM/q+Sjmu0P3qZivzF8xX+GlmG+NnoNivldlr5iv
cFHMF/vPfKVOG/Mtlj6Zb7HsP/OVfIvv19In88X+M9+Vss/MV+9htsU3bMbM
ox3+NIvvuGCP68GOLIuv5p5j8XU3r/lk89lUi+9kz4k9RfdmWXwX37V7TPX0
dIvv32WvmO8N0ifz3ZD/pzXfjs60+Ip3ivnmSp/MN0H2n/lir5gv9p/5Yv+Z
L/af+aJPi6/sP/PFPjNfPf+JFt/SsvYLs9vcFt+6ltK/Fr/qsfjqOedbfB9r
KqvOm+S2+G66cjk7fazH4nvj3L5hL/+Qa/FNl71ivrOlT+bb/c17g89cmWDx
xV4x30rpk/li/5kv9or5ok/mi/1nvth/5os+mS/2n/lin5nvrtgvFxQ9U2hx
bJ1W913isEKLy0rhy3MGL54b5s9zAHf+XQ3D3M+tWxWjqoq6nVPfOectKY+8
x/PGCNVzc07f9KedyvVu2G0NziiFeK/csa7U/0zb9MZVk7+zsWtC65JrbaeP
1Z/Yf1usSnsipvPD78PVpcZHd274oKstLLnq4rawASaO74qlR6bEHzgfbeJ4
T6E+4ksD3ZY0BJk+ET+y4SnVUhVu+kQc73fUR587dJ9e9Il4n+7Tiz4Rf17y
l3/2U9PAyyNN3LFR5+++61xN9sZkE8dzv1mwI9HxYryJy5x9oSdeKjr0Worp
U+bsi1vcsjF6SIKJ4330r+nBF6Y6XPy7FOojLn22oU/Eu2X+6JPm7EN99LlM
z9n0ibjM2fTJ+bM6TyddXj3Wyh+z9aGK44HvT8Tx3PX31q2oHJdu4rGTAoJF
Jfr++UDRhzdvzTZ9Tn4/r27olnjf/rnbL63anGHicod97u29L/jfH2/i+D5E
fcSfkvmjT54/+kRc3l+mPvosK1iz7n8VsaZPxG/IW5vqvm+k6RPxR6+Vzt7y
earl16YVpcE//8Zl+YX3CPslz1Xs12D9XMV+HZT3GvuF7wT2a3X/4QhJsvwq
PVUWt64u2fIrXt6D7NdwzVGxX5M0R8V+CXfFfgl3xX7h/ct+LZH7wH61y31g
v9rlzrBf+G5hvx6U+bNf4TJ/9gvfe+zXerm37NdZubfsF+4z+/W55LNf+B5m
v3Af2C+5Y23s1+1yZ9gv+TtFsV81Mn/265jMn/2aIXeS/XpO7i37JXfMy36F
HrxzX95kt+XXiKV3hl4MzbH8miTvcfbr1JC6aR2fpFl+7Wqo21l9d7rlF74r
2C+8f9mvxp6S82UfZVl+1SZM/+MeZ7blF75D2K+uOW//t+i+LMuvvri3J387
KtPyC/nsF/LZLzyX/cJ9YL9wH9gvfI+xX5gb+4X5s1+vyfzZL9xJ9gv3lv1q
knvLfiGf/UI++4Xnsl+4z+xXmNwH9gt/d7BfmBv7hfmzX5g/+4U7yX7h3rJf
uM/s15yqCndSTKHlV1VGRUNHZ77lV5N8l7JfLd6u3bNb3ZZfr9R2/erlH3Mt
v/Ddy369Kt/P7NcXWyuril/xWH4d91cO39Iz0fILf1+wX5lR/oXp4zyWX1NO
dh7u/nqC5Rfy2S/ks1/4Dme/cB/YL9wH9gt3hv3C3NgvzJ/9wvzZL/y9w37h
3rJfuLfsF/LZL+SzX3gu+4X7wH7hPrNfuDPsF+bGfmH+7Bfmz37hTrJfuLfs
F+4t+/V/QuSOOA==
     "], 0.31]}, 
   {RGBColor[0.313725, 0.815686, 0.313725], Opacity[1.], 
    SphereBox[{{0., 4.514879105062873, 3.68}, {-3.91, 11.287197762657183`, 
     3.68}, {-7.819999999999999, 18.05951642025149, 3.68}, {7.819999999999999,
      4.514879105062873, 3.68}, {3.9099999999999993`, 11.287197762657183`, 
     3.68}, {0., 18.05951642025149, 3.68}, {15.640000000000004`, 
     4.514879105062873, 3.68}, {11.730000000000004`, 11.287197762657183`, 
     3.68}, {7.820000000000004, 18.05951642025149, 3.68}, {
     23.460000000000004`, 4.514879105062873, 3.68}, {19.550000000000004`, 
     11.287197762657183`, 3.68}, {15.640000000000004`, 18.05951642025149, 
     3.68}}, 1.24]}},
  ControllerMethod -> Automatic,
  AlignmentPoint->Center,
  AspectRatio->Automatic,
  Axes->False,
  AxesEdge->Automatic,
  AxesLabel->None,
  AxesOrigin->Automatic,
  AxesStyle->{},
  Background->None,
  BaseStyle->{},
  BaselinePosition->Automatic,
  BoxRatios->Automatic,
  BoxStyle->{},
  Boxed->False,
  ClipPlanes->None,
  ClipPlanesStyle->Automatic,
  ColorOutput->Automatic,
  ContentSelectable->Automatic,
  ControllerLinking->False,
  ControllerPath->Automatic,
  CoordinatesToolOptions:>Automatic,
  DisplayFunction->Identity,
  Epilog->{},
  FaceGrids->None,
  FaceGridsStyle->{},
  FormatType->TraditionalForm,
  ImageMargins->0.,
  ImagePadding->All,
  ImageSize->Automatic,
  ImageSizeRaw->Automatic,
  LabelStyle->{},
  Lighting->"Neutral",
  Method->Automatic,
  PlotLabel->None,
  PlotRange->All,
  PlotRangePadding->Automatic,
  PlotRegion->Automatic,
  PreserveImageOptions->Automatic,
  Prolog->{},
  RotationAction->"Fit",
  SphericalRegion->True,
  Ticks->Automatic,
  TicksStyle->{},
  TouchscreenAutoZoom->False,
  ViewAngle->NCache[90 Degree, 1.5707963267948966`],
  ViewCenter->Automatic,
  ViewMatrix->Automatic,
  ViewPoint->{0, 0, 
    DirectedInfinity[1]},
  ViewProjection->Automatic,
  ViewRange->All,
  ViewVector->Automatic,
  ViewVertical->{0, 0, 1}]], "Output",
 CellLabel->"Out[3]=",
 CellID->1068509038]
}, Open  ]],

Cell["\<\
We can also mix in nickel and iron at the special position, randomly \
distributed at a 3:1 ratio:\
\>", "ExampleText",
 CellID->29711224],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CrystalPlot", "[", 
  RowBox[{
   RowBox[{"EmbedStructure", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0.75", ",", "0.25"}], "}"}], "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"\"\<Ni\>\"", ",", "\"\<Fe\>\""}], "}"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"1", "/", "3"}], ",", 
        RowBox[{"2", "/", "3"}], ",", "0.5"}], "}"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"ExpandCrystal", "[", 
      RowBox[{"\"\<Ice\>\"", ",", 
       RowBox[{"{", 
        RowBox[{"4", ",", "3", ",", "1"}], "}"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<NewLabel\>\"", "\[Rule]", "\"\<NickelIce\>\""}]}], "]"}], 
   ",", "\[IndentingNewLine]", 
   RowBox[{"\"\<UnitCellDisplay\>\"", "\[Rule]", "\"\<None\>\""}]}], 
  "]"}]], "Input",
 CellLabel->"In[4]:=",
 CellID->873180837],

Cell[BoxData[
 Graphics3DBox[{
   {RGBColor[0.800498, 0.201504, 0.192061], Opacity[1.], 
    SphereBox[CompressedData["
1:eJxllk1IVGEYhSdToR+YUQYLBaFhktEkRU1SZ5i7CVpEUCG0sJTBQFc5Ki5K
hCAhCiqIFgotwlUgKAhCETUpREaBYSkN/UdUm6Aoito0l/udO9znE9wcXt55
53vOcM6uzOmjp0pCodBs4X9z4b/vzeO54XypEzJ/2dTWjZmh12lP/3l/bfLl
wa5wiSN95/D1u6OF+QOV3eFUuBJ61N9zdelXoudKxDHzOc1LN/vT2i99taxv
ZazwuXtfPFjIV9X4+1OJ5sWRfDS3/dCOxmQ45us95s7bI5feb7tW5+tmT1p7
tH+u/sJARUV1TvPSq82d2h+8P5rz9uzx9w89ae/bnY7lZtr/TN6abvL1pLkz
0bR4IxlucYLvWerv0f6Gp5mO0Xzcn5c+b+7Ufukns4Mf3c/90PusPH6kzd//
/G0sEynMS9e8925xi6/Z75BvvXePxdd7twaLr/m+DvlmvfdxyHfdu9Mh3yrj
K/I1vBzyPeG9g0O+/cZX5Gv845Bvv/E/+cr/5Bs1d5JvlfE/+cr/5Dtg7iTf
R8b/5Gv0NPl6Pmyx+I5PnrvXO9to8f1cu3rTnSdfz4dtFt+l892fIgXu5Hux
tnPfxPdmi+/ld4e73M8lX+Nzi6/uJN9N2bUxdz/5mt+dQ766k3yTxv/kK/+T
r+4k33njf/KV/8lXd5Kv+Z065Gt+1w75et+r0+IbOdvbX5Not/h2bHyrqyjM
k6/3zkmL78KZld8jBe7k+2r9+J3B5f0W36nEw5j7ueQrX5Gv7iTfY/U//rn7
yVe+Il/dSb7yP/nKV+SrO8lX/idf+Yp8dSf5yv/kKz+Tb6Z14mv535TFsaz1
y7jLi1zEl+8sXnw3vT/fQe/J78Ucn55y/2qsHJfOHA/qxV6x7K5f2uKwV0hn
r5DOHNd+5rh05rh09grtZ6+Qzl4RvL+Y49rPHJfOHA++Z7FXaD97hXT2CunM
fe1nT9A8c1zzzHHpzHHp7BXaz14hnb1COnNc+5njwc8t5rh09grtZ68IvkOx
VwTnizlO/5Mvczx4f7FX0P/ky14hnbmv/ewJmmeOa545Lp05Lp29QvvZK6Sz
V0hnjgf3F3Ocd5Ive0Xw+8YtvuwVQX82WHyZ47yTfNkr6H/yZa+QztzXfvaE
4PdKWnyZ49KZ48F37rT4sldIZ6+Qzhynr8iXOS6dvYK+Il/2CvqffJnjvJN8
2SvoK/Jlr6D/yZc9QfPMfc2zJ2ieua959gTNM/c1z56g+f/FZ6gL
     "], 0.66]}, 
   {RGBColor[0.65, 0.7, 0.7], Opacity[1.], SphereBox[CompressedData["
1:eJxll3tQ1WUaxw+KYFDCQUQiLwjEHEC5CAc5Ap130NUuiLaukl2UyHaiDVzU
UdYUvGHrRk4tYnnvtlvmrpctbSMGTjUZXrbV1SjOFqKUpe5qEpXltO1h3uf7
zvh9/ceZZ555fs95Ps/n+f0YU77glw8PcDgcBUEOx8DA/2VdR/Yu9Acrh/z7
KnPe3JUr+rw63td2sr7z9vyIAQrx2IVNLYsD+b+ImhVRGBFF8WhTp/fCiIF/
+3ioknwf8hGX+l7UR/z4oLLDSwLPTf/ondf9MbeY+oWuzIOL/NG+G4uHjy2I
SDDx+6XPtxY9eSa8MdnEpY4XdVB/b8rvH3E643zIRzxO+kT96/uP9uk6aab+
b4/llt3qTfC9lHu1fteWDBMvkD5dGQe3F0SMV9fPM9jUQf3Uf5R7FvuTTD7i
+6RP1Ed8bnVFT/9zz847EZJ0d46pf+p0QnlkIB9x5Ou5JVl8pb5ivim6H4uv
nluqxVd+r2K+1Xo+ivl26D4V842RvWK+wksx3wf0HBTznS97xXxlfxTznS/7
z3yx/8w3WvpkvjGy/8wX+898H5E+mW+77D/zlbiX+eo9HG/xXV6/qnXeX8Za
fL8cdfyF/nzmq/cwx+L77tpZX0QGuDPfP4ya6K69kmnx3dBdkt//XOYre27x
RZ/MN6j65JL++sxXvFPMF30y3wLZf+aL/We+6JP57pP9Z77Yf+aLPpmveKqY
r3itmK/+XRMtvpGPz5t/iyvX4uv5+FKyM5DPfPWcCyy+ry87/P2iAHfm+2nH
Pc0V7+VZfDe7DiX0P5f5Yq+YL/pkvjNTeq/112e+2Cvmiz6ZL/af+WKvmC/6
ZL7Yf+aLvWK+6JP5Yv+ZL/aZ+ZZn154P+bHQ4jgo+6vl/byYC/jynMGL54b5
8xwwT/5dfesL7mj+dbjZk2e2nglZXtvu1fFrbX/OPbf3UnOoQnzatk8vz9gY
pA4s2v7moYVDKO40dVJLa5598uoQJfk+5CMu9b2oj/jzzb1zdoSeNt8DqD+m
sWFb/YoYn6rxD0pZlqi4z7VT20NHu2418ad1HfM9gPpHWtNW/1wZ60M+4iXS
J+pfH3ea9zjq9wQ9PHNPZKLvsf2fZRxdnWn1edPmU5mH5mSZ+Hd6zqYO6r/5
bM6Ui4OTTD7ix6RP1Ef8dyE3/TR0W7x576P+zgP/Ts8pHWniyNf9JFt8j+r6
ivlKPxZfPTeXxTdB/17FfM/q+Sjmu0P3qZivzF8xX+GlmG+NnoNivldlr5iv
cFHMF/vPfKVOG/Mtlj6Zb7HsP/OVfIvv19In88X+M9+Vss/MV+9htsU3bMbM
ox3+NIvvuGCP68GOLIuv5p5j8XU3r/lk89lUi+9kz4k9RfdmWXwX37V7TPX0
dIvv32WvmO8N0ifz3ZD/pzXfjs60+Ip3ivnmSp/MN0H2n/lir5gv9p/5Yv+Z
L/af+aJPi6/sP/PFPjNfPf+JFt/SsvYLs9vcFt+6ltK/Fr/qsfjqOedbfB9r
KqvOm+S2+G66cjk7fazH4nvj3L5hL/+Qa/FNl71ivrOlT+bb/c17g89cmWDx
xV4x30rpk/li/5kv9or5ok/mi/1nvth/5os+mS/2n/lin5nvrtgvFxQ9U2hx
bJ1W913isEKLy0rhy3MGL54b5s9zAHf+XQ3D3M+tWxWjqoq6nVPfOectKY+8
x/PGCNVzc07f9KedyvVu2G0NziiFeK/csa7U/0zb9MZVk7+zsWtC65JrbaeP
1Z/Yf1usSnsipvPD78PVpcZHd274oKstLLnq4rawASaO74qlR6bEHzgfbeJ4
T6E+4ksD3ZY0BJk+ET+y4SnVUhVu+kQc73fUR587dJ9e9Il4n+7Tiz4Rf17y
l3/2U9PAyyNN3LFR5+++61xN9sZkE8dzv1mwI9HxYryJy5x9oSdeKjr0Worp
U+bsi1vcsjF6SIKJ4330r+nBF6Y6XPy7FOojLn22oU/Eu2X+6JPm7EN99LlM
z9n0ibjM2fTJ+bM6TyddXj3Wyh+z9aGK44HvT8Tx3PX31q2oHJdu4rGTAoJF
Jfr++UDRhzdvzTZ9Tn4/r27olnjf/rnbL63anGHicod97u29L/jfH2/i+D5E
fcSfkvmjT54/+kRc3l+mPvosK1iz7n8VsaZPxG/IW5vqvm+k6RPxR6+Vzt7y
earl16YVpcE//8Zl+YX3CPslz1Xs12D9XMV+HZT3GvuF7wT2a3X/4QhJsvwq
PVUWt64u2fIrXt6D7NdwzVGxX5M0R8V+CXfFfgl3xX7h/ct+LZH7wH61y31g
v9rlzrBf+G5hvx6U+bNf4TJ/9gvfe+zXerm37NdZubfsF+4z+/W55LNf+B5m
v3Af2C+5Y23s1+1yZ9gv+TtFsV81Mn/265jMn/2aIXeS/XpO7i37JXfMy36F
HrxzX95kt+XXiKV3hl4MzbH8miTvcfbr1JC6aR2fpFl+7Wqo21l9d7rlF74r
2C+8f9mvxp6S82UfZVl+1SZM/+MeZ7blF75D2K+uOW//t+i+LMuvvri3J387
KtPyC/nsF/LZLzyX/cJ9YL9wH9gvfI+xX5gb+4X5s1+vyfzZL9xJ9gv3lv1q
knvLfiGf/UI++4Xnsl+4z+xXmNwH9gt/d7BfmBv7hfmzX5g/+4U7yX7h3rJf
uM/s15yqCndSTKHlV1VGRUNHZ77lV5N8l7JfLd6u3bNb3ZZfr9R2/erlH3Mt
v/Ddy369Kt/P7NcXWyuril/xWH4d91cO39Iz0fILf1+wX5lR/oXp4zyWX1NO
dh7u/nqC5Rfy2S/ks1/4Dme/cB/YL9wH9gt3hv3C3NgvzJ/9wvzZL/y9w37h
3rJfuLfsF/LZL+SzX3gu+4X7wH7hPrNfuDPsF+bGfmH+7Bfmz37hTrJfuLfs
F+4t+/V/QuSOOA==
     "], 0.31]}, 
   {RGBColor[0.313725, 0.815686, 0.313725], Opacity[1.], 
    SphereBox[{{0., 4.514879105062873, 3.68}, {-3.91, 11.287197762657183`, 
     3.68}, {-7.819999999999999, 18.05951642025149, 3.68}, {7.819999999999999,
      4.514879105062873, 3.68}, {3.9099999999999993`, 11.287197762657183`, 
     3.68}, {15.640000000000004`, 4.514879105062873, 3.68}, {
     23.460000000000004`, 4.514879105062873, 3.68}, {19.550000000000004`, 
     11.287197762657183`, 3.68}, {15.640000000000004`, 18.05951642025149, 
     3.68}}, 1.24]}, 
   {RGBColor[0.878431, 0.4, 0.2], Opacity[1.], 
    SphereBox[{{0., 18.05951642025149, 3.68}, {11.730000000000004`, 
     11.287197762657183`, 3.68}, {7.820000000000004, 18.05951642025149, 
     3.68}}, 1.32]}},
  ControllerMethod -> Automatic,
  AlignmentPoint->Center,
  AspectRatio->Automatic,
  Axes->False,
  AxesEdge->Automatic,
  AxesLabel->None,
  AxesOrigin->Automatic,
  AxesStyle->{},
  Background->None,
  BaseStyle->{},
  BaselinePosition->Automatic,
  BoxRatios->Automatic,
  BoxStyle->{},
  Boxed->False,
  ClipPlanes->None,
  ClipPlanesStyle->Automatic,
  ColorOutput->Automatic,
  ContentSelectable->Automatic,
  ControllerLinking->False,
  ControllerPath->Automatic,
  CoordinatesToolOptions:>Automatic,
  DisplayFunction->Identity,
  Epilog->{},
  FaceGrids->None,
  FaceGridsStyle->{},
  FormatType->TraditionalForm,
  ImageMargins->0.,
  ImagePadding->All,
  ImageSize->Automatic,
  ImageSizeRaw->Automatic,
  LabelStyle->{},
  Lighting->"Neutral",
  Method->Automatic,
  PlotLabel->None,
  PlotRange->All,
  PlotRangePadding->Automatic,
  PlotRegion->Automatic,
  PreserveImageOptions->Automatic,
  Prolog->{},
  RotationAction->"Fit",
  SphericalRegion->True,
  Ticks->Automatic,
  TicksStyle->{},
  TouchscreenAutoZoom->False,
  ViewAngle->NCache[90 Degree, 1.5707963267948966`],
  ViewCenter->Automatic,
  ViewMatrix->Automatic,
  ViewPoint->{0, 0, 
    DirectedInfinity[1]},
  ViewProjection->Automatic,
  ViewRange->All,
  ViewVector->Automatic,
  ViewVertical->{0, 0, 1}]], "Output",
 CellLabel->"Out[4]=",
 CellID->1989203369]
}, Open  ]],

Cell[TextData[{
 "The special label ",
 Cell[BoxData["\"\<Void\>\""], "InlineFormula"],
 " may be used to create vacancies:"
}], "ExampleText",
 CellID->905425084],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CrystalPlot", "[", 
  RowBox[{
   RowBox[{"EmbedStructure", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0.75", ",", "0.25"}], "}"}], "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"\"\<Ni\>\"", ",", "\"\<Void\>\""}], "}"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"1", "/", "3"}], ",", 
        RowBox[{"2", "/", "3"}], ",", "0.5"}], "}"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"ExpandCrystal", "[", 
      RowBox[{"\"\<Ice\>\"", ",", 
       RowBox[{"{", 
        RowBox[{"4", ",", "3", ",", "1"}], "}"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<NewLabel\>\"", "\[Rule]", "\"\<NickelIce\>\""}]}], "]"}], 
   ",", "\[IndentingNewLine]", 
   RowBox[{"\"\<UnitCellDisplay\>\"", "\[Rule]", "\"\<None\>\""}]}], 
  "]"}]], "Input",
 CellLabel->"In[5]:=",
 CellID->1958277478],

Cell[BoxData[
 Graphics3DBox[{
   {RGBColor[0.800498, 0.201504, 0.192061], Opacity[1.], 
    SphereBox[CompressedData["
1:eJxllk1IVGEYhSdToR+YUQYLBaFhktEkRU1SZ5i7CVpEUCG0sJTBQFc5Ki5K
hCAhCiqIFgotwlUgKAhCETUpREaBYSkN/UdUm6Aoito0l/udO9znE9wcXt55
53vOcM6uzOmjp0pCodBs4X9z4b/vzeO54XypEzJ/2dTWjZmh12lP/3l/bfLl
wa5wiSN95/D1u6OF+QOV3eFUuBJ61N9zdelXoudKxDHzOc1LN/vT2i99taxv
ZazwuXtfPFjIV9X4+1OJ5sWRfDS3/dCOxmQ45us95s7bI5feb7tW5+tmT1p7
tH+u/sJARUV1TvPSq82d2h+8P5rz9uzx9w89ae/bnY7lZtr/TN6abvL1pLkz
0bR4IxlucYLvWerv0f6Gp5mO0Xzcn5c+b+7Ufukns4Mf3c/90PusPH6kzd//
/G0sEynMS9e8925xi6/Z75BvvXePxdd7twaLr/m+DvlmvfdxyHfdu9Mh3yrj
K/I1vBzyPeG9g0O+/cZX5Gv845Bvv/E/+cr/5Bs1d5JvlfE/+cr/5Dtg7iTf
R8b/5Gv0NPl6Pmyx+I5PnrvXO9to8f1cu3rTnSdfz4dtFt+l892fIgXu5Hux
tnPfxPdmi+/ld4e73M8lX+Nzi6/uJN9N2bUxdz/5mt+dQ766k3yTxv/kK/+T
r+4k33njf/KV/8lXd5Kv+Z065Gt+1w75et+r0+IbOdvbX5Not/h2bHyrqyjM
k6/3zkmL78KZld8jBe7k+2r9+J3B5f0W36nEw5j7ueQrX5Gv7iTfY/U//rn7
yVe+Il/dSb7yP/nKV+SrO8lX/idf+Yp8dSf5yv/kKz+Tb6Z14mv535TFsaz1
y7jLi1zEl+8sXnw3vT/fQe/J78Ucn55y/2qsHJfOHA/qxV6x7K5f2uKwV0hn
r5DOHNd+5rh05rh09grtZ6+Qzl4RvL+Y49rPHJfOHA++Z7FXaD97hXT2CunM
fe1nT9A8c1zzzHHpzHHp7BXaz14hnb1COnNc+5njwc8t5rh09grtZ68IvkOx
VwTnizlO/5Mvczx4f7FX0P/ky14hnbmv/ewJmmeOa545Lp05Lp29QvvZK6Sz
V0hnjgf3F3Ocd5Ive0Xw+8YtvuwVQX82WHyZ47yTfNkr6H/yZa+QztzXfvaE
4PdKWnyZ49KZ48F37rT4sldIZ6+Qzhynr8iXOS6dvYK+Il/2CvqffJnjvJN8
2SvoK/Jlr6D/yZc9QfPMfc2zJ2ieua959gTNM/c1z56g+f/FZ6gL
     "], 0.66]}, 
   {RGBColor[0.65, 0.7, 0.7], Opacity[1.], SphereBox[CompressedData["
1:eJxll3tQ1WUaxw+KYFDCQUQiLwjEHEC5CAc5Ap130NUuiLaukl2UyHaiDVzU
UdYUvGHrRk4tYnnvtlvmrpctbSMGTjUZXrbV1SjOFqKUpe5qEpXltO1h3uf7
zvh9/ceZZ555fs95Ps/n+f0YU77glw8PcDgcBUEOx8DA/2VdR/Yu9Acrh/z7
KnPe3JUr+rw63td2sr7z9vyIAQrx2IVNLYsD+b+ImhVRGBFF8WhTp/fCiIF/
+3ioknwf8hGX+l7UR/z4oLLDSwLPTf/ondf9MbeY+oWuzIOL/NG+G4uHjy2I
SDDx+6XPtxY9eSa8MdnEpY4XdVB/b8rvH3E643zIRzxO+kT96/uP9uk6aab+
b4/llt3qTfC9lHu1fteWDBMvkD5dGQe3F0SMV9fPM9jUQf3Uf5R7FvuTTD7i
+6RP1Ed8bnVFT/9zz847EZJ0d46pf+p0QnlkIB9x5Ou5JVl8pb5ivim6H4uv
nluqxVd+r2K+1Xo+ivl26D4V842RvWK+wksx3wf0HBTznS97xXxlfxTznS/7
z3yx/8w3WvpkvjGy/8wX+898H5E+mW+77D/zlbiX+eo9HG/xXV6/qnXeX8Za
fL8cdfyF/nzmq/cwx+L77tpZX0QGuDPfP4ya6K69kmnx3dBdkt//XOYre27x
RZ/MN6j65JL++sxXvFPMF30y3wLZf+aL/We+6JP57pP9Z77Yf+aLPpmveKqY
r3itmK/+XRMtvpGPz5t/iyvX4uv5+FKyM5DPfPWcCyy+ry87/P2iAHfm+2nH
Pc0V7+VZfDe7DiX0P5f5Yq+YL/pkvjNTeq/112e+2Cvmiz6ZL/af+WKvmC/6
ZL7Yf+aLvWK+6JP5Yv+ZL/aZ+ZZn154P+bHQ4jgo+6vl/byYC/jynMGL54b5
8xwwT/5dfesL7mj+dbjZk2e2nglZXtvu1fFrbX/OPbf3UnOoQnzatk8vz9gY
pA4s2v7moYVDKO40dVJLa5598uoQJfk+5CMu9b2oj/jzzb1zdoSeNt8DqD+m
sWFb/YoYn6rxD0pZlqi4z7VT20NHu2418ad1HfM9gPpHWtNW/1wZ60M+4iXS
J+pfH3ea9zjq9wQ9PHNPZKLvsf2fZRxdnWn1edPmU5mH5mSZ+Hd6zqYO6r/5
bM6Ui4OTTD7ix6RP1Ef8dyE3/TR0W7x576P+zgP/Ts8pHWniyNf9JFt8j+r6
ivlKPxZfPTeXxTdB/17FfM/q+Sjmu0P3qZivzF8xX+GlmG+NnoNivldlr5iv
cFHMF/vPfKVOG/Mtlj6Zb7HsP/OVfIvv19In88X+M9+Vss/MV+9htsU3bMbM
ox3+NIvvuGCP68GOLIuv5p5j8XU3r/lk89lUi+9kz4k9RfdmWXwX37V7TPX0
dIvv32WvmO8N0ifz3ZD/pzXfjs60+Ip3ivnmSp/MN0H2n/lir5gv9p/5Yv+Z
L/af+aJPi6/sP/PFPjNfPf+JFt/SsvYLs9vcFt+6ltK/Fr/qsfjqOedbfB9r
KqvOm+S2+G66cjk7fazH4nvj3L5hL/+Qa/FNl71ivrOlT+bb/c17g89cmWDx
xV4x30rpk/li/5kv9or5ok/mi/1nvth/5os+mS/2n/lin5nvrtgvFxQ9U2hx
bJ1W913isEKLy0rhy3MGL54b5s9zAHf+XQ3D3M+tWxWjqoq6nVPfOectKY+8
x/PGCNVzc07f9KedyvVu2G0NziiFeK/csa7U/0zb9MZVk7+zsWtC65JrbaeP
1Z/Yf1usSnsipvPD78PVpcZHd274oKstLLnq4rawASaO74qlR6bEHzgfbeJ4
T6E+4ksD3ZY0BJk+ET+y4SnVUhVu+kQc73fUR587dJ9e9Il4n+7Tiz4Rf17y
l3/2U9PAyyNN3LFR5+++61xN9sZkE8dzv1mwI9HxYryJy5x9oSdeKjr0Worp
U+bsi1vcsjF6SIKJ4330r+nBF6Y6XPy7FOojLn22oU/Eu2X+6JPm7EN99LlM
z9n0ibjM2fTJ+bM6TyddXj3Wyh+z9aGK44HvT8Tx3PX31q2oHJdu4rGTAoJF
Jfr++UDRhzdvzTZ9Tn4/r27olnjf/rnbL63anGHicod97u29L/jfH2/i+D5E
fcSfkvmjT54/+kRc3l+mPvosK1iz7n8VsaZPxG/IW5vqvm+k6RPxR6+Vzt7y
earl16YVpcE//8Zl+YX3CPslz1Xs12D9XMV+HZT3GvuF7wT2a3X/4QhJsvwq
PVUWt64u2fIrXt6D7NdwzVGxX5M0R8V+CXfFfgl3xX7h/ct+LZH7wH61y31g
v9rlzrBf+G5hvx6U+bNf4TJ/9gvfe+zXerm37NdZubfsF+4z+/W55LNf+B5m
v3Af2C+5Y23s1+1yZ9gv+TtFsV81Mn/265jMn/2aIXeS/XpO7i37JXfMy36F
HrxzX95kt+XXiKV3hl4MzbH8miTvcfbr1JC6aR2fpFl+7Wqo21l9d7rlF74r
2C+8f9mvxp6S82UfZVl+1SZM/+MeZ7blF75D2K+uOW//t+i+LMuvvri3J387
KtPyC/nsF/LZLzyX/cJ9YL9wH9gvfI+xX5gb+4X5s1+vyfzZL9xJ9gv3lv1q
knvLfiGf/UI++4Xnsl+4z+xXmNwH9gt/d7BfmBv7hfmzX5g/+4U7yX7h3rJf
uM/s15yqCndSTKHlV1VGRUNHZ77lV5N8l7JfLd6u3bNb3ZZfr9R2/erlH3Mt
v/Ddy369Kt/P7NcXWyuril/xWH4d91cO39Iz0fILf1+wX5lR/oXp4zyWX1NO
dh7u/nqC5Rfy2S/ks1/4Dme/cB/YL9wH9gt3hv3C3NgvzJ/9wvzZL/y9w37h
3rJfuLfsF/LZL+SzX3gu+4X7wH7hPrNfuDPsF+bGfmH+7Bfmz37hTrJfuLfs
F+4t+/V/QuSOOA==
     "], 0.31]}, 
   {RGBColor[0.313725, 0.815686, 0.313725], Opacity[1.], 
    SphereBox[{{0., 4.514879105062873, 3.68}, {-7.819999999999999, 
     18.05951642025149, 3.68}, {7.819999999999999, 4.514879105062873, 3.68}, {
     3.9099999999999993`, 11.287197762657183`, 3.68}, {15.640000000000004`, 
     4.514879105062873, 3.68}, {7.820000000000004, 18.05951642025149, 3.68}, {
     23.460000000000004`, 4.514879105062873, 3.68}, {19.550000000000004`, 
     11.287197762657183`, 3.68}, {15.640000000000004`, 18.05951642025149, 
     3.68}}, 1.24]}},
  ControllerMethod -> Automatic,
  AlignmentPoint->Center,
  AspectRatio->Automatic,
  Axes->False,
  AxesEdge->Automatic,
  AxesLabel->None,
  AxesOrigin->Automatic,
  AxesStyle->{},
  Background->None,
  BaseStyle->{},
  BaselinePosition->Automatic,
  BoxRatios->Automatic,
  BoxStyle->{},
  Boxed->False,
  ClipPlanes->None,
  ClipPlanesStyle->Automatic,
  ColorOutput->Automatic,
  ContentSelectable->Automatic,
  ControllerLinking->False,
  ControllerPath->Automatic,
  CoordinatesToolOptions:>Automatic,
  DisplayFunction->Identity,
  Epilog->{},
  FaceGrids->None,
  FaceGridsStyle->{},
  FormatType->TraditionalForm,
  ImageMargins->0.,
  ImagePadding->All,
  ImageSize->Automatic,
  ImageSizeRaw->Automatic,
  LabelStyle->{},
  Lighting->"Neutral",
  Method->Automatic,
  PlotLabel->None,
  PlotRange->All,
  PlotRangePadding->Automatic,
  PlotRegion->Automatic,
  PreserveImageOptions->Automatic,
  Prolog->{},
  RotationAction->"Fit",
  SphericalRegion->True,
  Ticks->Automatic,
  TicksStyle->{},
  TouchscreenAutoZoom->False,
  ViewAngle->NCache[90 Degree, 1.5707963267948966`],
  ViewCenter->Automatic,
  ViewMatrix->Automatic,
  ViewPoint->{0, 0, 
    DirectedInfinity[1]},
  ViewProjection->Automatic,
  ViewRange->All,
  ViewVector->Automatic,
  ViewVertical->{0, 0, 1}]], "Output",
 CellLabel->"Out[5]=",
 CellID->1169714093]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[Cell["\t", "ExampleDelimiter"],
  $Line = 0; Null]], "ExampleDelimiter",
 CellID->2052281161],

Cell["\<\
The units to be embedded can be placed according to coordinate patterns.\
\>", "ExampleText",
 CellID->54428597],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CrystalPlot", "[", 
  RowBox[{
   RowBox[{"EmbedStructure", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"x_", ",", "y_", ",", "z_"}], "}"}], "/;", 
         RowBox[{"OddQ", "@", 
          RowBox[{"IntegerPart", "[", 
           RowBox[{"x", "+", "y"}], "]"}]}]}], "\[Rule]", "\"\<Ni\>\""}], ",",
        "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"x_", ",", "y_", ",", "z_"}], "}"}], "/;", "True"}], 
        "\[Rule]", "\"\<Fe\>\""}]}], "\[IndentingNewLine]", "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"1", "/", "3"}], ",", 
        RowBox[{"2", "/", "3"}], ",", "0.5"}], "}"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"ExpandCrystal", "[", 
      RowBox[{"\"\<Ice\>\"", ",", 
       RowBox[{"{", 
        RowBox[{"5", ",", "4", ",", "1"}], "}"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
     "\"\<NewLabel\>\"", "\[Rule]", "\"\<AlternatingNickelIce\>\""}]}], "]"}],
    ",", "\[IndentingNewLine]", 
   RowBox[{"\"\<UnitCellDisplay\>\"", "\[Rule]", "\"\<None\>\""}]}], 
  "]"}]], "Input",
 CellLabel->"In[1]:=",
 CellID->1126111909],

Cell[BoxData[
 Graphics3DBox[{
   {RGBColor[0.800498, 0.201504, 0.192061], Opacity[1.], 
    SphereBox[CompressedData["
1:eJx1l1toVFcUhicaAzWFSWSIYiBgmMpkKioao8lJmE1AEBFBi9IHa0KIoE8m
JvqgIggGgoINhCIKUoqlYhEUBMELdYw0XlCw9YZDq7ZVtLQUvNFaX5zD2f85
7G8neQn8LNZZZ+9vzeGb07N17aYpqVQqU5FKTS3/735049S2UqVJ2b/+jukP
jvX9WojyN5fuDD1cEaSnGOWztn11cbBcv3zGunRHegbyTNxnZOxtbsOXNcbW
F1Wv3PYvqL/y29O6r+8oP3f+vctnSnX1cf+O3MKzA6VM8eNVM+e1pxvjfIOd
89zAgd+qR+fGue1TUB/1P9U0vLm2dnZR9cpn2znV350/U4z6fBr377vZ0v1J
obF4rOW/oRNHFsR5u50zt+Ds0fb0IuOeZ2XcR/3zt3paB0vZuF75aTun+ivf
2L/lj/C5v3f9VJVd0xz3H9u37llNbb54dOTvrdWjLd6cA99+t/L13WVxfvdx
Y09Nub/6qP/uob0/dJ2cF9dzTvV358zb9wpwDtk4V310j1mPN/u+hrw1Rc/1
eIvuMe/xZs/fkLf+6BwMebsfnYMhb3WWc/Jm+THk7YvoXgx567WckzfLsyFv
vXYfyZv2kbxl7Jzkrc7uI3nTPpK3zXZO8nbN7iN5E+fkzfa5RN5snwJ5E+fk
zb6Xx1uds48Jb73OfiW8Rfwv8niznHu8PW+4/U1YT94i/ps93uzeebztb2hb
suflQo+3g09WB+FzyZvdL483zUneKvrv7Aj7kze774a8aU7yZvfU4037SN40
J3mzvwMeb9pH8qY5yZv9XTLkTd8d8qY5yZv9nTTkTd8d8qY5yVu3s48B5skY
8hadc5vHW82urt76XIvHW+uDf+bWluvJW3Tv7R5vZ3Ze/3egzCF5++X+5+e3
XFnm8XY4N94YPpe8iXPypjnJ22dNr96H/cmbOCdvmpO8aR/Jmzgnb5qTvGkf
yZs4J2+ak7xpH8mbOCdvmpO8aR/Jmzgnb5qTvLn7GEyyXwHey3i89Sze82fV
/x0eb+NXq9aH9eQtOudOj7dpi1/sDjkkb4euXvj6+5XG4+2vJ0+Ph88lb+Kc
vGlO8vZz33Ax7E/exDl505zkTftI3sQ5edOc5E37SN7EOXnTnORN+0jexDl5
05zkTftI3sQ5edOc5M3dx2CS/Up4K21fvfTds06Pq5Pbp+4N+SEnP1reeO/i
h/coHngvul+es+6L56bz5znQU44cDv/qPU9RTk9x88SbroTtxz4y9Cbl9Cbl
9BT1p6cop6copzepP71JOb3JnT/xFPWnpyinp7jnmXiT+tOblNOblNNT1J+e
wjnFg3J6k/rTmzin+rtzJl7jnkPiQaqnp6ienqKcnqKc3qT+9Cbl9Cbl9BT1
p6e4z008RTm9Sf3pTe45JN7k1ieewn0kb/QUd/7Em7iP5I3epJyeQs7JGz1F
Ob2JnJM3epNyeo3604NUT09RPT1FOT1FOb1J/elNyulNyukpbv/EUzgneaM3
ue+b9XijN7n7kvd4o6dwTvJGb+I+kjd6k3J6Cr875I2eopzexO8OeaM3ufWJ
1/B7R97oKaqnpyinp7j33ubxRm9STm9STk8h5+SNnqKc3kTOyRu9iftI3ugp
nJO80ZvIOXmjN3EfyRs9hXOSN3oTOSdv9KaJ9zGYZL8CvFenxxs9RTk9xT1n
4/FGb1JOb1JOTyHn5I2eopzeRM7JG72J+0je6Cmck7zRm8g5eaM3cR/JGz2F
c5I3ehM5J2/0pon3MZhkvxLe6DWqpwepnl6jenqQ6uk1qqcHqZ5eo3p6kOo/
AOQMBHU=
     "], 0.66]}, 
   {RGBColor[0.65, 0.7, 0.7], Opacity[1.], SphereBox[CompressedData["
1:eJx1mHl0zlcax2NLVCxJRMROpDkRRCKLxCve65VBldCxBB2EYY60ErUUoyRi
rQq170s7NfaxTEsNIW859oxSS5sMEYJaOhSpWmo6ef2e7815v/fwR5zznHue
3/M+9/N87u/+mgwd9cfh5T08PCqW/qlQ+n9K4amdYwoqKg/5dzti8KCpU0rs
Vrwk9/zM/C62GuUV4oFjluaMK13/B78+NRJq+FHcX+d5dLd+hX9+X1PJeifW
Iy757ciP+NlKKSfHlz43/OI3XxYE1NP5E0Ij9o4t8HdW7Va7RbsaQTr+J6nz
X2PnXvNeHKLjkseOPMi/s9nHI3x96zqxHvG6Uifyu9fv77TyNNf5P8iLTXnT
HuT8IvbpzC2rWul4O6kztNXete1qtFbu/ayo8yB/2L+Hxo8rCNbrEd8ldSI/
4oNGpxa7nnt98DnP4Heidf7DM/rc9PENc65d8NMo78WxRp1jN2zs+vhCnI5f
uBo01Kc0P/Ig/+SZWYcGb2+h13OdyO9eZ5j8Lhv1IVjHsd7ax2CDN/m9inlr
Zj3X4M3axzCDN+m/Yt5GW31QzNslqw+KeQsQzpk34UcxbwOtfVHM2zDhnHkT
nhXzNkzmkXnDPDJv/lIn8xYg88i8YR6ZtxFSJ/N2QuaReQPnzJvkyWXeJI+d
eQPnzJv8LoO3ALd5LONtmNt8lfFm8d/a4E04N3j7seHZz13rmTeL/2iDN5k7
g7dPGraNyXgYYfA2vyjJ5nou8ybzZfCGOpm3cqPPj3flZ95k3hXzhjqZN5lT
gzfMI/OGOpk38YDBG+aReUOdzJt4STFvOHeYN9TJvIknFfOGc4d5Q53MW4rb
PNqoHn/FvFl9bmvw5vPR4GH1QmMN3uK/vx/iW7qeebP2vZ3B25eTTv46tpRD
5u3ypX77U4/EGbytDD0W5Hou8wbOmTfUybz1avbohSs/8wbOmTfUybxhHpk3
cM68oU7mDfPIvIFz5g11Mm+YR+YNnDNvqJN5wzwyb+CceUOdzJv7PNpeM182
+l3K4G1oVMYdz+cJBm/Hjnv2da1n3qw+OwzeKkXdnuzikHlbfvzA+q1dlcHb
vaIbm1zPZd7AOfOGOpm37z742OnKz7yBc+YNdTJvmEfmDZwzb6iTecM8Mm/g
nHlDncwb5pF5A+fMG+pk3jCPzBs4Z95QJ/PmPo+218xXGW8FHya1eXbTYXC1
/cMKWS5+mJOjwhvvO/jhfQQPvC/YX+4z9ov7hv5zH0rmtHtr/1+8NecLV1/z
nJxxwm7FX+RujL218/5+L4V49zWXH/RcUk7tGbv262NjqlPcV+cJS564fO7T
6krWO7EecclvR37EP9v/qP86r6v6voP8TRZnr5k5JcCpJhZUajapqeI6Z3Q+
4dUo9E0dX2Dl0fcd5D91qPm039MCnViPeJLUifzucV99T0H+4nLDe+3waeoc
uftKq9PTIow6q628EHGsf6SOP7H6rPMg/9fLozvdqxys1yOeJ3UiP+J/9az2
suaaxvqegvwx+6f/sPJ6mHNfyJnLWV3a6Ph1qbN/9aNXJjeK0/H1e/4THp3c
QOdB/jd69jp9qaC5Xo/4PqkT+RE//arOUP2eifxBr/oQouNYb/UnxODNyhOo
mDfpj8GbtY+hBm/WcwMU8yZ9UMzbOqsPinkTHhTzJvwo5m2itS+KeXsqnDNv
woli3jCPzJvkyWXeukmdzFs3mUfmTdYbvP0sdTJvmEfmTfps8IY6mbepMo/M
G+aReespdTJv7vNoo+d6G7xZcxpl8FbF4tzgrWXF+NAhlyIN3iwOow3eZO4M
3hLjz+1wDIg0eBv39rYmo3uEG7zJfBm8yTwavM23/X36L40iDN7ES4p5i5U6
mTeZU4M3cM68YR6ZN8wj84Z5ZN5Qp8GbzCPzBs6ZN9TJvGEemTfMI/OGOpm3
p27zaHvNfJXxZvHQ1uAtOeXE3b65MQZvmTnJ/+i2Od7gzdp3m8HbyKUpo+M6
xhi8LXv4ICq8RbzBW9VBJbU2PIs1eAsXzpm3vlIn81b0+Ejlaw/bGLyBc+Yt
Tepk3jCPzBs4Z95QJ/OGeWTeMI/MG+pk3jCPzBs4Z95QJ/OGeWTewDnzhjqZ
N/d5tL1mvsp46/jqd3UweNsS+OMox8IEg7fUtrY69Q8qgzerzx0M3g51z3zS
tFaCwdvj3rMvV81UBm8DA2qu/vR0e4O3qcI587ZV6mTeorZfn5d3xG7wBs6Z
N9TJvEXLPDJv4Jx5Q53MWxWZR+YN88i8LZE6mTdvmUfmDZwzb/2kTubtmswj
8wbOmTfUybxdd5vHMt72uc1XGW9Tbk97vmy3w+CqcoVvD84e6zA4AW/Ge7vw
w/u4WXjgfcH+cp+xX9w3cMJ9yK4Vs2JWVoBKdxT5dv7mlj1pqE+/+K/qq+I6
0SU9Fviq0MNV2mf7+inEH8l5URj2U/dlXz3V69cvLmxzaPyL3Kt5M8/tbh+o
ms8OyD/zq7e6v/i99fOPF+ZWCUm/t6ZKeR3HvWnCqU6N99zx13G89yI/4hNK
q03KLqfrRPzU/HkqJ91b14k47i/IjzrXWXXaUSfiJVaddtSJ+GeyfvKVl0sr
PGig4x5LrPXb3r41MWpJiI7juY9HrWvq8bfGOi59dnqd+8JxbGszXaf02Vl3
XM4S/+pBOo73xu96VLzb2SOUf5dCfsSlzlzUiXiR9B91Up+dyI86J1l91nUi
Ln3WdfL6PvlXgx9Ma2Gsb7L6z6lnS+/jiOO5cwZkTklrGa7jgS5x+zV1fjvQ
cabO6ihdZ+LRuMyaqxo7dw9aez9rZSsdx/t2zNpHnxccba3juP8iP+LzpP+o
k/uPOhHH/Q75UWdKu+mz/pcaqOtE/I24GWEx7zbQdSI+RNY/GZJiD/eKMdaP
9OkdMPtinI7juQuCdr2fdrls/XsvkvuuuhHmrHe+9UdnU9rqOpdNSa74+/uh
zg3B9g0TFsWW/S6552b5FSctnBuv47iPIz/i6D/q5P6jTsTlvqDzo85proPE
M1jXiXjyhZS6szJDdJ30uwz/yO8y/IP3B/aP7Iti/1S2+qzYP3vlfYb9g3sQ
+0d+l+Ef+V2GfxrL+zP7p7bVZ8X+6Wj1WbF/ZF8U+0f2RbF/8N7O/hkv/mT/
nBB/sn9OiIfZP7iXsX+Ec8X+8Zb+s39wv2b/zJHziP1zXc4j9g/OL/bPDVnP
/sF9h/0Df7J/xPO57J8u4mH2j3ynUuyfidJ/9k+e9J/9g/s++2eFnEfsH/G8
nf2D84v9g/OL/YPvIewfnF/sH+mz4R+PTywPs3/kdyn2D/rP/sH5xf7B90D2
z2Q5j9g/0mfDP157u+6KS4wx/FN/Qleve17Rhn86yvsk++dC9czul35obvhn
S3bm+tHvhBv+wfst+wfv4eyfxcVJd1IuRhr+yQjqsWiHb5ThH9yn2D+F/Q/8
1/FupOGfkroHEn9pGGH4B+vZP1jP/sFz2T/wJ/sH/mT/4F7J/kHf2D/oP/tn
q/Sf/YNzhP2D84j9s1TOI/YP1rN/sJ79g+eyf3B+sX+qiD/ZP7iPs3/QN/YP
+s/+Qf/ZPzhH2D84j9g/OL/YP1jP/sF69g+ey/6BP9k/8Cf7B9/B2D/oG/sH
/Wf/oP/sH5wj7B+cR+wfnF/sn/7pqTHBAQmGf9JbpWZfyrcZ/lkq9zj2T469
cFvfQzGGfzZlFPbe8DzW8A/uiewf3DfZPzdXp6V32xRv+OdsQVrtVcVtDf/g
exf7J8KvYEx4y3jDP53O558s+rmN4R+sZ/9gPfsH93r2D/zJ/oE/2T/wMPsH
fWP/oP/sH/Sf/YPvEuwfnEfsH5xH7B+sZ/9gPfsHz2X/wJ/sH5xf7B94mP2D
vrF/0H/2D/rP/sE5wv7BecT+wXnE/sF69g/Ws3/wXPYP/Mn+gT/ZP/Aw+wd9
Y/+g/+wf9J/9g3OE/YPziP2D84j907dm4hWvcQ7DP6++b1/sYPgH36nYP9We
/hbhWJBg+OdZ7Mv8T/PaG/4ZId/B2D/4nsb+qR927NnqHGX4Z+Fbnc4cHtDB
8E+ufB9j/6jhv73ILq2f/eM6XvIO2w3/OGQ9+2eFrGf/OOW57J8b4k/2D/zJ
/oGH2T/4fsj+qSH9Z/88l/6zf/A9kP3TT84j9g/OI/bPAFnP/sF69g+ey/45
IP5k/2wUf7J/MsTD7B/0jf1zS/rP/kH/2T84R9g/reQ8Yv8kynnE/omU9ewf
nF/sn3R5LvtnkfiT/QN/sn/gYfYPzi/2z0HpP/tns/Sf/YNzhP3jKecR+wfn
Efvn/5Zsp8c=
     "], 0.31]}, 
   {RGBColor[0.313725, 0.815686, 0.313725], Opacity[1.], 
    SphereBox[{{0., 4.514879105062873, 3.68}, {-3.91, 11.287197762657183`, 
     3.68}, {-7.819999999999999, 18.05951642025149, 3.68}, {
     3.9099999999999993`, 11.287197762657183`, 3.68}, {-3.91, 
     24.831835077845803`, 3.68}, {15.640000000000004`, 4.514879105062873, 
     3.68}, {7.820000000000004, 18.05951642025149, 3.68}, {
     19.550000000000004`, 11.287197762657183`, 3.68}, {11.730000000000004`, 
     24.831835077845803`, 3.68}, {31.279999999999998`, 4.514879105062873, 
     3.68}, {23.459999999999997`, 18.05951642025149, 3.68}}, 1.24]}, 
   {RGBColor[0.878431, 0.4, 0.2], Opacity[1.], 
    SphereBox[{{-11.73, 24.831835077845803`, 3.68}, {7.819999999999999, 
     4.514879105062873, 3.68}, {0., 18.05951642025149, 3.68}, {
     11.730000000000004`, 11.287197762657183`, 3.68}, {3.9100000000000037`, 
     24.831835077845803`, 3.68}, {23.460000000000004`, 4.514879105062873, 
     3.68}, {15.640000000000004`, 18.05951642025149, 3.68}, {
     27.369999999999997`, 11.287197762657183`, 3.68}, {19.549999999999997`, 
     24.831835077845803`, 3.68}}, 1.32]}},
  ControllerMethod -> Automatic,
  AlignmentPoint->Center,
  AspectRatio->Automatic,
  Axes->False,
  AxesEdge->Automatic,
  AxesLabel->None,
  AxesOrigin->Automatic,
  AxesStyle->{},
  Background->None,
  BaseStyle->{},
  BaselinePosition->Automatic,
  BoxRatios->Automatic,
  BoxStyle->{},
  Boxed->False,
  ClipPlanes->None,
  ClipPlanesStyle->Automatic,
  ColorOutput->Automatic,
  ContentSelectable->Automatic,
  ControllerLinking->False,
  ControllerPath->Automatic,
  CoordinatesToolOptions:>Automatic,
  DisplayFunction->Identity,
  Epilog->{},
  FaceGrids->None,
  FaceGridsStyle->{},
  FormatType->TraditionalForm,
  ImageMargins->0.,
  ImagePadding->All,
  ImageSize->Automatic,
  ImageSizeRaw->Automatic,
  LabelStyle->{},
  Lighting->"Neutral",
  Method->Automatic,
  PlotLabel->None,
  PlotRange->All,
  PlotRangePadding->Automatic,
  PlotRegion->Automatic,
  PreserveImageOptions->Automatic,
  Prolog->{},
  RotationAction->"Fit",
  SphericalRegion->True,
  Ticks->Automatic,
  TicksStyle->{},
  TouchscreenAutoZoom->False,
  ViewAngle->NCache[90 Degree, 1.5707963267948966`],
  ViewCenter->Automatic,
  ViewMatrix->Automatic,
  ViewPoint->{0, 0, 
    DirectedInfinity[1]},
  ViewProjection->Automatic,
  ViewRange->All,
  ViewVector->Automatic,
  ViewVertical->{0, 0, 1}]], "Output",
 CellLabel->"Out[1]=",
 CellID->85427334]
}, Open  ]],

Cell["\<\
Distortions and rotations can also be performed according to user specified \
conditions:\
\>", "ExampleText",
 CellID->1049835416],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CrystalPlot", "[", 
  RowBox[{
   RowBox[{"EmbedStructure", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"x_", ",", "y_", ",", "z_"}], "}"}], "/;", 
         RowBox[{"OddQ", "@", 
          RowBox[{"IntegerPart", "[", 
           RowBox[{"x", "+", "y"}], "]"}]}]}], "\[Rule]", "\"\<Ni\>\""}], ",",
        "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"x_", ",", "y_", ",", "z_"}], "}"}], "/;", "True"}], 
        "\[Rule]", "\"\<Fe\>\""}]}], "\[IndentingNewLine]", "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"1", "/", "3"}], ",", 
        RowBox[{"2", "/", "3"}], ",", "0.5"}], "}"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"ExpandCrystal", "[", 
      RowBox[{"\"\<Ice\>\"", ",", 
       RowBox[{"{", 
        RowBox[{"5", ",", "4", ",", "1"}], "}"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<NewLabel\>\"", "\[Rule]", "\"\<AlternatingNickelIce\>\""}], 
     ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"\"\<Distortions\>\"", "\[Rule]", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"x_", ",", "y_", ",", "z_"}], "}"}], "/;", 
         RowBox[{
          RowBox[{"x", ">", "1"}], "&&", 
          RowBox[{"y", ">", "2"}]}]}], "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "8"}], "}"}]}], "\[IndentingNewLine]", 
       "}"}]}]}], "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"\"\<UnitCellDisplay\>\"", "\[Rule]", "\"\<None\>\""}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"ViewPoint", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"0.", ",", 
      RowBox[{"-", "4.4"}], ",", "3."}], "}"}]}]}], "]"}]], "Input",
 CellLabel->"In[2]:=",
 CellID->402317813],

Cell[BoxData[
 Graphics3DBox[{
   {RGBColor[0.800498, 0.201504, 0.192061], Opacity[1.], 
    SphereBox[CompressedData["
1:eJx1l1toVFcUhicaAzWFSWSIYiBgmMpkKioao8lJmE1AEBFBi9IHa0KIoE8m
JvqgIggGgoINhCIKUoqlYhEUBMELdYw0XlCw9YZDq7ZVtLQUvNFaX5zD2f85
7G8neQn8LNZZZ+9vzeGb07N17aYpqVQqU5FKTS3/735049S2UqVJ2b/+jukP
jvX9WojyN5fuDD1cEaSnGOWztn11cbBcv3zGunRHegbyTNxnZOxtbsOXNcbW
F1Wv3PYvqL/y29O6r+8oP3f+vctnSnX1cf+O3MKzA6VM8eNVM+e1pxvjfIOd
89zAgd+qR+fGue1TUB/1P9U0vLm2dnZR9cpn2znV350/U4z6fBr377vZ0v1J
obF4rOW/oRNHFsR5u50zt+Ds0fb0IuOeZ2XcR/3zt3paB0vZuF75aTun+ivf
2L/lj/C5v3f9VJVd0xz3H9u37llNbb54dOTvrdWjLd6cA99+t/L13WVxfvdx
Y09Nub/6qP/uob0/dJ2cF9dzTvV358zb9wpwDtk4V310j1mPN/u+hrw1Rc/1
eIvuMe/xZs/fkLf+6BwMebsfnYMhb3WWc/Jm+THk7YvoXgx567WckzfLsyFv
vXYfyZv2kbxl7Jzkrc7uI3nTPpK3zXZO8nbN7iN5E+fkzfa5RN5snwJ5E+fk
zb6Xx1uds48Jb73OfiW8Rfwv8niznHu8PW+4/U1YT94i/ps93uzeebztb2hb
suflQo+3g09WB+FzyZvdL483zUneKvrv7Aj7kze774a8aU7yZvfU4037SN40
J3mzvwMeb9pH8qY5yZv9XTLkTd8d8qY5yZv9nTTkTd8d8qY5yVu3s48B5skY
8hadc5vHW82urt76XIvHW+uDf+bWluvJW3Tv7R5vZ3Ze/3egzCF5++X+5+e3
XFnm8XY4N94YPpe8iXPypjnJ22dNr96H/cmbOCdvmpO8aR/Jmzgnb5qTvGkf
yZs4J2+ak7xpH8mbOCdvmpO8aR/Jmzgnb5qTvLn7GEyyXwHey3i89Sze82fV
/x0eb+NXq9aH9eQtOudOj7dpi1/sDjkkb4euXvj6+5XG4+2vJ0+Ph88lb+Kc
vGlO8vZz33Ax7E/exDl505zkTftI3sQ5edOc5E37SN7EOXnTnORN+0jexDl5
05zkTftI3sQ5edOc5M3dx2CS/Up4K21fvfTds06Pq5Pbp+4N+SEnP1reeO/i
h/coHngvul+es+6L56bz5znQU44cDv/qPU9RTk9x88SbroTtxz4y9Cbl9Cbl
9BT1p6cop6copzepP71JOb3JnT/xFPWnpyinp7jnmXiT+tOblNOblNNT1J+e
wjnFg3J6k/rTmzin+rtzJl7jnkPiQaqnp6ienqKcnqKc3qT+9Cbl9Cbl9BT1
p6e4z008RTm9Sf3pTe45JN7k1ieewn0kb/QUd/7Em7iP5I3epJyeQs7JGz1F
Ob2JnJM3epNyeo3604NUT09RPT1FOT1FOb1J/elNyulNyukpbv/EUzgneaM3
ue+b9XijN7n7kvd4o6dwTvJGb+I+kjd6k3J6Cr875I2eopzexO8OeaM3ufWJ
1/B7R97oKaqnpyinp7j33ubxRm9STm9STk8h5+SNnqKc3kTOyRu9iftI3ugp
nJO80ZvIOXmjN3EfyRs9hXOSN3oTOSdv9KaJ9zGYZL8CvFenxxs9RTk9xT1n
4/FGb1JOb1JOTyHn5I2eopzeRM7JG72J+0je6Cmck7zRm8g5eaM3cR/JGz2F
c5I3ehM5J2/0pon3MZhkvxLe6DWqpwepnl6jenqQ6uk1qqcHqZ5eo3p6kOo/
AOQMBHU=
     "], 0.66]}, 
   {RGBColor[0.65, 0.7, 0.7], Opacity[1.], SphereBox[CompressedData["
1:eJx1mHl0zlcax2NLVCxJRMROpDkRRCKLxCve65VBldCxBB2EYY60ErUUoyRi
rQq170s7NfaxTEsNIW859oxSS5sMEYJaOhSpWmo6ef2e7815v/fwR5zznHue
3/M+9/N87u/+mgwd9cfh5T08PCqW/qlQ+n9K4amdYwoqKg/5dzti8KCpU0rs
Vrwk9/zM/C62GuUV4oFjluaMK13/B78+NRJq+FHcX+d5dLd+hX9+X1PJeifW
Iy757ciP+NlKKSfHlz43/OI3XxYE1NP5E0Ij9o4t8HdW7Va7RbsaQTr+J6nz
X2PnXvNeHKLjkseOPMi/s9nHI3x96zqxHvG6Uifyu9fv77TyNNf5P8iLTXnT
HuT8IvbpzC2rWul4O6kztNXete1qtFbu/ayo8yB/2L+Hxo8rCNbrEd8ldSI/
4oNGpxa7nnt98DnP4Heidf7DM/rc9PENc65d8NMo78WxRp1jN2zs+vhCnI5f
uBo01Kc0P/Ig/+SZWYcGb2+h13OdyO9eZ5j8Lhv1IVjHsd7ax2CDN/m9inlr
Zj3X4M3axzCDN+m/Yt5GW31QzNslqw+KeQsQzpk34UcxbwOtfVHM2zDhnHkT
nhXzNkzmkXnDPDJv/lIn8xYg88i8YR6ZtxFSJ/N2QuaReQPnzJvkyWXeJI+d
eQPnzJv8LoO3ALd5LONtmNt8lfFm8d/a4E04N3j7seHZz13rmTeL/2iDN5k7
g7dPGraNyXgYYfA2vyjJ5nou8ybzZfCGOpm3cqPPj3flZ95k3hXzhjqZN5lT
gzfMI/OGOpk38YDBG+aReUOdzJt4STFvOHeYN9TJvIknFfOGc4d5Q53MW4rb
PNqoHn/FvFl9bmvw5vPR4GH1QmMN3uK/vx/iW7qeebP2vZ3B25eTTv46tpRD
5u3ypX77U4/EGbytDD0W5Hou8wbOmTfUybz1avbohSs/8wbOmTfUybxhHpk3
cM68oU7mDfPIvIFz5g11Mm+YR+YNnDNvqJN5wzwyb+CceUOdzJv7PNpeM182
+l3K4G1oVMYdz+cJBm/Hjnv2da1n3qw+OwzeKkXdnuzikHlbfvzA+q1dlcHb
vaIbm1zPZd7AOfOGOpm37z742OnKz7yBc+YNdTJvmEfmDZwzb6iTecM8Mm/g
nHlDncwb5pF5A+fMG+pk3jCPzBs4Z95QJ/PmPo+218xXGW8FHya1eXbTYXC1
/cMKWS5+mJOjwhvvO/jhfQQPvC/YX+4z9ov7hv5zH0rmtHtr/1+8NecLV1/z
nJxxwm7FX+RujL218/5+L4V49zWXH/RcUk7tGbv262NjqlPcV+cJS564fO7T
6krWO7EecclvR37EP9v/qP86r6v6voP8TRZnr5k5JcCpJhZUajapqeI6Z3Q+
4dUo9E0dX2Dl0fcd5D91qPm039MCnViPeJLUifzucV99T0H+4nLDe+3waeoc
uftKq9PTIow6q628EHGsf6SOP7H6rPMg/9fLozvdqxys1yOeJ3UiP+J/9az2
suaaxvqegvwx+6f/sPJ6mHNfyJnLWV3a6Ph1qbN/9aNXJjeK0/H1e/4THp3c
QOdB/jd69jp9qaC5Xo/4PqkT+RE//arOUP2eifxBr/oQouNYb/UnxODNyhOo
mDfpj8GbtY+hBm/WcwMU8yZ9UMzbOqsPinkTHhTzJvwo5m2itS+KeXsqnDNv
woli3jCPzJvkyWXeukmdzFs3mUfmTdYbvP0sdTJvmEfmTfps8IY6mbepMo/M
G+aReespdTJv7vNoo+d6G7xZcxpl8FbF4tzgrWXF+NAhlyIN3iwOow3eZO4M
3hLjz+1wDIg0eBv39rYmo3uEG7zJfBm8yTwavM23/X36L40iDN7ES4p5i5U6
mTeZU4M3cM68YR6ZN8wj84Z5ZN5Qp8GbzCPzBs6ZN9TJvGEemTfMI/OGOpm3
p27zaHvNfJXxZvHQ1uAtOeXE3b65MQZvmTnJ/+i2Od7gzdp3m8HbyKUpo+M6
xhi8LXv4ICq8RbzBW9VBJbU2PIs1eAsXzpm3vlIn81b0+Ejlaw/bGLyBc+Yt
Tepk3jCPzBs4Z95QJ/OGeWTeMI/MG+pk3jCPzBs4Z95QJ/OGeWTewDnzhjqZ
N/d5tL1mvsp46/jqd3UweNsS+OMox8IEg7fUtrY69Q8qgzerzx0M3g51z3zS
tFaCwdvj3rMvV81UBm8DA2qu/vR0e4O3qcI587ZV6mTeorZfn5d3xG7wBs6Z
N9TJvEXLPDJv4Jx5Q53MWxWZR+YN88i8LZE6mTdvmUfmDZwzb/2kTubtmswj
8wbOmTfUybxdd5vHMt72uc1XGW9Tbk97vmy3w+CqcoVvD84e6zA4AW/Ge7vw
w/u4WXjgfcH+cp+xX9w3cMJ9yK4Vs2JWVoBKdxT5dv7mlj1pqE+/+K/qq+I6
0SU9Fviq0MNV2mf7+inEH8l5URj2U/dlXz3V69cvLmxzaPyL3Kt5M8/tbh+o
ms8OyD/zq7e6v/i99fOPF+ZWCUm/t6ZKeR3HvWnCqU6N99zx13G89yI/4hNK
q03KLqfrRPzU/HkqJ91b14k47i/IjzrXWXXaUSfiJVaddtSJ+GeyfvKVl0sr
PGig4x5LrPXb3r41MWpJiI7juY9HrWvq8bfGOi59dnqd+8JxbGszXaf02Vl3
XM4S/+pBOo73xu96VLzb2SOUf5dCfsSlzlzUiXiR9B91Up+dyI86J1l91nUi
Ln3WdfL6PvlXgx9Ma2Gsb7L6z6lnS+/jiOO5cwZkTklrGa7jgS5x+zV1fjvQ
cabO6ihdZ+LRuMyaqxo7dw9aez9rZSsdx/t2zNpHnxccba3juP8iP+LzpP+o
k/uPOhHH/Q75UWdKu+mz/pcaqOtE/I24GWEx7zbQdSI+RNY/GZJiD/eKMdaP
9OkdMPtinI7juQuCdr2fdrls/XsvkvuuuhHmrHe+9UdnU9rqOpdNSa74+/uh
zg3B9g0TFsWW/S6552b5FSctnBuv47iPIz/i6D/q5P6jTsTlvqDzo85proPE
M1jXiXjyhZS6szJDdJ30uwz/yO8y/IP3B/aP7Iti/1S2+qzYP3vlfYb9g3sQ
+0d+l+Ef+V2GfxrL+zP7p7bVZ8X+6Wj1WbF/ZF8U+0f2RbF/8N7O/hkv/mT/
nBB/sn9OiIfZP7iXsX+Ec8X+8Zb+s39wv2b/zJHziP1zXc4j9g/OL/bPDVnP
/sF9h/0Df7J/xPO57J8u4mH2j3ynUuyfidJ/9k+e9J/9g/s++2eFnEfsH/G8
nf2D84v9g/OL/YPvIewfnF/sH+mz4R+PTywPs3/kdyn2D/rP/sH5xf7B90D2
z2Q5j9g/0mfDP157u+6KS4wx/FN/Qleve17Rhn86yvsk++dC9czul35obvhn
S3bm+tHvhBv+wfst+wfv4eyfxcVJd1IuRhr+yQjqsWiHb5ThH9yn2D+F/Q/8
1/FupOGfkroHEn9pGGH4B+vZP1jP/sFz2T/wJ/sH/mT/4F7J/kHf2D/oP/tn
q/Sf/YNzhP2D84j9s1TOI/YP1rN/sJ79g+eyf3B+sX+qiD/ZP7iPs3/QN/YP
+s/+Qf/ZPzhH2D84j9g/OL/YP1jP/sF69g+ey/6BP9k/8Cf7B9/B2D/oG/sH
/Wf/oP/sH5wj7B+cR+wfnF/sn/7pqTHBAQmGf9JbpWZfyrcZ/lkq9zj2T469
cFvfQzGGfzZlFPbe8DzW8A/uiewf3DfZPzdXp6V32xRv+OdsQVrtVcVtDf/g
exf7J8KvYEx4y3jDP53O558s+rmN4R+sZ/9gPfsH93r2D/zJ/oE/2T/wMPsH
fWP/oP/sH/Sf/YPvEuwfnEfsH5xH7B+sZ/9gPfsHz2X/wJ/sH5xf7B94mP2D
vrF/0H/2D/rP/sE5wv7BecT+wXnE/sF69g/Ws3/wXPYP/Mn+gT/ZP/Aw+wd9
Y/+g/+wf9J/9g3OE/YPziP2D84j907dm4hWvcQ7DP6++b1/sYPgH36nYP9We
/hbhWJBg+OdZ7Mv8T/PaG/4ZId/B2D/4nsb+qR927NnqHGX4Z+Fbnc4cHtDB
8E+ufB9j/6jhv73ILq2f/eM6XvIO2w3/OGQ9+2eFrGf/OOW57J8b4k/2D/zJ
/oGH2T/4fsj+qSH9Z/88l/6zf/A9kP3TT84j9g/OI/bPAFnP/sF69g+ey/45
IP5k/2wUf7J/MsTD7B/0jf1zS/rP/kH/2T84R9g/reQ8Yv8kynnE/omU9ewf
nF/sn3R5LvtnkfiT/QN/sn/gYfYPzi/2z0HpP/tns/Sf/YNzhP3jKecR+wfn
Efvn/5Zsp8c=
     "], 0.31]}, 
   {RGBColor[0.313725, 0.815686, 0.313725], Opacity[1.], 
    SphereBox[{{0., 4.514879105062873, 3.68}, {-3.91, 11.287197762657183`, 
     3.68}, {-7.819999999999999, 18.05951642025149, 3.68}, {
     3.9099999999999993`, 11.287197762657183`, 3.68}, {-3.91, 
     24.831835077845803`, 11.68}, {15.640000000000004`, 4.514879105062873, 
     3.68}, {7.820000000000004, 18.05951642025149, 11.68}, {
     19.550000000000004`, 11.287197762657183`, 3.68}, {11.730000000000004`, 
     24.831835077845803`, 11.68}, {31.279999999999998`, 4.514879105062873, 
     3.68}, {23.459999999999997`, 18.05951642025149, 11.68}}, 1.24]}, 
   {RGBColor[0.878431, 0.4, 0.2], Opacity[1.], 
    SphereBox[{{-11.73, 24.831835077845803`, 3.68}, {7.819999999999999, 
     4.514879105062873, 3.68}, {0., 18.05951642025149, 11.68}, {
     11.730000000000004`, 11.287197762657183`, 3.68}, {3.9100000000000037`, 
     24.831835077845803`, 11.68}, {23.460000000000004`, 4.514879105062873, 
     3.68}, {15.640000000000004`, 18.05951642025149, 11.68}, {
     27.369999999999997`, 11.287197762657183`, 3.68}, {19.549999999999997`, 
     24.831835077845803`, 11.68}}, 1.32]}},
  ControllerMethod -> Automatic,
  AlignmentPoint->Center,
  AspectRatio->Automatic,
  Axes->False,
  AxesEdge->Automatic,
  AxesLabel->None,
  AxesOrigin->Automatic,
  AxesStyle->{},
  Background->None,
  BaseStyle->{},
  BaselinePosition->Automatic,
  BoxRatios->Automatic,
  BoxStyle->{},
  Boxed->False,
  ClipPlanes->None,
  ClipPlanesStyle->Automatic,
  ColorOutput->Automatic,
  ContentSelectable->Automatic,
  ControllerLinking->False,
  ControllerPath->Automatic,
  CoordinatesToolOptions:>Automatic,
  DisplayFunction->Identity,
  Epilog->{},
  FaceGrids->None,
  FaceGridsStyle->{},
  FormatType->TraditionalForm,
  ImageMargins->0.,
  ImagePadding->All,
  ImageSize->Automatic,
  ImageSizeRaw->Automatic,
  LabelStyle->{},
  Lighting->"Neutral",
  Method->Automatic,
  PlotLabel->None,
  PlotRange->All,
  PlotRangePadding->Automatic,
  PlotRegion->Automatic,
  PreserveImageOptions->Automatic,
  Prolog->{},
  RotationAction->"Fit",
  SphericalRegion->True,
  Ticks->Automatic,
  TicksStyle->{},
  TouchscreenAutoZoom->False,
  ViewAngle->Automatic,
  ViewCenter->Automatic,
  ViewMatrix->Automatic,
  ViewPoint->{0., -4.4, 3.},
  ViewProjection->Automatic,
  ViewRange->All,
  ViewVector->Automatic,
  ViewVertical->{0, 0, 1}]], "Output",
 CellLabel->"Out[2]=",
 CellID->496783226]
}, Open  ]],

Cell["\<\
One can also make the distortions occur randomly, in addition to randomising \
the distortion amplitudes:\
\>", "ExampleText",
 CellID->1116149821],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CrystalPlot", "[", 
  RowBox[{
   RowBox[{"EmbedStructure", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"x_", ",", "y_", ",", "z_"}], "}"}], "/;", 
         RowBox[{"OddQ", "@", 
          RowBox[{"IntegerPart", "[", 
           RowBox[{"x", "+", "y"}], "]"}]}]}], "\[Rule]", "\"\<Ni\>\""}], ",",
        "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"x_", ",", "y_", ",", "z_"}], "}"}], "/;", "True"}], 
        "\[Rule]", "\"\<Fe\>\""}]}], "\[IndentingNewLine]", "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"1", "/", "3"}], ",", 
        RowBox[{"2", "/", "3"}], ",", "0.5"}], "}"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"ExpandCrystal", "[", 
      RowBox[{"\"\<Ice\>\"", ",", 
       RowBox[{"{", 
        RowBox[{"5", ",", "4", ",", "1"}], "}"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<NewLabel\>\"", "\[Rule]", "\"\<AlternatingNickelIce\>\""}], 
     ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"\"\<Distortions\>\"", "\[Rule]", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"x_", ",", "y_", ",", "z_"}], "}"}], "/;", 
         RowBox[{
          RowBox[{"RandomReal", "[", "]"}], ">", "0.75"}]}], "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", 
          RowBox[{"{", 
           RowBox[{"4", ",", "9"}], "}"}]}], "}"}]}], "\[IndentingNewLine]", 
       "}"}]}]}], "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"\"\<UnitCellDisplay\>\"", "\[Rule]", "\"\<None\>\""}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"ViewPoint", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"0.", ",", 
      RowBox[{"-", "4.4"}], ",", "1.5"}], "}"}]}]}], "]"}]], "Input",
 CellLabel->"In[3]:=",
 CellID->3218086],

Cell[BoxData[
 Graphics3DBox[{
   {RGBColor[0.800498, 0.201504, 0.192061], Opacity[1.], 
    SphereBox[CompressedData["
1:eJx1l1toVFcUhicaAzWFSWSIYiBgmMpkKioao8lJmE1AEBFBi9IHa0KIoE8m
JvqgIggGgoINhCIKUoqlYhEUBMELdYw0XlCw9YZDq7ZVtLQUvNFaX5zD2f85
7G8neQn8LNZZZ+9vzeGb07N17aYpqVQqU5FKTS3/735049S2UqVJ2b/+jukP
jvX9WojyN5fuDD1cEaSnGOWztn11cbBcv3zGunRHegbyTNxnZOxtbsOXNcbW
F1Wv3PYvqL/y29O6r+8oP3f+vctnSnX1cf+O3MKzA6VM8eNVM+e1pxvjfIOd
89zAgd+qR+fGue1TUB/1P9U0vLm2dnZR9cpn2znV350/U4z6fBr377vZ0v1J
obF4rOW/oRNHFsR5u50zt+Ds0fb0IuOeZ2XcR/3zt3paB0vZuF75aTun+ivf
2L/lj/C5v3f9VJVd0xz3H9u37llNbb54dOTvrdWjLd6cA99+t/L13WVxfvdx
Y09Nub/6qP/uob0/dJ2cF9dzTvV358zb9wpwDtk4V310j1mPN/u+hrw1Rc/1
eIvuMe/xZs/fkLf+6BwMebsfnYMhb3WWc/Jm+THk7YvoXgx567WckzfLsyFv
vXYfyZv2kbxl7Jzkrc7uI3nTPpK3zXZO8nbN7iN5E+fkzfa5RN5snwJ5E+fk
zb6Xx1uds48Jb73OfiW8Rfwv8niznHu8PW+4/U1YT94i/ps93uzeebztb2hb
suflQo+3g09WB+FzyZvdL483zUneKvrv7Aj7kze774a8aU7yZvfU4037SN40
J3mzvwMeb9pH8qY5yZv9XTLkTd8d8qY5yZv9nTTkTd8d8qY5yVu3s48B5skY
8hadc5vHW82urt76XIvHW+uDf+bWluvJW3Tv7R5vZ3Ze/3egzCF5++X+5+e3
XFnm8XY4N94YPpe8iXPypjnJ22dNr96H/cmbOCdvmpO8aR/Jmzgnb5qTvGkf
yZs4J2+ak7xpH8mbOCdvmpO8aR/Jmzgnb5qTvLn7GEyyXwHey3i89Sze82fV
/x0eb+NXq9aH9eQtOudOj7dpi1/sDjkkb4euXvj6+5XG4+2vJ0+Ph88lb+Kc
vGlO8vZz33Ax7E/exDl505zkTftI3sQ5edOc5E37SN7EOXnTnORN+0jexDl5
05zkTftI3sQ5edOc5M3dx2CS/Up4K21fvfTds06Pq5Pbp+4N+SEnP1reeO/i
h/coHngvul+es+6L56bz5znQU44cDv/qPU9RTk9x88SbroTtxz4y9Cbl9Cbl
9BT1p6cop6copzepP71JOb3JnT/xFPWnpyinp7jnmXiT+tOblNOblNNT1J+e
wjnFg3J6k/rTmzin+rtzJl7jnkPiQaqnp6ienqKcnqKc3qT+9Cbl9Cbl9BT1
p6e4z008RTm9Sf3pTe45JN7k1ieewn0kb/QUd/7Em7iP5I3epJyeQs7JGz1F
Ob2JnJM3epNyeo3604NUT09RPT1FOT1FOb1J/elNyulNyukpbv/EUzgneaM3
ue+b9XijN7n7kvd4o6dwTvJGb+I+kjd6k3J6Cr875I2eopzexO8OeaM3ufWJ
1/B7R97oKaqnpyinp7j33ubxRm9STm9STk8h5+SNnqKc3kTOyRu9iftI3ugp
nJO80ZvIOXmjN3EfyRs9hXOSN3oTOSdv9KaJ9zGYZL8CvFenxxs9RTk9xT1n
4/FGb1JOb1JOTyHn5I2eopzeRM7JG72J+0je6Cmck7zRm8g5eaM3cR/JGz2F
c5I3ehM5J2/0pon3MZhkvxLe6DWqpwepnl6jenqQ6uk1qqcHqZ5eo3p6kOo/
AOQMBHU=
     "], 0.66]}, 
   {RGBColor[0.65, 0.7, 0.7], Opacity[1.], SphereBox[CompressedData["
1:eJx1mHl0zlcax2NLVCxJRMROpDkRRCKLxCve65VBldCxBB2EYY60ErUUoyRi
rQq170s7NfaxTEsNIW859oxSS5sMEYJaOhSpWmo6ef2e7815v/fwR5zznHue
3/M+9/N87u/+mgwd9cfh5T08PCqW/qlQ+n9K4amdYwoqKg/5dzti8KCpU0rs
Vrwk9/zM/C62GuUV4oFjluaMK13/B78+NRJq+FHcX+d5dLd+hX9+X1PJeifW
Iy757ciP+NlKKSfHlz43/OI3XxYE1NP5E0Ij9o4t8HdW7Va7RbsaQTr+J6nz
X2PnXvNeHKLjkseOPMi/s9nHI3x96zqxHvG6Uifyu9fv77TyNNf5P8iLTXnT
HuT8IvbpzC2rWul4O6kztNXete1qtFbu/ayo8yB/2L+Hxo8rCNbrEd8ldSI/
4oNGpxa7nnt98DnP4Heidf7DM/rc9PENc65d8NMo78WxRp1jN2zs+vhCnI5f
uBo01Kc0P/Ig/+SZWYcGb2+h13OdyO9eZ5j8Lhv1IVjHsd7ax2CDN/m9inlr
Zj3X4M3axzCDN+m/Yt5GW31QzNslqw+KeQsQzpk34UcxbwOtfVHM2zDhnHkT
nhXzNkzmkXnDPDJv/lIn8xYg88i8YR6ZtxFSJ/N2QuaReQPnzJvkyWXeJI+d
eQPnzJv8LoO3ALd5LONtmNt8lfFm8d/a4E04N3j7seHZz13rmTeL/2iDN5k7
g7dPGraNyXgYYfA2vyjJ5nou8ybzZfCGOpm3cqPPj3flZ95k3hXzhjqZN5lT
gzfMI/OGOpk38YDBG+aReUOdzJt4STFvOHeYN9TJvIknFfOGc4d5Q53MW4rb
PNqoHn/FvFl9bmvw5vPR4GH1QmMN3uK/vx/iW7qeebP2vZ3B25eTTv46tpRD
5u3ypX77U4/EGbytDD0W5Hou8wbOmTfUybz1avbohSs/8wbOmTfUybxhHpk3
cM68oU7mDfPIvIFz5g11Mm+YR+YNnDNvqJN5wzwyb+CceUOdzJv7PNpeM182
+l3K4G1oVMYdz+cJBm/Hjnv2da1n3qw+OwzeKkXdnuzikHlbfvzA+q1dlcHb
vaIbm1zPZd7AOfOGOpm37z742OnKz7yBc+YNdTJvmEfmDZwzb6iTecM8Mm/g
nHlDncwb5pF5A+fMG+pk3jCPzBs4Z95QJ/PmPo+218xXGW8FHya1eXbTYXC1
/cMKWS5+mJOjwhvvO/jhfQQPvC/YX+4z9ov7hv5zH0rmtHtr/1+8NecLV1/z
nJxxwm7FX+RujL218/5+L4V49zWXH/RcUk7tGbv262NjqlPcV+cJS564fO7T
6krWO7EecclvR37EP9v/qP86r6v6voP8TRZnr5k5JcCpJhZUajapqeI6Z3Q+
4dUo9E0dX2Dl0fcd5D91qPm039MCnViPeJLUifzucV99T0H+4nLDe+3waeoc
uftKq9PTIow6q628EHGsf6SOP7H6rPMg/9fLozvdqxys1yOeJ3UiP+J/9az2
suaaxvqegvwx+6f/sPJ6mHNfyJnLWV3a6Ph1qbN/9aNXJjeK0/H1e/4THp3c
QOdB/jd69jp9qaC5Xo/4PqkT+RE//arOUP2eifxBr/oQouNYb/UnxODNyhOo
mDfpj8GbtY+hBm/WcwMU8yZ9UMzbOqsPinkTHhTzJvwo5m2itS+KeXsqnDNv
woli3jCPzJvkyWXeukmdzFs3mUfmTdYbvP0sdTJvmEfmTfps8IY6mbepMo/M
G+aReespdTJv7vNoo+d6G7xZcxpl8FbF4tzgrWXF+NAhlyIN3iwOow3eZO4M
3hLjz+1wDIg0eBv39rYmo3uEG7zJfBm8yTwavM23/X36L40iDN7ES4p5i5U6
mTeZU4M3cM68YR6ZN8wj84Z5ZN5Qp8GbzCPzBs6ZN9TJvGEemTfMI/OGOpm3
p27zaHvNfJXxZvHQ1uAtOeXE3b65MQZvmTnJ/+i2Od7gzdp3m8HbyKUpo+M6
xhi8LXv4ICq8RbzBW9VBJbU2PIs1eAsXzpm3vlIn81b0+Ejlaw/bGLyBc+Yt
Tepk3jCPzBs4Z95QJ/OGeWTeMI/MG+pk3jCPzBs4Z95QJ/OGeWTewDnzhjqZ
N/d5tL1mvsp46/jqd3UweNsS+OMox8IEg7fUtrY69Q8qgzerzx0M3g51z3zS
tFaCwdvj3rMvV81UBm8DA2qu/vR0e4O3qcI587ZV6mTeorZfn5d3xG7wBs6Z
N9TJvEXLPDJv4Jx5Q53MWxWZR+YN88i8LZE6mTdvmUfmDZwzb/2kTubtmswj
8wbOmTfUybxdd5vHMt72uc1XGW9Tbk97vmy3w+CqcoVvD84e6zA4AW/Ge7vw
w/u4WXjgfcH+cp+xX9w3cMJ9yK4Vs2JWVoBKdxT5dv7mlj1pqE+/+K/qq+I6
0SU9Fviq0MNV2mf7+inEH8l5URj2U/dlXz3V69cvLmxzaPyL3Kt5M8/tbh+o
ms8OyD/zq7e6v/i99fOPF+ZWCUm/t6ZKeR3HvWnCqU6N99zx13G89yI/4hNK
q03KLqfrRPzU/HkqJ91b14k47i/IjzrXWXXaUSfiJVaddtSJ+GeyfvKVl0sr
PGig4x5LrPXb3r41MWpJiI7juY9HrWvq8bfGOi59dnqd+8JxbGszXaf02Vl3
XM4S/+pBOo73xu96VLzb2SOUf5dCfsSlzlzUiXiR9B91Up+dyI86J1l91nUi
Ln3WdfL6PvlXgx9Ma2Gsb7L6z6lnS+/jiOO5cwZkTklrGa7jgS5x+zV1fjvQ
cabO6ihdZ+LRuMyaqxo7dw9aez9rZSsdx/t2zNpHnxccba3juP8iP+LzpP+o
k/uPOhHH/Q75UWdKu+mz/pcaqOtE/I24GWEx7zbQdSI+RNY/GZJiD/eKMdaP
9OkdMPtinI7juQuCdr2fdrls/XsvkvuuuhHmrHe+9UdnU9rqOpdNSa74+/uh
zg3B9g0TFsWW/S6552b5FSctnBuv47iPIz/i6D/q5P6jTsTlvqDzo85proPE
M1jXiXjyhZS6szJDdJ30uwz/yO8y/IP3B/aP7Iti/1S2+qzYP3vlfYb9g3sQ
+0d+l+Ef+V2GfxrL+zP7p7bVZ8X+6Wj1WbF/ZF8U+0f2RbF/8N7O/hkv/mT/
nBB/sn9OiIfZP7iXsX+Ec8X+8Zb+s39wv2b/zJHziP1zXc4j9g/OL/bPDVnP
/sF9h/0Df7J/xPO57J8u4mH2j3ynUuyfidJ/9k+e9J/9g/s++2eFnEfsH/G8
nf2D84v9g/OL/YPvIewfnF/sH+mz4R+PTywPs3/kdyn2D/rP/sH5xf7B90D2
z2Q5j9g/0mfDP157u+6KS4wx/FN/Qleve17Rhn86yvsk++dC9czul35obvhn
S3bm+tHvhBv+wfst+wfv4eyfxcVJd1IuRhr+yQjqsWiHb5ThH9yn2D+F/Q/8
1/FupOGfkroHEn9pGGH4B+vZP1jP/sFz2T/wJ/sH/mT/4F7J/kHf2D/oP/tn
q/Sf/YNzhP2D84j9s1TOI/YP1rN/sJ79g+eyf3B+sX+qiD/ZP7iPs3/QN/YP
+s/+Qf/ZPzhH2D84j9g/OL/YP1jP/sF69g+ey/6BP9k/8Cf7B9/B2D/oG/sH
/Wf/oP/sH5wj7B+cR+wfnF/sn/7pqTHBAQmGf9JbpWZfyrcZ/lkq9zj2T469
cFvfQzGGfzZlFPbe8DzW8A/uiewf3DfZPzdXp6V32xRv+OdsQVrtVcVtDf/g
exf7J8KvYEx4y3jDP53O558s+rmN4R+sZ/9gPfsH93r2D/zJ/oE/2T/wMPsH
fWP/oP/sH/Sf/YPvEuwfnEfsH5xH7B+sZ/9gPfsHz2X/wJ/sH5xf7B94mP2D
vrF/0H/2D/rP/sE5wv7BecT+wXnE/sF69g/Ws3/wXPYP/Mn+gT/ZP/Aw+wd9
Y/+g/+wf9J/9g3OE/YPziP2D84j907dm4hWvcQ7DP6++b1/sYPgH36nYP9We
/hbhWJBg+OdZ7Mv8T/PaG/4ZId/B2D/4nsb+qR927NnqHGX4Z+Fbnc4cHtDB
8E+ufB9j/6jhv73ILq2f/eM6XvIO2w3/OGQ9+2eFrGf/OOW57J8b4k/2D/zJ
/oGH2T/4fsj+qSH9Z/88l/6zf/A9kP3TT84j9g/OI/bPAFnP/sF69g+ey/45
IP5k/2wUf7J/MsTD7B/0jf1zS/rP/kH/2T84R9g/reQ8Yv8kynnE/omU9ewf
nF/sn3R5LvtnkfiT/QN/sn/gYfYPzi/2z0HpP/tns/Sf/YNzhP3jKecR+wfn
Efvn/5Zsp8c=
     "], 0.31]}, 
   {RGBColor[0.313725, 0.815686, 0.313725], Opacity[1.], 
    SphereBox[{{0., 4.514879105062873, 11.538348973030702`}, {-3.91, 
     11.287197762657183`, 8.928299371528233}, {-7.819999999999999, 
     18.05951642025149, 3.68}, {3.9099999999999993`, 11.287197762657183`, 
     3.68}, {-3.91, 24.831835077845803`, 9.669175819012324}, {
     15.640000000000004`, 4.514879105062873, 11.488015679820007`}, {
     7.820000000000004, 18.05951642025149, 10.023481327823697`}, {
     19.550000000000004`, 11.287197762657183`, 3.68}, {11.730000000000004`, 
     24.831835077845803`, 8.802103447595377}, {31.279999999999998`, 
     4.514879105062873, 3.68}, {23.459999999999997`, 18.05951642025149, 
     3.68}}, 1.24]}, 
   {RGBColor[0.878431, 0.4, 0.2], Opacity[1.], 
    SphereBox[{{-11.73, 24.831835077845803`, 3.68}, {7.819999999999999, 
     4.514879105062873, 3.68}, {0., 18.05951642025149, 9.241773200559832}, {
     11.730000000000004`, 11.287197762657183`, 8.429794688084051}, {
     3.9100000000000037`, 24.831835077845803`, 3.68}, {23.460000000000004`, 
     4.514879105062873, 9.601337571272069}, {15.640000000000004`, 
     18.05951642025149, 10.949611354715266`}, {27.369999999999997`, 
     11.287197762657183`, 3.68}, {19.549999999999997`, 24.831835077845803`, 
     9.078693001186345}}, 1.32]}},
  ControllerMethod -> Automatic,
  AlignmentPoint->Center,
  AspectRatio->Automatic,
  Axes->False,
  AxesEdge->Automatic,
  AxesLabel->None,
  AxesOrigin->Automatic,
  AxesStyle->{},
  Background->None,
  BaseStyle->{},
  BaselinePosition->Automatic,
  BoxRatios->Automatic,
  BoxStyle->{},
  Boxed->False,
  ClipPlanes->None,
  ClipPlanesStyle->Automatic,
  ColorOutput->Automatic,
  ContentSelectable->Automatic,
  ControllerLinking->False,
  ControllerPath->Automatic,
  CoordinatesToolOptions:>Automatic,
  DisplayFunction->Identity,
  Epilog->{},
  FaceGrids->None,
  FaceGridsStyle->{},
  FormatType->TraditionalForm,
  ImageMargins->0.,
  ImagePadding->All,
  ImageSize->Automatic,
  ImageSizeRaw->Automatic,
  LabelStyle->{},
  Lighting->"Neutral",
  Method->Automatic,
  PlotLabel->None,
  PlotRange->All,
  PlotRangePadding->Automatic,
  PlotRegion->Automatic,
  PreserveImageOptions->Automatic,
  Prolog->{},
  RotationAction->"Fit",
  SphericalRegion->True,
  Ticks->Automatic,
  TicksStyle->{},
  TouchscreenAutoZoom->False,
  ViewAngle->Automatic,
  ViewCenter->Automatic,
  ViewMatrix->Automatic,
  ViewPoint->{0., -4.4, 1.5},
  ViewProjection->Automatic,
  ViewRange->All,
  ViewVector->Automatic,
  ViewVertical->{0, 0, 1}]], "Output",
 CellLabel->"Out[3]=",
 CellID->1165692795]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Scope",
 "\[NonBreakingSpace]\[NonBreakingSpace]",
 Cell["(1)", "ExampleCount"]
}], "ExampleSection", "ExampleSection",
 WholeCellGroupOpener->True,
 CellID->1293636265],

Cell["\<\
In this example, we will build the crystal structure of household salt \
without importing any data. First we need an empty unit cell to work with. \
Note that the space group is also chosen at this point:\
\>", "ExampleText",
 CellID->1995082805],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SynthesiseStructure", "[", 
  RowBox[{"\"\<Void\>\"", ",", 
   RowBox[{"{", 
    RowBox[{
    "5.64", ",", "5.64", ",", "5.64", ",", "90", ",", "90", ",", "90"}], 
    "}"}], ",", "\"\<Fm-3m\>\"", ",", "\"\<BlankCell\>\""}], "]"}]], "Input",
 CellLabel->"In[1]:=",
 CellID->1727420408],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"\<\"SpaceGroup\"\>", 
    "\[Rule]", "\<\"Fm\\!\\(\\*OverscriptBox[\\(3\\), \\(_\\)]\\)m\"\>"}], 
   ",", 
   RowBox[{"\<\"LatticeParameters\"\>", "\[Rule]", 
    RowBox[{"\[LeftAssociation]", 
     RowBox[{
      RowBox[{"\<\"a\"\>", "\[Rule]", 
       TemplateBox[{
        "5.64`", "\"\[CapitalARing]\"", "\[ARing]ngstr\[ODoubleDot]ms", 
         "\"Angstroms\""},
        "Quantity"]}], ",", 
      RowBox[{"\<\"b\"\>", "\[Rule]", 
       TemplateBox[{
        "5.64`", "\"\[CapitalARing]\"", "\[ARing]ngstr\[ODoubleDot]ms", 
         "\"Angstroms\""},
        "Quantity"]}], ",", 
      RowBox[{"\<\"c\"\>", "\[Rule]", 
       TemplateBox[{
        "5.64`", "\"\[CapitalARing]\"", "\[ARing]ngstr\[ODoubleDot]ms", 
         "\"Angstroms\""},
        "Quantity"]}], ",", 
      RowBox[{"\<\"\[Alpha]\"\>", "\[Rule]", 
       TemplateBox[{"90", 
         RowBox[{"\[InvisibleSpace]", "\"\[Degree]\""}], "degrees", 
         "\"AngularDegrees\""},
        "QuantityPostfix"]}], ",", 
      RowBox[{"\<\"\[Beta]\"\>", "\[Rule]", 
       TemplateBox[{"90", 
         RowBox[{"\[InvisibleSpace]", "\"\[Degree]\""}], "degrees", 
         "\"AngularDegrees\""},
        "QuantityPostfix"]}], ",", 
      RowBox[{"\<\"\[Gamma]\"\>", "\[Rule]", 
       TemplateBox[{"90", 
         RowBox[{"\[InvisibleSpace]", "\"\[Degree]\""}], "degrees", 
         "\"AngularDegrees\""},
        "QuantityPostfix"]}]}], "\[RightAssociation]"}]}], ",", 
   RowBox[{"\<\"AtomData\"\>", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"\[LeftSkeleton]", "1", "\[RightSkeleton]"}], "}"}]}]}], 
  "}"}]], "Output",
 CellLabel->"Out[1]=",
 CellID->969876993]
}, Open  ]],

Cell[TextData[{
 "In the following, a sodium atom is first added at the origin of our empty \
cell, and we name our new structure ",
 StyleBox["Salt",
  FontSlant->"Italic"],
 ". Next we add a chlorine atom in the middle of the cell, this time mutating \
our ",
 StyleBox["Salt",
  FontSlant->"Italic"],
 " structure."
}], "ExampleText",
 CellID->1784098739],

Cell[BoxData[{
 RowBox[{
  RowBox[{"EmbedStructure", "[", 
   RowBox[{
    RowBox[{"{", "\"\<Na\>\"", "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0"}], "}"}], "}"}], ",", 
    "\"\<BlankCell\>\"", ",", 
    RowBox[{"\"\<NewLabel\>\"", "\[Rule]", "\"\<Salt\>\""}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"EmbedStructure", "[", 
   RowBox[{
    RowBox[{"{", "\"\<Cl\>\"", "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"1", "/", "2"}], ",", 
       RowBox[{"1", "/", "2"}], ",", 
       RowBox[{"1", "/", "2"}]}], "}"}], "}"}], ",", "\"\<Salt\>\""}], "]"}], 
  ";"}]}], "Input",
 CellLabel->"In[2]:=",
 CellID->1872692722],

Cell["Now we have the asymmetric unit ready:", "ExampleText",
 CellID->612503584],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CrystalPlot", "[", "\"\<Salt\>\"", "]"}]], "Input",
 CellLabel->"In[3]:=",
 CellID->713162879],

Cell[BoxData[
 Graphics3DBox[{
   {RGBColor[1, 0, 0], Arrow3DBox[Line3DBox[{{0, 0, 0}, {5.64, 0., 0.}}]]}, 
   {RGBColor[0, 1, 0], Arrow3DBox[Line3DBox[{{0, 0, 0}, {0., 5.64, 0.}}]]}, 
   {RGBColor[0, 0, 1], Arrow3DBox[Line3DBox[{{0, 0, 0}, {0., 0., 5.64}}]]}, 
   {GrayLevel[0], Line3DBox[{{0., 5.64, 0.}, {5.64, 5.64, 0.}}]}, 
   {GrayLevel[0], Line3DBox[{{5.64, 0., 0.}, {5.64, 5.64, 0.}}]}, 
   {GrayLevel[0], Line3DBox[{{5.64, 0., 0.}, {5.64, 0., 5.64}}]}, 
   {GrayLevel[0], Line3DBox[{{0., 5.64, 0.}, {0., 5.64, 5.64}}]}, 
   {GrayLevel[0], Line3DBox[{{5.64, 5.64, 0.}, {5.64, 5.64, 5.64}}]}, 
   {GrayLevel[0], Line3DBox[{{0., 0., 5.64}, {5.64, 0., 5.64}}]}, 
   {GrayLevel[0], Line3DBox[{{0., 0., 5.64}, {0., 5.64, 5.64}}]}, 
   {GrayLevel[0], Line3DBox[{{0., 5.64, 5.64}, {5.64, 5.64, 5.64}}]}, 
   {GrayLevel[0], Line3DBox[{{5.64, 0., 5.64}, {5.64, 5.64, 5.64}}]}, 
   {RGBColor[0.658708, 0.492173, 0.842842], Opacity[1.], 
    SphereBox[{{0., 0., 0.}}, 1.66]}, 
   {RGBColor[0.412698, 0.932689, 0.166398], Opacity[1.], 
    SphereBox[{{2.82, 2.82, 2.82}}, 1.02]}},
  ControllerMethod -> Automatic,
  AlignmentPoint->Center,
  AspectRatio->Automatic,
  Axes->False,
  AxesEdge->Automatic,
  AxesLabel->None,
  AxesOrigin->Automatic,
  AxesStyle->{},
  Background->None,
  BaseStyle->{},
  BaselinePosition->Automatic,
  BoxRatios->Automatic,
  BoxStyle->{},
  Boxed->False,
  ClipPlanes->None,
  ClipPlanesStyle->Automatic,
  ColorOutput->Automatic,
  ContentSelectable->Automatic,
  ControllerLinking->False,
  ControllerPath->Automatic,
  CoordinatesToolOptions:>Automatic,
  DisplayFunction->Identity,
  Epilog->{},
  FaceGrids->None,
  FaceGridsStyle->{},
  FormatType->TraditionalForm,
  ImageMargins->0.,
  ImagePadding->All,
  ImageSize->Automatic,
  ImageSizeRaw->Automatic,
  LabelStyle->{},
  Lighting->"Neutral",
  Method->Automatic,
  PlotLabel->None,
  PlotRange->All,
  PlotRangePadding->Automatic,
  PlotRegion->Automatic,
  PreserveImageOptions->Automatic,
  Prolog->{},
  RotationAction->"Fit",
  SphericalRegion->True,
  Ticks->Automatic,
  TicksStyle->{},
  TouchscreenAutoZoom->False,
  ViewAngle->Automatic,
  ViewCenter->Automatic,
  ViewMatrix->Automatic,
  ViewPoint->{1.3, -2.4, 2.},
  ViewProjection->Automatic,
  ViewRange->All,
  ViewVector->Automatic,
  ViewVertical->{0, 0, 1}]], "Output",
 CellLabel->"Out[3]=",
 CellID->1321740621]
}, Open  ]],

Cell["\<\
This can be expanded to a unit cell using the symmetry operations of the \
space group:\
\>", "ExampleText",
 CellID->414983949],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"ExpandCrystal", "[", "\"\<Salt\>\"", "]"}], "//", 
  "CrystalPlot"}]], "Input",
 CellLabel->"In[4]:=",
 CellID->958470616],

Cell[BoxData[
 Graphics3DBox[{
   {RGBColor[1, 0, 0], Arrow3DBox[Line3DBox[{{0, 0, 0}, {5.64, 0., 0.}}]]}, 
   {RGBColor[0, 1, 0], Arrow3DBox[Line3DBox[{{0, 0, 0}, {0., 5.64, 0.}}]]}, 
   {RGBColor[0, 0, 1], Arrow3DBox[Line3DBox[{{0, 0, 0}, {0., 0., 5.64}}]]}, 
   {GrayLevel[0], Line3DBox[{{0., 5.64, 0.}, {5.64, 5.64, 0.}}]}, 
   {GrayLevel[0], Line3DBox[{{5.64, 0., 0.}, {5.64, 5.64, 0.}}]}, 
   {GrayLevel[0], Line3DBox[{{5.64, 0., 0.}, {5.64, 0., 5.64}}]}, 
   {GrayLevel[0], Line3DBox[{{0., 5.64, 0.}, {0., 5.64, 5.64}}]}, 
   {GrayLevel[0], Line3DBox[{{5.64, 5.64, 0.}, {5.64, 5.64, 5.64}}]}, 
   {GrayLevel[0], Line3DBox[{{0., 0., 5.64}, {5.64, 0., 5.64}}]}, 
   {GrayLevel[0], Line3DBox[{{0., 0., 5.64}, {0., 5.64, 5.64}}]}, 
   {GrayLevel[0], Line3DBox[{{0., 5.64, 5.64}, {5.64, 5.64, 5.64}}]}, 
   {GrayLevel[0], Line3DBox[{{5.64, 0., 5.64}, {5.64, 5.64, 5.64}}]}, 
   {RGBColor[0.658708, 0.492173, 0.842842], Opacity[1.], 
    SphereBox[CompressedData["
1:eJxTTMoPSmViYGDgA2JmBtyg/9BXjZh+NgcYTUgeXR1+fWIY+mDi6Oqw2yeG
wz4xB3SaUvtxmYdLHgDQYGRy
     "], 1.66]}, 
   {RGBColor[0.412698, 0.932689, 0.166398], Opacity[1.], 
    SphereBox[CompressedData["
1:eJxTTMoPSmViYGDgBWJmIO4/9FUjpp/NAZ1mQAOE5NHV4eeLYchjFxfDcBch
/eg0fnWY7iJkHkweACxLZEE=
     "], 1.02]}},
  ControllerMethod -> Automatic,
  AlignmentPoint->Center,
  AspectRatio->Automatic,
  Axes->False,
  AxesEdge->Automatic,
  AxesLabel->None,
  AxesOrigin->Automatic,
  AxesStyle->{},
  Background->None,
  BaseStyle->{},
  BaselinePosition->Automatic,
  BoxRatios->Automatic,
  BoxStyle->{},
  Boxed->False,
  ClipPlanes->None,
  ClipPlanesStyle->Automatic,
  ColorOutput->Automatic,
  ContentSelectable->Automatic,
  ControllerLinking->False,
  ControllerPath->Automatic,
  CoordinatesToolOptions:>Automatic,
  DisplayFunction->Identity,
  Epilog->{},
  FaceGrids->None,
  FaceGridsStyle->{},
  FormatType->TraditionalForm,
  ImageMargins->0.,
  ImagePadding->All,
  ImageSize->Automatic,
  ImageSizeRaw->Automatic,
  LabelStyle->{},
  Lighting->"Neutral",
  Method->Automatic,
  PlotLabel->None,
  PlotRange->All,
  PlotRangePadding->Automatic,
  PlotRegion->Automatic,
  PreserveImageOptions->Automatic,
  Prolog->{},
  RotationAction->"Fit",
  SphericalRegion->True,
  Ticks->Automatic,
  TicksStyle->{},
  TouchscreenAutoZoom->False,
  ViewAngle->Automatic,
  ViewCenter->Automatic,
  ViewMatrix->Automatic,
  ViewPoint->{1.3, -2.4, 2.},
  ViewProjection->Automatic,
  ViewRange->All,
  ViewVector->Automatic,
  ViewVertical->{0, 0, 1}]], "Output",
 CellLabel->"Out[4]=",
 CellID->923772579]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 "Options",
 "\[NonBreakingSpace]\[NonBreakingSpace]",
 Cell["(6)", "ExampleCount"]
}], "ExampleSection", "ExampleSection",
 WholeCellGroupOpener->True,
 CellID->2061341341],

Cell[CellGroupData[{

Cell[TextData[{
 "\"MatchHostSize\"",
 "\[NonBreakingSpace]\[NonBreakingSpace]",
 Cell["(1)", "ExampleCount"]
}], "ExampleSubsection", "ExampleSubsection",
 WholeCellGroupOpener->True,
 CellID->1757724783],

Cell[TextData[{
 "With this option set to ",
 Cell[BoxData[
  TemplateBox[{
    Cell[
     TextData["False"]], "paclet:ref/False"},
   "RefLink",
   BaseStyle->{"InlineFormula"}]], "InlineFormula"],
 ", only the position explicitly inputted will be used. If set to ",
 Cell[BoxData[
  TemplateBox[{
    Cell[
     TextData["True"]], "paclet:ref/True"},
   "RefLink",
   BaseStyle->{"InlineFormula"}]], "InlineFormula"],
 ", the positions are copied by translation to cover the size of the host."
}], "ExampleText",
 CellID->1268678943],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Table", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"CrystalPlot", "[", 
    RowBox[{
     RowBox[{"EmbedStructure", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", "\"\<Mo\>\"", "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"0", ",", 
          RowBox[{"1", "/", "2"}], ",", 
          RowBox[{"1", "/", "2"}]}], "}"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"ExpandCrystal", "[", 
        RowBox[{"\"\<Cobalt(II)Fluoride\>\"", ",", 
         RowBox[{"{", 
          RowBox[{"3", ",", "2", ",", "1"}], "}"}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<NewLabel\>\"", "\[Rule]", "\"\<DemoStructure\>\""}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<MatchHostSize\>\"", "\[Rule]", "tf"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<UnitCellDisplay\>\"", "\[Rule]", "\"\<Box\>\""}], ",", 
     RowBox[{"ViewPoint", "\[Rule]", "Above"}]}], "]"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"tf", ",", 
     RowBox[{"{", 
      RowBox[{"False", ",", "True"}], "}"}]}], "}"}]}], "]"}]], "Input",
 CellLabel->"In[1]:=",
 CellID->532886137],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   Graphics3DBox[{
     {RGBColor[1, 0, 0], Arrow3DBox[Line3DBox[{{0, 0, 0}, {4.695, 0., 0.}}]]}, 
     {RGBColor[0, 1, 0], Arrow3DBox[Line3DBox[{{0, 0, 0}, {0., 4.695, 0.}}]]}, 
     {RGBColor[0, 0, 1], 
      Arrow3DBox[Line3DBox[{{0, 0, 0}, {0., 0., 3.1785}}]]}, 
     {GrayLevel[0], Line3DBox[{{0., 4.695, 0.}, {4.695, 4.695, 0.}}]}, 
     {GrayLevel[0], Line3DBox[{{4.695, 0., 0.}, {4.695, 4.695, 0.}}]}, 
     {GrayLevel[0], Line3DBox[{{4.695, 0., 0.}, {4.695, 0., 3.1785}}]}, 
     {GrayLevel[0], Line3DBox[{{0., 4.695, 0.}, {0., 4.695, 3.1785}}]}, 
     {GrayLevel[0], 
      Line3DBox[{{4.695, 4.695, 0.}, {4.695, 4.695, 3.1785}}]}, 
     {GrayLevel[0], Line3DBox[{{0., 0., 3.1785}, {4.695, 0., 3.1785}}]}, 
     {GrayLevel[0], Line3DBox[{{0., 0., 3.1785}, {0., 4.695, 3.1785}}]}, 
     {GrayLevel[0], Line3DBox[{{0., 4.695, 3.1785}, {4.695, 4.695, 3.1785}}]}, 
     {GrayLevel[0], Line3DBox[{{4.695, 0., 3.1785}, {4.695, 4.695, 3.1785}}]}, 
     {RGBColor[0.941176, 0.564706, 0.627451], Opacity[1.], 
      SphereBox[CompressedData["
1:eJxTTMoPSmViYGCQA2JmBtzA42GVyLrjTA4wWnFDUcbE3J/26Oog4pwOqPqE
HNDNeRO4Q65VWwbDHJh67OYowfno4jD16PbBAMw+dPejq0c3B10eZg66+9HV
YzcH4X50cVT1mP6cNRMIKtVxuB+hHt0cdPfDzMHufiUc7lfC4X4lDPdDzNXB
Ef4IcXT12MNZB8M9qOJKONQj3AMAHVraqg==
       "], 1.26]}, 
     {RGBColor[0.578462, 0.85539, 0.408855], Opacity[1.], 
      SphereBox[CompressedData["
1:eJxTTMoPSmViYGBQAWJmIP586uu2mae+2cNoBigQu1vly6/F5QCjYeKW7/8/
bul8a3/o2Nf3v3T4HBQ3FGVMzP0J58PkYeLo5kPEOR3QzYeJw9SxhFg0hVRJ
OKC754q/xe6td+Qx3BPyyOqY6HsFDPcY3P+14V6FmAO6e2Dmo7sHZj5MHKYO
PXxg6tDDB2YfevjA3IcePujmw+xFNx/dPejhA1OPHj4w96CHD4yPHj7o5qO7
Bz18ls2K9GZcqIoRPn0zbj43DNLECB+bB7uS3BaoYITPj6CKC2+CtDDCB918
mL3o5qO7Bz18YOrRwwfmHvTwgbkHPXzQzUd3D3r4AADLUmmq
       "], 0.57]}, 
     {RGBColor[0.310325, 0.752163, 0.769323], Opacity[1.], 
      SphereBox[{{0., 2.3475, 1.58925}}, 1.54]}},
    ControllerMethod -> Automatic,
    AlignmentPoint->Center,
    AspectRatio->Automatic,
    Axes->False,
    AxesEdge->Automatic,
    AxesLabel->None,
    AxesOrigin->Automatic,
    AxesStyle->{},
    Background->None,
    BaseStyle->{},
    BaselinePosition->Automatic,
    BoxRatios->Automatic,
    BoxStyle->{},
    Boxed->False,
    ClipPlanes->None,
    ClipPlanesStyle->Automatic,
    ColorOutput->Automatic,
    ContentSelectable->Automatic,
    ControllerLinking->False,
    ControllerPath->Automatic,
    CoordinatesToolOptions:>Automatic,
    DisplayFunction->Identity,
    Epilog->{},
    FaceGrids->None,
    FaceGridsStyle->{},
    FormatType->TraditionalForm,
    ImageMargins->0.,
    ImagePadding->All,
    ImageSize->Automatic,
    ImageSizeRaw->Automatic,
    LabelStyle->{},
    Lighting->"Neutral",
    Method->Automatic,
    PlotLabel->None,
    PlotRange->All,
    PlotRangePadding->Automatic,
    PlotRegion->Automatic,
    PreserveImageOptions->Automatic,
    Prolog->{},
    RotationAction->"Fit",
    SphericalRegion->True,
    Ticks->Automatic,
    TicksStyle->{},
    TouchscreenAutoZoom->False,
    ViewAngle->Automatic,
    ViewCenter->Automatic,
    ViewMatrix->Automatic,
    ViewPoint->Above,
    ViewProjection->Automatic,
    ViewRange->All,
    ViewVector->Automatic,
    ViewVertical->{0, 0, 1}], ",", 
   Graphics3DBox[{
     {RGBColor[1, 0, 0], Arrow3DBox[Line3DBox[{{0, 0, 0}, {4.695, 0., 0.}}]]}, 
     {RGBColor[0, 1, 0], Arrow3DBox[Line3DBox[{{0, 0, 0}, {0., 4.695, 0.}}]]}, 
     {RGBColor[0, 0, 1], 
      Arrow3DBox[Line3DBox[{{0, 0, 0}, {0., 0., 3.1785}}]]}, 
     {GrayLevel[0], Line3DBox[{{0., 4.695, 0.}, {4.695, 4.695, 0.}}]}, 
     {GrayLevel[0], Line3DBox[{{4.695, 0., 0.}, {4.695, 4.695, 0.}}]}, 
     {GrayLevel[0], Line3DBox[{{4.695, 0., 0.}, {4.695, 0., 3.1785}}]}, 
     {GrayLevel[0], Line3DBox[{{0., 4.695, 0.}, {0., 4.695, 3.1785}}]}, 
     {GrayLevel[0], 
      Line3DBox[{{4.695, 4.695, 0.}, {4.695, 4.695, 3.1785}}]}, 
     {GrayLevel[0], Line3DBox[{{0., 0., 3.1785}, {4.695, 0., 3.1785}}]}, 
     {GrayLevel[0], Line3DBox[{{0., 0., 3.1785}, {0., 4.695, 3.1785}}]}, 
     {GrayLevel[0], Line3DBox[{{0., 4.695, 3.1785}, {4.695, 4.695, 3.1785}}]}, 
     {GrayLevel[0], Line3DBox[{{4.695, 0., 3.1785}, {4.695, 4.695, 3.1785}}]}, 
     {RGBColor[0.941176, 0.564706, 0.627451], Opacity[1.], 
      SphereBox[CompressedData["
1:eJxTTMoPSmViYGCQA2JmBtzA42GVyLrjTA4wWnFDUcbE3J/26Oog4pwOqPqE
HNDNeRO4Q65VWwbDHJh67OYowfno4jD16PbBAMw+dPejq0c3B10eZg66+9HV
YzcH4X50cVT1mP6cNRMIKtVxuB+hHt0cdPfDzMHufiUc7lfC4X4lDPdDzNXB
Ef4IcXT12MNZB8M9qOJKONQj3AMAHVraqg==
       "], 1.26]}, 
     {RGBColor[0.578462, 0.85539, 0.408855], Opacity[1.], 
      SphereBox[CompressedData["
1:eJxTTMoPSmViYGBQAWJmIP586uu2mae+2cNoBigQu1vly6/F5QCjYeKW7/8/
bul8a3/o2Nf3v3T4HBQ3FGVMzP0J58PkYeLo5kPEOR3QzYeJw9SxhFg0hVRJ
OKC754q/xe6td+Qx3BPyyOqY6HsFDPcY3P+14V6FmAO6e2Dmo7sHZj5MHKYO
PXxg6tDDB2YfevjA3IcePujmw+xFNx/dPejhA1OPHj4w96CHD4yPHj7o5qO7
Bz18ls2K9GZcqIoRPn0zbj43DNLECB+bB7uS3BaoYITPj6CKC2+CtDDCB918
mL3o5qO7Bz18YOrRwwfmHvTwgbkHPXzQzUd3D3r4AADLUmmq
       "], 0.57]}, 
     {RGBColor[0.310325, 0.752163, 0.769323], Opacity[1.], 
      SphereBox[{{0., 2.3475, 1.58925}, {0., 7.0425, 1.58925}, {4.695, 2.3475,
        1.58925}, {4.695, 7.0425, 1.58925}, {9.39, 2.3475, 1.58925}, {9.39, 
       7.0425, 1.58925}}, 1.54]}},
    ControllerMethod -> Automatic,
    AlignmentPoint->Center,
    AspectRatio->Automatic,
    Axes->False,
    AxesEdge->Automatic,
    AxesLabel->None,
    AxesOrigin->Automatic,
    AxesStyle->{},
    Background->None,
    BaseStyle->{},
    BaselinePosition->Automatic,
    BoxRatios->Automatic,
    BoxStyle->{},
    Boxed->False,
    ClipPlanes->None,
    ClipPlanesStyle->Automatic,
    ColorOutput->Automatic,
    ContentSelectable->Automatic,
    ControllerLinking->False,
    ControllerPath->Automatic,
    CoordinatesToolOptions:>Automatic,
    DisplayFunction->Identity,
    Epilog->{},
    FaceGrids->None,
    FaceGridsStyle->{},
    FormatType->TraditionalForm,
    ImageMargins->0.,
    ImagePadding->All,
    ImageSize->Automatic,
    ImageSizeRaw->Automatic,
    LabelStyle->{},
    Lighting->"Neutral",
    Method->Automatic,
    PlotLabel->None,
    PlotRange->All,
    PlotRangePadding->Automatic,
    PlotRegion->Automatic,
    PreserveImageOptions->Automatic,
    Prolog->{},
    RotationAction->"Fit",
    SphericalRegion->True,
    Ticks->Automatic,
    TicksStyle->{},
    TouchscreenAutoZoom->False,
    ViewAngle->Automatic,
    ViewCenter->Automatic,
    ViewMatrix->Automatic,
    ViewPoint->Above,
    ViewProjection->Automatic,
    ViewRange->All,
    ViewVector->Automatic,
    ViewVertical->{0, 0, 1}]}], "}"}]], "Output",
 CellLabel->"Out[1]=",
 CellID->234672469]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 "\"TrimBoundary\"",
 "\[NonBreakingSpace]\[NonBreakingSpace]",
 Cell["(1)", "ExampleCount"]
}], "ExampleSubsection", "ExampleSubsection",
 WholeCellGroupOpener->True,
 CellID->166498975],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Column", "@", 
  RowBox[{"Table", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"CrystalPlot", "[", 
     RowBox[{"EmbedStructure", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", "\"\<Ni\>\"", "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"3", "/", "4"}], ",", 
          RowBox[{"1", "/", "4"}], ",", "0"}], "}"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"ExpandCrystal", "[", "\"\<PrussianBlue\>\"", "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<NewLabel\>\"", "\[Rule]", "\"\<DemoStructure\>\""}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<TrimBoundary\>\"", "\[Rule]", "trimType"}]}], "]"}], 
     "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"trimType", ",", 
      RowBox[{"{", 
       RowBox[{
       "\"\<None\>\"", ",", "\"\<OuterEdges\>\"", ",", "\"\<Box\>\""}], 
       "}"}]}], "}"}]}], "]"}]}]], "Input",
 CellLabel->"In[1]:=",
 CellID->1769743483],

Cell[BoxData[
 TagBox[GridBox[{
    {
     Graphics3DBox[{
       {RGBColor[1, 0, 0], 
        Arrow3DBox[Line3DBox[{{0, 0, 0}, {10.166, 0., 0.}}]]}, 
       {RGBColor[0, 1, 0], 
        Arrow3DBox[Line3DBox[{{0, 0, 0}, {0., 10.166, 0.}}]]}, 
       {RGBColor[0, 0, 1], 
        Arrow3DBox[Line3DBox[{{0, 0, 0}, {0., 0., 10.166}}]]}, 
       {GrayLevel[0], Line3DBox[{{0., 10.166, 0.}, {10.166, 10.166, 0.}}]}, 
       {GrayLevel[0], Line3DBox[{{10.166, 0., 0.}, {10.166, 10.166, 0.}}]}, 
       {GrayLevel[0], Line3DBox[{{10.166, 0., 0.}, {10.166, 0., 10.166}}]}, 
       {GrayLevel[0], Line3DBox[{{0., 10.166, 0.}, {0., 10.166, 10.166}}]}, 
       {GrayLevel[0], 
        Line3DBox[{{10.166, 10.166, 0.}, {10.166, 10.166, 10.166}}]}, 
       {GrayLevel[0], Line3DBox[{{0., 0., 10.166}, {10.166, 0., 10.166}}]}, 
       {GrayLevel[0], Line3DBox[{{0., 0., 10.166}, {0., 10.166, 10.166}}]}, 
       {GrayLevel[0], 
        Line3DBox[{{0., 10.166, 10.166}, {10.166, 10.166, 10.166}}]}, 
       {GrayLevel[0], 
        Line3DBox[{{10.166, 0., 10.166}, {10.166, 10.166, 10.166}}]}, 
       {RGBColor[0.800498, 0.201504, 0.192061], Opacity[1.], 
        SphereBox[CompressedData["
1:eJxTTMoPSmViYGCwA2JmIP7pd6bKUITRYZHrts9/Q0Tg9GND5qkf+RUwxGE0
rfT5f3vw/4YpKwYtI1CTzs8vB6fRxQnx0cVxyZNrD4z2tlmQc2oqO9xfDFAg
lyuzUey+DIY4DBCrD12eWH0wdTB5mDhMHbp5hNSh20dIHcxcdPdCaBUH7P5U
wXA/ujiqPhUM/YTso5W5uPyBy1yYebD8gZ4+YPkDXRwGaKUPXR7mbnRzYeLo
5qKLo5YPKg7EqkN3H7p+XO5DNx9dHl2cWHOp7W9S3YVLHwDDmB2o
         "], 0.66]}, 
       {RGBColor[0.878431, 0.4, 0.2], Opacity[1.], SphereBox[CompressedData["
1:eJxTTMoPSmViYGCQBmJmIF7kuu3z3xARBwYcgFh5dHUQvooDdnUqDuh87Oai
q0PXj06Tbz9x5qG7g1J5XO7AxcdN44ofXOGKi489/BE0sebh0odLHgDyeOao

         "], 1.32]}, 
       {RGBColor[0.4, 0.4, 0.4], Opacity[1.], SphereBox[CompressedData["
1:eJxTTMoPSmViYGAwA2JmIF6cxTr9hhunAwMa+Hj15ex+NhkMcRiglT50+UWu
2z7/DVFxQDcXJo5uLro4TB9MnFh16O5D14/Lfejmo8ujixNrLrX9Taq7cOmr
YUzaXrLxnz1EXARufxHrqZjzdQoO6OIwQKw+dHli9cHUoYabiANMHbp5hNSh
20dIHcxcdPfCwg+7P1Uw3I8ujqpPBUM/IftoZS4uf+AyF2YeavpCxDdquhTB
oGmlDwDCrfeZ
         "], 0.76]}, 
       {RGBColor[0.291989, 0.437977, 0.888609], Opacity[1.], 
        SphereBox[CompressedData["
1:eJxTTMoPSmViYGAwA2JmIDb46B6Y7sfgsMh12+e/ISJwOswzRT7FUQFDHEbT
Sp/wLJVpU6I54OIMUGBlFzXHsEYGQxwGiNWHLk+sPpg6mDxMHKYO3TxC6tDt
I6QOZi66eyG0igN2f6pguB9dHFWfCoZ+QvbRylxc/sBlLsw8WPpCTx+w9IUu
DgO00ocuD3M3urkwcXRz0cVR85eKA7Hq0N2Hrh+X+9DNR5dHFyfWXGr7m1R3
4dIHAPKeuJM=
         "], 0.71]}, 
       {RGBColor[0.313725, 0.815686, 0.313725], Opacity[1.], 
        SphereBox[{{7.6245, 2.5415, 0.}}, 1.24]}},
      ControllerMethod -> Automatic,
      AlignmentPoint->Center,
      AspectRatio->Automatic,
      Axes->False,
      AxesEdge->Automatic,
      AxesLabel->None,
      AxesOrigin->Automatic,
      AxesStyle->{},
      Background->None,
      BaseStyle->{},
      BaselinePosition->Automatic,
      BoxRatios->Automatic,
      BoxStyle->{},
      Boxed->False,
      ClipPlanes->None,
      ClipPlanesStyle->Automatic,
      ColorOutput->Automatic,
      ContentSelectable->Automatic,
      ControllerLinking->False,
      ControllerPath->Automatic,
      CoordinatesToolOptions:>Automatic,
      DisplayFunction->Identity,
      Epilog->{},
      FaceGrids->None,
      FaceGridsStyle->{},
      FormatType->TraditionalForm,
      ImageMargins->0.,
      ImagePadding->All,
      ImageSize->Automatic,
      ImageSizeRaw->Automatic,
      LabelStyle->{},
      Lighting->"Neutral",
      Method->Automatic,
      PlotLabel->None,
      PlotRange->All,
      PlotRangePadding->Automatic,
      PlotRegion->Automatic,
      PreserveImageOptions->Automatic,
      Prolog->{},
      RotationAction->"Fit",
      SphericalRegion->True,
      Ticks->Automatic,
      TicksStyle->{},
      TouchscreenAutoZoom->False,
      ViewAngle->Automatic,
      ViewCenter->Automatic,
      ViewMatrix->Automatic,
      ViewPoint->{1.3, -2.4, 2.},
      ViewProjection->Automatic,
      ViewRange->All,
      ViewVector->Automatic,
      ViewVertical->{0, 0, 1}]},
    {
     Graphics3DBox[{
       {RGBColor[1, 0, 0], 
        Arrow3DBox[Line3DBox[{{0, 0, 0}, {10.166, 0., 0.}}]]}, 
       {RGBColor[0, 1, 0], 
        Arrow3DBox[Line3DBox[{{0, 0, 0}, {0., 10.166, 0.}}]]}, 
       {RGBColor[0, 0, 1], 
        Arrow3DBox[Line3DBox[{{0, 0, 0}, {0., 0., 10.166}}]]}, 
       {GrayLevel[0], Line3DBox[{{0., 10.166, 0.}, {10.166, 10.166, 0.}}]}, 
       {GrayLevel[0], Line3DBox[{{10.166, 0., 0.}, {10.166, 10.166, 0.}}]}, 
       {GrayLevel[0], Line3DBox[{{10.166, 0., 0.}, {10.166, 0., 10.166}}]}, 
       {GrayLevel[0], Line3DBox[{{0., 10.166, 0.}, {0., 10.166, 10.166}}]}, 
       {GrayLevel[0], 
        Line3DBox[{{10.166, 10.166, 0.}, {10.166, 10.166, 10.166}}]}, 
       {GrayLevel[0], Line3DBox[{{0., 0., 10.166}, {10.166, 0., 10.166}}]}, 
       {GrayLevel[0], Line3DBox[{{0., 0., 10.166}, {0., 10.166, 10.166}}]}, 
       {GrayLevel[0], 
        Line3DBox[{{0., 10.166, 10.166}, {10.166, 10.166, 10.166}}]}, 
       {GrayLevel[0], 
        Line3DBox[{{10.166, 0., 10.166}, {10.166, 10.166, 10.166}}]}, 
       {RGBColor[0.800498, 0.201504, 0.192061], Opacity[1.], 
        SphereBox[CompressedData["
1:eJxTTMoPSmViYGDQAGJmIP7pd6bKUITRYZHrts9/Q0Tg9GND5qkf+RUwxGE0
rfT5f3vw/4YpKwYtI1CTzs8vB6fRxQnx0cVxyZNrD4z2tlmQc2oqO9xfDFAg
lyuzUey+DIY4DBCrD12eWH0wdTB5mDhMHbp5hNSh20dIHcxcdPdCaBUH7P5U
wXA/ujiqPhV4+kIPX1j6QheHAVrpQ5eHuRPdXJg4urno4qj5S8UBAAAcQe4=

         "], 0.66]}, 
       {RGBColor[0.878431, 0.4, 0.2], Opacity[1.], 
        SphereBox[{{5.083, 0., 0.}, {0., 5.083, 0.}, {0., 0., 5.083}, {5.083, 
         0., 10.166}, {0., 5.083, 10.166}, {0., 5.083, 5.083}, {5.083, 0., 
         5.083}, {5.083, 5.083, 0.}, {5.083, 5.083, 10.166}, {5.083, 5.083, 
         5.083}, {0., 0., 0.}, {0., 0., 10.166}}, 1.32]}, 
       {RGBColor[0.4, 0.4, 0.4], Opacity[1.], SphereBox[CompressedData["
1:eJxTTMoPSmViYGBQAGJmIF6cxTr9hhunAwMa+Hj15ex+NhkMcRiglT50+UWu
2z7/DVFxQDcXJo5uLro4TB9MvIYxaXvJxn/2EL4IXF0R66mY83UKDujiMECs
PnR5YvXB1KH6T8QBpg7dPELq0O0jpA5mLrp7YeGG3Z8qGO5HF0fVp+KAGk+I
8EKNJxEMmlb6AH2WDjo=
         "], 0.76]}, 
       {RGBColor[0.291989, 0.437977, 0.888609], Opacity[1.], 
        SphereBox[CompressedData["
1:eJxTTMoPSmViYGBQAGJmIDb46B6Y7sfgsMh12+e/ISJwOswzRT7FUQFDHEbT
Sp/wLJVpU6I54OIMUGBlFzXHsEYGQxwGiNWHLk+sPpg6mDxMHKYO3TxC6tDt
I6QOZi66eyG0igN2f6pguB9dHFWfCjx+0MMXFj/o4jBAK33o8jB3opsLE0c3
F10cNX2qOAAA27bpEw==
         "], 0.71]}, 
       {RGBColor[0.313725, 0.815686, 0.313725], Opacity[1.], 
        SphereBox[{{7.6245, 2.5415, 0.}}, 1.24]}},
      ControllerMethod -> Automatic,
      AlignmentPoint->Center,
      AspectRatio->Automatic,
      Axes->False,
      AxesEdge->Automatic,
      AxesLabel->None,
      AxesOrigin->Automatic,
      AxesStyle->{},
      Background->None,
      BaseStyle->{},
      BaselinePosition->Automatic,
      BoxRatios->Automatic,
      BoxStyle->{},
      Boxed->False,
      ClipPlanes->None,
      ClipPlanesStyle->Automatic,
      ColorOutput->Automatic,
      ContentSelectable->Automatic,
      ControllerLinking->False,
      ControllerPath->Automatic,
      CoordinatesToolOptions:>Automatic,
      DisplayFunction->Identity,
      Epilog->{},
      FaceGrids->None,
      FaceGridsStyle->{},
      FormatType->TraditionalForm,
      ImageMargins->0.,
      ImagePadding->All,
      ImageSize->Automatic,
      ImageSizeRaw->Automatic,
      LabelStyle->{},
      Lighting->"Neutral",
      Method->Automatic,
      PlotLabel->None,
      PlotRange->All,
      PlotRangePadding->Automatic,
      PlotRegion->Automatic,
      PreserveImageOptions->Automatic,
      Prolog->{},
      RotationAction->"Fit",
      SphericalRegion->True,
      Ticks->Automatic,
      TicksStyle->{},
      TouchscreenAutoZoom->False,
      ViewAngle->Automatic,
      ViewCenter->Automatic,
      ViewMatrix->Automatic,
      ViewPoint->{1.3, -2.4, 2.},
      ViewProjection->Automatic,
      ViewRange->All,
      ViewVector->Automatic,
      ViewVertical->{0, 0, 1}]},
    {
     Graphics3DBox[{
       {RGBColor[1, 0, 0], 
        Arrow3DBox[Line3DBox[{{0, 0, 0}, {10.166, 0., 0.}}]]}, 
       {RGBColor[0, 1, 0], 
        Arrow3DBox[Line3DBox[{{0, 0, 0}, {0., 10.166, 0.}}]]}, 
       {RGBColor[0, 0, 1], 
        Arrow3DBox[Line3DBox[{{0, 0, 0}, {0., 0., 10.166}}]]}, 
       {GrayLevel[0], Line3DBox[{{0., 10.166, 0.}, {10.166, 10.166, 0.}}]}, 
       {GrayLevel[0], Line3DBox[{{10.166, 0., 0.}, {10.166, 10.166, 0.}}]}, 
       {GrayLevel[0], Line3DBox[{{10.166, 0., 0.}, {10.166, 0., 10.166}}]}, 
       {GrayLevel[0], Line3DBox[{{0., 10.166, 0.}, {0., 10.166, 10.166}}]}, 
       {GrayLevel[0], 
        Line3DBox[{{10.166, 10.166, 0.}, {10.166, 10.166, 10.166}}]}, 
       {GrayLevel[0], Line3DBox[{{0., 0., 10.166}, {10.166, 0., 10.166}}]}, 
       {GrayLevel[0], Line3DBox[{{0., 0., 10.166}, {0., 10.166, 10.166}}]}, 
       {GrayLevel[0], 
        Line3DBox[{{0., 10.166, 10.166}, {10.166, 10.166, 10.166}}]}, 
       {GrayLevel[0], 
        Line3DBox[{{10.166, 0., 10.166}, {10.166, 10.166, 10.166}}]}, 
       {RGBColor[0.800498, 0.201504, 0.192061], Opacity[1.], 
        SphereBox[CompressedData["
1:eJxTTMoPSmViYGBQAGJmIP7pd6bKUITRYZHrts9/Q0Tg9GND5qkf+RUwxGE0
rfT5f3vw/4YpKwYtI1CTzs8vB6fRxQnx0cVxyZNrD4z2tlmQc2oqO9xfDFAg
lyuzUey+DIY4DBCrD12eWH0wdTB5mDhMHbp5hNSh20dIHcxcWPyj+x8W/+ji
MEArfQDE8vbZ
         "], 0.66]}, 
       {RGBColor[0.878431, 0.4, 0.2], Opacity[1.], 
        SphereBox[{{5.083, 0., 0.}, {0., 5.083, 0.}, {0., 0., 5.083}, {0., 
         5.083, 5.083}, {5.083, 0., 5.083}, {5.083, 5.083, 0.}, {5.083, 5.083,
          5.083}, {0., 0., 0.}}, 1.32]}, 
       {RGBColor[0.4, 0.4, 0.4], Opacity[1.], SphereBox[CompressedData["
1:eJxTTMoPSmViYGCQAGJmIF6cxTr9hhunAwMa+Hj15ex+NhkMcRiglb4axqTt
JRv/2S9y3fb5b4gIXF0R66mY83UKDujiMECsPnR5YvXB1MHkYeIwdejmEVKH
bh8hdTBzYeGH7h9Y+KGLw2ha6QMA4Uu+DQ==
         "], 0.76]}, 
       {RGBColor[0.291989, 0.437977, 0.888609], Opacity[1.], 
        SphereBox[CompressedData["
1:eJxTTMoPSmViYGCQAGJmIDb46B6Y7sfgsMh12+e/ISJwOswzRT7FUQFDHEbT
Sp/wLJVpU6I54OIMUGBlFzXHsEYGQxwGiNWHLk+sPpg6mDxMHKYO3TxC6tDt
I6QOZi4s/ND9Dws/dHEYoJU+AA2Iojs=
         "], 0.71]}, 
       {RGBColor[0.313725, 0.815686, 0.313725], Opacity[1.], 
        SphereBox[{{7.6245, 2.5415, 0.}}, 1.24]}},
      ControllerMethod -> Automatic,
      AlignmentPoint->Center,
      AspectRatio->Automatic,
      Axes->False,
      AxesEdge->Automatic,
      AxesLabel->None,
      AxesOrigin->Automatic,
      AxesStyle->{},
      Background->None,
      BaseStyle->{},
      BaselinePosition->Automatic,
      BoxRatios->Automatic,
      BoxStyle->{},
      Boxed->False,
      ClipPlanes->None,
      ClipPlanesStyle->Automatic,
      ColorOutput->Automatic,
      ContentSelectable->Automatic,
      ControllerLinking->False,
      ControllerPath->Automatic,
      CoordinatesToolOptions:>Automatic,
      DisplayFunction->Identity,
      Epilog->{},
      FaceGrids->None,
      FaceGridsStyle->{},
      FormatType->TraditionalForm,
      ImageMargins->0.,
      ImagePadding->All,
      ImageSize->Automatic,
      ImageSizeRaw->Automatic,
      LabelStyle->{},
      Lighting->"Neutral",
      Method->Automatic,
      PlotLabel->None,
      PlotRange->All,
      PlotRangePadding->Automatic,
      PlotRegion->Automatic,
      PreserveImageOptions->Automatic,
      Prolog->{},
      RotationAction->"Fit",
      SphericalRegion->True,
      Ticks->Automatic,
      TicksStyle->{},
      TouchscreenAutoZoom->False,
      ViewAngle->Automatic,
      ViewCenter->Automatic,
      ViewMatrix->Automatic,
      ViewPoint->{1.3, -2.4, 2.},
      ViewProjection->Automatic,
      ViewRange->All,
      ViewVector->Automatic,
      ViewVertical->{0, 0, 1}]}
   },
   DefaultBaseStyle->"Column",
   GridBoxAlignment->{"Columns" -> {{Left}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Column"]], "Output",
 CellLabel->"Out[1]=",
 CellID->1859385844]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 "\"Distortions\"",
 "\[NonBreakingSpace]\[NonBreakingSpace]",
 Cell["(1)", "ExampleCount"]
}], "ExampleSubsection", "ExampleSubsection",
 WholeCellGroupOpener->True,
 CellID->1688597095],

Cell[TextData[{
 "In this example, a carbon atom is placed in the centre of a silicon unit \
cell, then shifted by ",
 Cell[BoxData[
  FormBox[
   RowBox[{"0.25", "\[CapitalARing]"}], TraditionalForm]], "InlineMath"],
 " in the ",
 Cell[BoxData[
  FormBox["x", TraditionalForm]], "InlineMath"],
 " direction and a random amount between ",
 Cell[BoxData[
  FormBox[
   RowBox[{"0.50", "\[Dash]", 
    RowBox[{"0.75", "\[CapitalARing]"}]}], TraditionalForm]], "InlineMath"],
 " in the ",
 Cell[BoxData[
  FormBox["y", TraditionalForm]], "InlineMath"],
 " direction."
}], "ExampleText",
 CellID->1376607065],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CrystalPlot", "@", 
  RowBox[{"EmbedStructure", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", "\"\<C\>\"", "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"1", "/", "2"}], ",", 
       RowBox[{"1", "/", "2"}], ",", 
       RowBox[{"1", "/", "2"}]}], "}"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"ExpandCrystal", "[", "\"\<Silicon\>\"", "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"\"\<NewLabel\>\"", "\[Rule]", "\"\<DemoStructure\>\""}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"\"\<Distortions\>\"", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"0.25", ",", 
       RowBox[{"{", 
        RowBox[{"0.50", ",", "1.50"}], "}"}], ",", "0"}], "}"}]}]}], 
   "]"}]}]], "Input",
 CellLabel->"In[1]:=",
 CellID->695241421],

Cell[BoxData[
 Graphics3DBox[{
   {RGBColor[1, 0, 0], Arrow3DBox[Line3DBox[{{0, 0, 0}, {5.43088, 0., 0.}}]]}, 
   {RGBColor[0, 1, 0], Arrow3DBox[Line3DBox[{{0, 0, 0}, {0., 5.43088, 0.}}]]}, 
   {RGBColor[0, 0, 1], Arrow3DBox[Line3DBox[{{0, 0, 0}, {0., 0., 5.43088}}]]}, 
   {GrayLevel[0], Line3DBox[{{0., 5.43088, 0.}, {5.43088, 5.43088, 0.}}]}, 
   {GrayLevel[0], Line3DBox[{{5.43088, 0., 0.}, {5.43088, 5.43088, 0.}}]}, 
   {GrayLevel[0], Line3DBox[{{5.43088, 0., 0.}, {5.43088, 0., 5.43088}}]}, 
   {GrayLevel[0], Line3DBox[{{0., 5.43088, 0.}, {0., 5.43088, 5.43088}}]}, 
   {GrayLevel[0], 
    Line3DBox[{{5.43088, 5.43088, 0.}, {5.43088, 5.43088, 5.43088}}]}, 
   {GrayLevel[0], Line3DBox[{{0., 0., 5.43088}, {5.43088, 0., 5.43088}}]}, 
   {GrayLevel[0], Line3DBox[{{0., 0., 5.43088}, {0., 5.43088, 5.43088}}]}, 
   {GrayLevel[0], 
    Line3DBox[{{0., 5.43088, 5.43088}, {5.43088, 5.43088, 5.43088}}]}, 
   {GrayLevel[0], 
    Line3DBox[{{5.43088, 0., 5.43088}, {5.43088, 5.43088, 5.43088}}]}, 
   {RGBColor[0.941176, 0.784314, 0.627451], Opacity[1.], 
    SphereBox[{{0.67886, 0.67886, 0.67886}, {3.3943000000000003`, 0.67886, 
     3.3943000000000003`}, {0.67886, 3.3943000000000003`, 
     3.3943000000000003`}, {3.3943000000000003`, 3.3943000000000003`, 
     0.67886}, {4.75202, 2.03658, 2.03658}, {4.75202, 4.75202, 4.75202}, {
     2.03658, 2.03658, 4.75202}, {2.03658, 4.75202, 2.03658}}, 1.11]}, 
   {RGBColor[0.4, 0.4, 0.4], Opacity[1.], 
    SphereBox[{{2.96544, 4.213888423810465, 2.71544}}, 0.76]}},
  ControllerMethod -> Automatic,
  AlignmentPoint->Center,
  AspectRatio->Automatic,
  Axes->False,
  AxesEdge->Automatic,
  AxesLabel->None,
  AxesOrigin->Automatic,
  AxesStyle->{},
  Background->None,
  BaseStyle->{},
  BaselinePosition->Automatic,
  BoxRatios->Automatic,
  BoxStyle->{},
  Boxed->False,
  ClipPlanes->None,
  ClipPlanesStyle->Automatic,
  ColorOutput->Automatic,
  ContentSelectable->Automatic,
  ControllerLinking->False,
  ControllerPath->Automatic,
  CoordinatesToolOptions:>Automatic,
  DisplayFunction->Identity,
  Epilog->{},
  FaceGrids->None,
  FaceGridsStyle->{},
  FormatType->TraditionalForm,
  ImageMargins->0.,
  ImagePadding->All,
  ImageSize->Automatic,
  ImageSizeRaw->Automatic,
  LabelStyle->{},
  Lighting->"Neutral",
  Method->Automatic,
  PlotLabel->None,
  PlotRange->All,
  PlotRangePadding->Automatic,
  PlotRegion->Automatic,
  PreserveImageOptions->Automatic,
  Prolog->{},
  RotationAction->"Fit",
  SphericalRegion->True,
  Ticks->Automatic,
  TicksStyle->{},
  TouchscreenAutoZoom->False,
  ViewAngle->Automatic,
  ViewCenter->Automatic,
  ViewMatrix->Automatic,
  ViewPoint->{1.3, -2.4, 2.},
  ViewProjection->Automatic,
  ViewRange->All,
  ViewVector->Automatic,
  ViewVertical->{0, 0, 1}]], "Output",
 CellLabel->"Out[1]=",
 CellID->1014062251]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 "\"Rotations\"",
 "\[NonBreakingSpace]\[NonBreakingSpace]",
 Cell["(1)", "ExampleCount"]
}], "ExampleSubsection", "ExampleSubsection",
 WholeCellGroupOpener->True,
 CellID->1020562723],

Cell["\<\
In this demonstration, we place a unit cell of sodium chloride on top of a \
small aluminium slab and control the rotation about the vertical axis.\
\>", "ExampleText",
 CellID->1678722922],

Cell[BoxData[{
 RowBox[{
  RowBox[{"cube", "=", 
   RowBox[{"ExpandCrystal", "[", "\"\<SodiumChloride\>\"", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"substrate", "=", 
   RowBox[{"ExpandCrystal", "[", 
    RowBox[{"\"\<Aluminium\>\"", ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "3", ",", "1"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"CrystalPlot", "@", 
    RowBox[{"EmbedStructure", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", "cube", "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "1.75"}], "}"}], "}"}], ",", "substrate", 
      ",", "\[IndentingNewLine]", 
      RowBox[{"\"\<NewLabel\>\"", "\[Rule]", "\"\<DemoStructure\>\""}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<MatchHostSize\>\"", "\[Rule]", "False"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<Rotations\>\"", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "\[Theta]"}], "}"}]}]}], "]"}]}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\[Theta]", ",", 
       RowBox[{"42", "\[Degree]"}]}], "}"}], ",", "0", ",", 
     RowBox[{"360", "\[Degree]"}]}], "}"}]}], "]"}]}], "Input",
 CellLabel->"In[1]:=",
 CellID->425114609]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 "\"OverlapPrecedence\"",
 "\[NonBreakingSpace]\[NonBreakingSpace]",
 Cell["(1)", "ExampleCount"]
}], "ExampleSubsection", "ExampleSubsection",
 WholeCellGroupOpener->True,
 CellID->854869796],

Cell["\<\
In this example, we will be building and using a couple of simple demo \
crystal structures:\
\>", "ExampleText",
 CellID->1974495011],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"SynthesiseStructure", "/@", 
   RowBox[{"{", 
    RowBox[{"\"\<Au\>\"", ",", "\"\<Ag\>\""}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"blockAu", ",", "blockAg"}], "}"}], "=", 
   RowBox[{"ExpandCrystal", "/@", 
    RowBox[{"{", 
     RowBox[{"\"\<Au\>\"", ",", "\"\<Ag\>\""}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"CrystalPlot", "/@", 
  RowBox[{"{", 
   RowBox[{"blockAu", ",", "blockAg"}], "}"}]}]}], "Input",
 CellLabel->"In[1]:=",
 CellID->272852786],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   Graphics3DBox[{
     {RGBColor[1, 0, 0], Arrow3DBox[Line3DBox[{{0, 0, 0}, {5., 0., 0.}}]]}, 
     {RGBColor[0, 1, 0], Arrow3DBox[Line3DBox[{{0, 0, 0}, {0., 5., 0.}}]]}, 
     {RGBColor[0, 0, 1], Arrow3DBox[Line3DBox[{{0, 0, 0}, {0., 0., 5.}}]]}, 
     {GrayLevel[0], Line3DBox[{{0., 5., 0.}, {5., 5., 0.}}]}, 
     {GrayLevel[0], Line3DBox[{{5., 0., 0.}, {5., 5., 0.}}]}, 
     {GrayLevel[0], Line3DBox[{{5., 0., 0.}, {5., 0., 5.}}]}, 
     {GrayLevel[0], Line3DBox[{{0., 5., 0.}, {0., 5., 5.}}]}, 
     {GrayLevel[0], Line3DBox[{{5., 5., 0.}, {5., 5., 5.}}]}, 
     {GrayLevel[0], Line3DBox[{{0., 0., 5.}, {5., 0., 5.}}]}, 
     {GrayLevel[0], Line3DBox[{{0., 0., 5.}, {0., 5., 5.}}]}, 
     {GrayLevel[0], Line3DBox[{{0., 5., 5.}, {5., 5., 5.}}]}, 
     {GrayLevel[0], Line3DBox[{{5., 0., 5.}, {5., 5., 5.}}]}, 
     {RGBColor[1., 0.819608, 0.137255], Opacity[1.], 
      SphereBox[{{0., 0., 0.}, {0., 0., 5.}, {0., 5., 0.}, {0., 5., 5.}, {5., 
       0., 0.}, {5., 0., 5.}, {5., 5., 0.}, {5., 5., 5.}}, 1.36]}},
    ControllerMethod -> Automatic,
    AlignmentPoint->Center,
    AspectRatio->Automatic,
    Axes->False,
    AxesEdge->Automatic,
    AxesLabel->None,
    AxesOrigin->Automatic,
    AxesStyle->{},
    Background->None,
    BaseStyle->{},
    BaselinePosition->Automatic,
    BoxRatios->Automatic,
    BoxStyle->{},
    Boxed->False,
    ClipPlanes->None,
    ClipPlanesStyle->Automatic,
    ColorOutput->Automatic,
    ContentSelectable->Automatic,
    ControllerLinking->False,
    ControllerPath->Automatic,
    CoordinatesToolOptions:>Automatic,
    DisplayFunction->Identity,
    Epilog->{},
    FaceGrids->None,
    FaceGridsStyle->{},
    FormatType->TraditionalForm,
    ImageMargins->0.,
    ImagePadding->All,
    ImageSize->Automatic,
    ImageSizeRaw->Automatic,
    LabelStyle->{},
    Lighting->"Neutral",
    Method->Automatic,
    PlotLabel->None,
    PlotRange->All,
    PlotRangePadding->Automatic,
    PlotRegion->Automatic,
    PreserveImageOptions->Automatic,
    Prolog->{},
    RotationAction->"Fit",
    SphericalRegion->True,
    Ticks->Automatic,
    TicksStyle->{},
    TouchscreenAutoZoom->False,
    ViewAngle->Automatic,
    ViewCenter->Automatic,
    ViewMatrix->Automatic,
    ViewPoint->{1.3, -2.4, 2.},
    ViewProjection->Automatic,
    ViewRange->All,
    ViewVector->Automatic,
    ViewVertical->{0, 0, 1}], ",", 
   Graphics3DBox[{
     {RGBColor[1, 0, 0], Arrow3DBox[Line3DBox[{{0, 0, 0}, {5., 0., 0.}}]]}, 
     {RGBColor[0, 1, 0], Arrow3DBox[Line3DBox[{{0, 0, 0}, {0., 5., 0.}}]]}, 
     {RGBColor[0, 0, 1], Arrow3DBox[Line3DBox[{{0, 0, 0}, {0., 0., 5.}}]]}, 
     {GrayLevel[0], Line3DBox[{{0., 5., 0.}, {5., 5., 0.}}]}, 
     {GrayLevel[0], Line3DBox[{{5., 0., 0.}, {5., 5., 0.}}]}, 
     {GrayLevel[0], Line3DBox[{{5., 0., 0.}, {5., 0., 5.}}]}, 
     {GrayLevel[0], Line3DBox[{{0., 5., 0.}, {0., 5., 5.}}]}, 
     {GrayLevel[0], Line3DBox[{{5., 5., 0.}, {5., 5., 5.}}]}, 
     {GrayLevel[0], Line3DBox[{{0., 0., 5.}, {5., 0., 5.}}]}, 
     {GrayLevel[0], Line3DBox[{{0., 0., 5.}, {0., 5., 5.}}]}, 
     {GrayLevel[0], Line3DBox[{{0., 5., 5.}, {5., 5., 5.}}]}, 
     {GrayLevel[0], Line3DBox[{{5., 0., 5.}, {5., 5., 5.}}]}, 
     {RGBColor[0.752941, 0.752941, 0.752941], Opacity[1.], 
      SphereBox[{{0., 0., 0.}, {0., 0., 5.}, {0., 5., 0.}, {0., 5., 5.}, {5., 
       0., 0.}, {5., 0., 5.}, {5., 5., 0.}, {5., 5., 5.}}, 1.45]}},
    ControllerMethod -> Automatic,
    AlignmentPoint->Center,
    AspectRatio->Automatic,
    Axes->False,
    AxesEdge->Automatic,
    AxesLabel->None,
    AxesOrigin->Automatic,
    AxesStyle->{},
    Background->None,
    BaseStyle->{},
    BaselinePosition->Automatic,
    BoxRatios->Automatic,
    BoxStyle->{},
    Boxed->False,
    ClipPlanes->None,
    ClipPlanesStyle->Automatic,
    ColorOutput->Automatic,
    ContentSelectable->Automatic,
    ControllerLinking->False,
    ControllerPath->Automatic,
    CoordinatesToolOptions:>Automatic,
    DisplayFunction->Identity,
    Epilog->{},
    FaceGrids->None,
    FaceGridsStyle->{},
    FormatType->TraditionalForm,
    ImageMargins->0.,
    ImagePadding->All,
    ImageSize->Automatic,
    ImageSizeRaw->Automatic,
    LabelStyle->{},
    Lighting->"Neutral",
    Method->Automatic,
    PlotLabel->None,
    PlotRange->All,
    PlotRangePadding->Automatic,
    PlotRegion->Automatic,
    PreserveImageOptions->Automatic,
    Prolog->{},
    RotationAction->"Fit",
    SphericalRegion->True,
    Ticks->Automatic,
    TicksStyle->{},
    TouchscreenAutoZoom->False,
    ViewAngle->Automatic,
    ViewCenter->Automatic,
    ViewMatrix->Automatic,
    ViewPoint->{1.3, -2.4, 2.},
    ViewProjection->Automatic,
    ViewRange->All,
    ViewVector->Automatic,
    ViewVertical->{0, 0, 1}]}], "}"}]], "Output",
 CellLabel->"Out[1]=",
 CellID->911939435]
}, Open  ]],

Cell[TextData[{
 "We wish to hinge them together at the ",
 Cell[BoxData[
  FormBox[
   RowBox[{"[", 
    RowBox[{"1", "\[ThinSpace]", "1", "\[ThinSpace]", "l"}], "]"}], 
   TraditionalForm]], "InlineMath"],
 " axis. With the ",
 Cell[BoxData["\"\<OverlapPrecedence\>\""], "InlineFormula"],
 " option we can control whether the whether the host atoms (here: gold) \
should be kept or replaced by the overlapping guest atoms."
}], "ExampleText",
 CellID->1233617734],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Table", "[", 
  RowBox[{
   RowBox[{"CrystalPlot", "@", 
    RowBox[{"EmbedStructure", "[", 
     RowBox[{
      RowBox[{"{", "blockAg", "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{"1", ",", "1", ",", "0"}], "}"}], "}"}], ",", "blockAu", ",", 
      
      RowBox[{"\"\<NewLabel\>\"", "\[Rule]", "\"\<Demo\>\""}], ",", 
      RowBox[{"\"\<MatchHostSize\>\"", "\[Rule]", "False"}], ",", 
      RowBox[{"\"\<OverlapPrecedence\>\"", "\[Rule]", "p"}]}], "]"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"p", ",", 
     RowBox[{"{", 
      RowBox[{"\"\<Host\>\"", ",", "\"\<Guest\>\""}], "}"}]}], "}"}]}], 
  "]"}]], "Input",
 CellLabel->"In[2]:=",
 CellID->1852596485],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   Graphics3DBox[{
     {RGBColor[1, 0, 0], Arrow3DBox[Line3DBox[{{0, 0, 0}, {5., 0., 0.}}]]}, 
     {RGBColor[0, 1, 0], Arrow3DBox[Line3DBox[{{0, 0, 0}, {0., 5., 0.}}]]}, 
     {RGBColor[0, 0, 1], Arrow3DBox[Line3DBox[{{0, 0, 0}, {0., 0., 5.}}]]}, 
     {GrayLevel[0], Line3DBox[{{0., 5., 0.}, {5., 5., 0.}}]}, 
     {GrayLevel[0], Line3DBox[{{5., 0., 0.}, {5., 5., 0.}}]}, 
     {GrayLevel[0], Line3DBox[{{5., 0., 0.}, {5., 0., 5.}}]}, 
     {GrayLevel[0], Line3DBox[{{0., 5., 0.}, {0., 5., 5.}}]}, 
     {GrayLevel[0], Line3DBox[{{5., 5., 0.}, {5., 5., 5.}}]}, 
     {GrayLevel[0], Line3DBox[{{0., 0., 5.}, {5., 0., 5.}}]}, 
     {GrayLevel[0], Line3DBox[{{0., 0., 5.}, {0., 5., 5.}}]}, 
     {GrayLevel[0], Line3DBox[{{0., 5., 5.}, {5., 5., 5.}}]}, 
     {GrayLevel[0], Line3DBox[{{5., 0., 5.}, {5., 5., 5.}}]}, 
     {RGBColor[1., 0.819608, 0.137255], Opacity[1.], 
      SphereBox[{{0., 0., 0.}, {0., 0., 5.}, {0., 5., 0.}, {0., 5., 5.}, {5., 
       0., 0.}, {5., 0., 5.}, {5., 5., 0.}, {5., 5., 5.}}, 1.36]}, 
     {RGBColor[0.752941, 0.752941, 0.752941], Opacity[1.], 
      SphereBox[{{5., 10., 0.}, {5., 10., 5.}, {10., 5., 0.}, {10., 5., 5.}, {
       10., 10., 0.}, {10., 10., 5.}}, 1.45]}},
    ControllerMethod -> Automatic,
    AlignmentPoint->Center,
    AspectRatio->Automatic,
    Axes->False,
    AxesEdge->Automatic,
    AxesLabel->None,
    AxesOrigin->Automatic,
    AxesStyle->{},
    Background->None,
    BaseStyle->{},
    BaselinePosition->Automatic,
    BoxRatios->Automatic,
    BoxStyle->{},
    Boxed->False,
    ClipPlanes->None,
    ClipPlanesStyle->Automatic,
    ColorOutput->Automatic,
    ContentSelectable->Automatic,
    ControllerLinking->False,
    ControllerPath->Automatic,
    CoordinatesToolOptions:>Automatic,
    DisplayFunction->Identity,
    Epilog->{},
    FaceGrids->None,
    FaceGridsStyle->{},
    FormatType->TraditionalForm,
    ImageMargins->0.,
    ImagePadding->All,
    ImageSize->Automatic,
    ImageSizeRaw->Automatic,
    LabelStyle->{},
    Lighting->"Neutral",
    Method->Automatic,
    PlotLabel->None,
    PlotRange->All,
    PlotRangePadding->Automatic,
    PlotRegion->Automatic,
    PreserveImageOptions->Automatic,
    Prolog->{},
    RotationAction->"Fit",
    SphericalRegion->True,
    Ticks->Automatic,
    TicksStyle->{},
    TouchscreenAutoZoom->False,
    ViewAngle->Automatic,
    ViewCenter->Automatic,
    ViewMatrix->Automatic,
    ViewPoint->{1.3, -2.4, 2.},
    ViewProjection->Automatic,
    ViewRange->All,
    ViewVector->Automatic,
    ViewVertical->{0, 0, 1}], ",", 
   Graphics3DBox[{
     {RGBColor[1, 0, 0], Arrow3DBox[Line3DBox[{{0, 0, 0}, {5., 0., 0.}}]]}, 
     {RGBColor[0, 1, 0], Arrow3DBox[Line3DBox[{{0, 0, 0}, {0., 5., 0.}}]]}, 
     {RGBColor[0, 0, 1], Arrow3DBox[Line3DBox[{{0, 0, 0}, {0., 0., 5.}}]]}, 
     {GrayLevel[0], Line3DBox[{{0., 5., 0.}, {5., 5., 0.}}]}, 
     {GrayLevel[0], Line3DBox[{{5., 0., 0.}, {5., 5., 0.}}]}, 
     {GrayLevel[0], Line3DBox[{{5., 0., 0.}, {5., 0., 5.}}]}, 
     {GrayLevel[0], Line3DBox[{{0., 5., 0.}, {0., 5., 5.}}]}, 
     {GrayLevel[0], Line3DBox[{{5., 5., 0.}, {5., 5., 5.}}]}, 
     {GrayLevel[0], Line3DBox[{{0., 0., 5.}, {5., 0., 5.}}]}, 
     {GrayLevel[0], Line3DBox[{{0., 0., 5.}, {0., 5., 5.}}]}, 
     {GrayLevel[0], Line3DBox[{{0., 5., 5.}, {5., 5., 5.}}]}, 
     {GrayLevel[0], Line3DBox[{{5., 0., 5.}, {5., 5., 5.}}]}, 
     {RGBColor[0.752941, 0.752941, 0.752941], Opacity[1.], 
      SphereBox[{{5., 5., 0.}, {5., 5., 5.}, {5., 10., 0.}, {5., 10., 5.}, {
       10., 5., 0.}, {10., 5., 5.}, {10., 10., 0.}, {10., 10., 5.}}, 1.45]}, 
     {RGBColor[1., 0.819608, 0.137255], Opacity[1.], 
      SphereBox[{{0., 0., 0.}, {0., 0., 5.}, {0., 5., 0.}, {0., 5., 5.}, {5., 
       0., 0.}, {5., 0., 5.}}, 1.36]}},
    ControllerMethod -> Automatic,
    AlignmentPoint->Center,
    AspectRatio->Automatic,
    Axes->False,
    AxesEdge->Automatic,
    AxesLabel->None,
    AxesOrigin->Automatic,
    AxesStyle->{},
    Background->None,
    BaseStyle->{},
    BaselinePosition->Automatic,
    BoxRatios->Automatic,
    BoxStyle->{},
    Boxed->False,
    ClipPlanes->None,
    ClipPlanesStyle->Automatic,
    ColorOutput->Automatic,
    ContentSelectable->Automatic,
    ControllerLinking->False,
    ControllerPath->Automatic,
    CoordinatesToolOptions:>Automatic,
    DisplayFunction->Identity,
    Epilog->{},
    FaceGrids->None,
    FaceGridsStyle->{},
    FormatType->TraditionalForm,
    ImageMargins->0.,
    ImagePadding->All,
    ImageSize->Automatic,
    ImageSizeRaw->Automatic,
    LabelStyle->{},
    Lighting->"Neutral",
    Method->Automatic,
    PlotLabel->None,
    PlotRange->All,
    PlotRangePadding->Automatic,
    PlotRegion->Automatic,
    PreserveImageOptions->Automatic,
    Prolog->{},
    RotationAction->"Fit",
    SphericalRegion->True,
    Ticks->Automatic,
    TicksStyle->{},
    TouchscreenAutoZoom->False,
    ViewAngle->Automatic,
    ViewCenter->Automatic,
    ViewMatrix->Automatic,
    ViewPoint->{1.3, -2.4, 2.},
    ViewProjection->Automatic,
    ViewRange->All,
    ViewVector->Automatic,
    ViewVertical->{0, 0, 1}]}], "}"}]], "Output",
 CellLabel->"Out[2]=",
 CellID->1300369125]
}, Open  ]],

Cell[TextData[{
 "With the default setting ",
 Cell[BoxData["\"\<None\>\""], "InlineFormula"],
 " no check for overlapping atoms is performed and the resulting structure \
may contain superpositioned atoms."
}], "ExampleText",
 CellID->971695640]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 "\"OverlapRadius\"",
 "\[NonBreakingSpace]\[NonBreakingSpace]",
 Cell["(1)", "ExampleCount"]
}], "ExampleSubsection", "ExampleSubsection",
 WholeCellGroupOpener->True,
 CellID->1131062942],

Cell["\<\
In this example, we will be building and using a couple of simple demo \
crystal structures:\
\>", "ExampleText",
 CellID->1151418045],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"SynthesiseStructure", "/@", 
   RowBox[{"{", 
    RowBox[{"\"\<Au\>\"", ",", "\"\<Ag\>\""}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"blockAu", ",", "blockAg"}], "}"}], "=", 
   RowBox[{"ExpandCrystal", "/@", 
    RowBox[{"{", 
     RowBox[{"\"\<Au\>\"", ",", "\"\<Ag\>\""}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"CrystalPlot", "/@", 
  RowBox[{"{", 
   RowBox[{"blockAu", ",", "blockAg"}], "}"}]}]}], "Input",
 CellLabel->"In[1]:=",
 CellID->907939198],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   Graphics3DBox[{
     {RGBColor[1, 0, 0], Arrow3DBox[Line3DBox[{{0, 0, 0}, {5., 0., 0.}}]]}, 
     {RGBColor[0, 1, 0], Arrow3DBox[Line3DBox[{{0, 0, 0}, {0., 5., 0.}}]]}, 
     {RGBColor[0, 0, 1], Arrow3DBox[Line3DBox[{{0, 0, 0}, {0., 0., 5.}}]]}, 
     {GrayLevel[0], Line3DBox[{{0., 5., 0.}, {5., 5., 0.}}]}, 
     {GrayLevel[0], Line3DBox[{{5., 0., 0.}, {5., 5., 0.}}]}, 
     {GrayLevel[0], Line3DBox[{{5., 0., 0.}, {5., 0., 5.}}]}, 
     {GrayLevel[0], Line3DBox[{{0., 5., 0.}, {0., 5., 5.}}]}, 
     {GrayLevel[0], Line3DBox[{{5., 5., 0.}, {5., 5., 5.}}]}, 
     {GrayLevel[0], Line3DBox[{{0., 0., 5.}, {5., 0., 5.}}]}, 
     {GrayLevel[0], Line3DBox[{{0., 0., 5.}, {0., 5., 5.}}]}, 
     {GrayLevel[0], Line3DBox[{{0., 5., 5.}, {5., 5., 5.}}]}, 
     {GrayLevel[0], Line3DBox[{{5., 0., 5.}, {5., 5., 5.}}]}, 
     {RGBColor[1., 0.819608, 0.137255], Opacity[1.], 
      SphereBox[{{0., 0., 0.}, {0., 0., 5.}, {0., 5., 0.}, {0., 5., 5.}, {5., 
       0., 0.}, {5., 0., 5.}, {5., 5., 0.}, {5., 5., 5.}}, 1.36]}},
    ControllerMethod -> Automatic,
    AlignmentPoint->Center,
    AspectRatio->Automatic,
    Axes->False,
    AxesEdge->Automatic,
    AxesLabel->None,
    AxesOrigin->Automatic,
    AxesStyle->{},
    Background->None,
    BaseStyle->{},
    BaselinePosition->Automatic,
    BoxRatios->Automatic,
    BoxStyle->{},
    Boxed->False,
    ClipPlanes->None,
    ClipPlanesStyle->Automatic,
    ColorOutput->Automatic,
    ContentSelectable->Automatic,
    ControllerLinking->False,
    ControllerPath->Automatic,
    CoordinatesToolOptions:>Automatic,
    DisplayFunction->Identity,
    Epilog->{},
    FaceGrids->None,
    FaceGridsStyle->{},
    FormatType->TraditionalForm,
    ImageMargins->0.,
    ImagePadding->All,
    ImageSize->Automatic,
    ImageSizeRaw->Automatic,
    LabelStyle->{},
    Lighting->"Neutral",
    Method->Automatic,
    PlotLabel->None,
    PlotRange->All,
    PlotRangePadding->Automatic,
    PlotRegion->Automatic,
    PreserveImageOptions->Automatic,
    Prolog->{},
    RotationAction->"Fit",
    SphericalRegion->True,
    Ticks->Automatic,
    TicksStyle->{},
    TouchscreenAutoZoom->False,
    ViewAngle->Automatic,
    ViewCenter->Automatic,
    ViewMatrix->Automatic,
    ViewPoint->{1.3, -2.4, 2.},
    ViewProjection->Automatic,
    ViewRange->All,
    ViewVector->Automatic,
    ViewVertical->{0, 0, 1}], ",", 
   Graphics3DBox[{
     {RGBColor[1, 0, 0], Arrow3DBox[Line3DBox[{{0, 0, 0}, {5., 0., 0.}}]]}, 
     {RGBColor[0, 1, 0], Arrow3DBox[Line3DBox[{{0, 0, 0}, {0., 5., 0.}}]]}, 
     {RGBColor[0, 0, 1], Arrow3DBox[Line3DBox[{{0, 0, 0}, {0., 0., 5.}}]]}, 
     {GrayLevel[0], Line3DBox[{{0., 5., 0.}, {5., 5., 0.}}]}, 
     {GrayLevel[0], Line3DBox[{{5., 0., 0.}, {5., 5., 0.}}]}, 
     {GrayLevel[0], Line3DBox[{{5., 0., 0.}, {5., 0., 5.}}]}, 
     {GrayLevel[0], Line3DBox[{{0., 5., 0.}, {0., 5., 5.}}]}, 
     {GrayLevel[0], Line3DBox[{{5., 5., 0.}, {5., 5., 5.}}]}, 
     {GrayLevel[0], Line3DBox[{{0., 0., 5.}, {5., 0., 5.}}]}, 
     {GrayLevel[0], Line3DBox[{{0., 0., 5.}, {0., 5., 5.}}]}, 
     {GrayLevel[0], Line3DBox[{{0., 5., 5.}, {5., 5., 5.}}]}, 
     {GrayLevel[0], Line3DBox[{{5., 0., 5.}, {5., 5., 5.}}]}, 
     {RGBColor[0.752941, 0.752941, 0.752941], Opacity[1.], 
      SphereBox[{{0., 0., 0.}, {0., 0., 5.}, {0., 5., 0.}, {0., 5., 5.}, {5., 
       0., 0.}, {5., 0., 5.}, {5., 5., 0.}, {5., 5., 5.}}, 1.45]}},
    ControllerMethod -> Automatic,
    AlignmentPoint->Center,
    AspectRatio->Automatic,
    Axes->False,
    AxesEdge->Automatic,
    AxesLabel->None,
    AxesOrigin->Automatic,
    AxesStyle->{},
    Background->None,
    BaseStyle->{},
    BaselinePosition->Automatic,
    BoxRatios->Automatic,
    BoxStyle->{},
    Boxed->False,
    ClipPlanes->None,
    ClipPlanesStyle->Automatic,
    ColorOutput->Automatic,
    ContentSelectable->Automatic,
    ControllerLinking->False,
    ControllerPath->Automatic,
    CoordinatesToolOptions:>Automatic,
    DisplayFunction->Identity,
    Epilog->{},
    FaceGrids->None,
    FaceGridsStyle->{},
    FormatType->TraditionalForm,
    ImageMargins->0.,
    ImagePadding->All,
    ImageSize->Automatic,
    ImageSizeRaw->Automatic,
    LabelStyle->{},
    Lighting->"Neutral",
    Method->Automatic,
    PlotLabel->None,
    PlotRange->All,
    PlotRangePadding->Automatic,
    PlotRegion->Automatic,
    PreserveImageOptions->Automatic,
    Prolog->{},
    RotationAction->"Fit",
    SphericalRegion->True,
    Ticks->Automatic,
    TicksStyle->{},
    TouchscreenAutoZoom->False,
    ViewAngle->Automatic,
    ViewCenter->Automatic,
    ViewMatrix->Automatic,
    ViewPoint->{1.3, -2.4, 2.},
    ViewProjection->Automatic,
    ViewRange->All,
    ViewVector->Automatic,
    ViewVertical->{0, 0, 1}]}], "}"}]], "Output",
 CellLabel->"Out[1]=",
 CellID->249104515]
}, Open  ]],

Cell[TextData[{
 "Let us place the \[OpenCurlyDoubleQuote]silver cube\[CloseCurlyDoubleQuote] \
at crystallographic position ",
 Cell[BoxData[
  FormBox[
   RowBox[{"1.75`", " ", "a"}], TraditionalForm]], "InlineMath"],
 ". The gap between the host and the guest is now ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"0.75", "a"}], "=", 
    RowBox[{
     RowBox[{"0.75", "\[CenterDot]", 
      RowBox[{"(", 
       RowBox[{"5.0", "\[CapitalARing]"}], ")"}]}], "=", 
     RowBox[{"3.75", "\[CapitalARing]"}]}]}], TraditionalForm]], "InlineMath"],
 ". If we set the ",
 Cell[BoxData["\"\<OverlapRadius\>\""], "InlineFormula"],
 " above this value, the side of the silver cube closest to the gold cube is \
removed:"
}], "ExampleText",
 CellID->229062906],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Table", "[", 
  RowBox[{
   RowBox[{"CrystalPlot", "[", 
    RowBox[{
     RowBox[{"EmbedStructure", "[", 
      RowBox[{
       RowBox[{"{", "blockAg", "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"1.75", ",", "0", ",", "0"}], "}"}], "}"}], ",", "blockAu", 
       ",", 
       RowBox[{"\"\<NewLabel\>\"", "\[Rule]", "\"\<Demo\>\""}], ",", 
       RowBox[{"\"\<MatchHostSize\>\"", "\[Rule]", "False"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<OverlapPrecedence\>\"", "\[Rule]", "\"\<Host\>\""}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<OverlapRadius\>\"", "\[Rule]", "r"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"ViewPoint", "\[Rule]", "Front"}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"r", ",", 
     RowBox[{"{", 
      RowBox[{"3.70", ",", "3.80"}], "}"}]}], "}"}]}], "]"}]], "Input",
 CellLabel->"In[2]:=",
 CellID->88304206],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   Graphics3DBox[{
     {RGBColor[1, 0, 0], Arrow3DBox[Line3DBox[{{0, 0, 0}, {5., 0., 0.}}]]}, 
     {RGBColor[0, 1, 0], Arrow3DBox[Line3DBox[{{0, 0, 0}, {0., 5., 0.}}]]}, 
     {RGBColor[0, 0, 1], Arrow3DBox[Line3DBox[{{0, 0, 0}, {0., 0., 5.}}]]}, 
     {GrayLevel[0], Line3DBox[{{0., 5., 0.}, {5., 5., 0.}}]}, 
     {GrayLevel[0], Line3DBox[{{5., 0., 0.}, {5., 5., 0.}}]}, 
     {GrayLevel[0], Line3DBox[{{5., 0., 0.}, {5., 0., 5.}}]}, 
     {GrayLevel[0], Line3DBox[{{0., 5., 0.}, {0., 5., 5.}}]}, 
     {GrayLevel[0], Line3DBox[{{5., 5., 0.}, {5., 5., 5.}}]}, 
     {GrayLevel[0], Line3DBox[{{0., 0., 5.}, {5., 0., 5.}}]}, 
     {GrayLevel[0], Line3DBox[{{0., 0., 5.}, {0., 5., 5.}}]}, 
     {GrayLevel[0], Line3DBox[{{0., 5., 5.}, {5., 5., 5.}}]}, 
     {GrayLevel[0], Line3DBox[{{5., 0., 5.}, {5., 5., 5.}}]}, 
     {RGBColor[1., 0.819608, 0.137255], Opacity[1.], 
      SphereBox[{{0., 0., 0.}, {0., 0., 5.}, {0., 5., 0.}, {0., 5., 5.}, {5., 
       0., 0.}, {5., 0., 5.}, {5., 5., 0.}, {5., 5., 5.}}, 1.36]}, 
     {RGBColor[0.752941, 0.752941, 0.752941], Opacity[1.], 
      SphereBox[{{8.75, 0., 0.}, {8.75, 0., 5.}, {8.75, 5., 0.}, {8.75, 5., 
       5.}, {13.75, 0., 0.}, {13.75, 0., 5.}, {13.75, 5., 0.}, {13.75, 5., 
       5.}}, 1.45]}},
    ControllerMethod -> Automatic,
    AlignmentPoint->Center,
    AspectRatio->Automatic,
    Axes->False,
    AxesEdge->Automatic,
    AxesLabel->None,
    AxesOrigin->Automatic,
    AxesStyle->{},
    Background->None,
    BaseStyle->{},
    BaselinePosition->Automatic,
    BoxRatios->Automatic,
    BoxStyle->{},
    Boxed->False,
    ClipPlanes->None,
    ClipPlanesStyle->Automatic,
    ColorOutput->Automatic,
    ContentSelectable->Automatic,
    ControllerLinking->False,
    ControllerPath->Automatic,
    CoordinatesToolOptions:>Automatic,
    DisplayFunction->Identity,
    Epilog->{},
    FaceGrids->None,
    FaceGridsStyle->{},
    FormatType->TraditionalForm,
    ImageMargins->0.,
    ImagePadding->All,
    ImageSize->Automatic,
    ImageSizeRaw->Automatic,
    LabelStyle->{},
    Lighting->"Neutral",
    Method->Automatic,
    PlotLabel->None,
    PlotRange->All,
    PlotRangePadding->Automatic,
    PlotRegion->Automatic,
    PreserveImageOptions->Automatic,
    Prolog->{},
    RotationAction->"Fit",
    SphericalRegion->True,
    Ticks->Automatic,
    TicksStyle->{},
    TouchscreenAutoZoom->False,
    ViewAngle->Automatic,
    ViewCenter->Automatic,
    ViewMatrix->Automatic,
    ViewPoint->Front,
    ViewProjection->Automatic,
    ViewRange->All,
    ViewVector->Automatic,
    ViewVertical->{0, 0, 1}], ",", 
   Graphics3DBox[{
     {RGBColor[1, 0, 0], Arrow3DBox[Line3DBox[{{0, 0, 0}, {5., 0., 0.}}]]}, 
     {RGBColor[0, 1, 0], Arrow3DBox[Line3DBox[{{0, 0, 0}, {0., 5., 0.}}]]}, 
     {RGBColor[0, 0, 1], Arrow3DBox[Line3DBox[{{0, 0, 0}, {0., 0., 5.}}]]}, 
     {GrayLevel[0], Line3DBox[{{0., 5., 0.}, {5., 5., 0.}}]}, 
     {GrayLevel[0], Line3DBox[{{5., 0., 0.}, {5., 5., 0.}}]}, 
     {GrayLevel[0], Line3DBox[{{5., 0., 0.}, {5., 0., 5.}}]}, 
     {GrayLevel[0], Line3DBox[{{0., 5., 0.}, {0., 5., 5.}}]}, 
     {GrayLevel[0], Line3DBox[{{5., 5., 0.}, {5., 5., 5.}}]}, 
     {GrayLevel[0], Line3DBox[{{0., 0., 5.}, {5., 0., 5.}}]}, 
     {GrayLevel[0], Line3DBox[{{0., 0., 5.}, {0., 5., 5.}}]}, 
     {GrayLevel[0], Line3DBox[{{0., 5., 5.}, {5., 5., 5.}}]}, 
     {GrayLevel[0], Line3DBox[{{5., 0., 5.}, {5., 5., 5.}}]}, 
     {RGBColor[1., 0.819608, 0.137255], Opacity[1.], 
      SphereBox[{{0., 0., 0.}, {0., 0., 5.}, {0., 5., 0.}, {0., 5., 5.}, {5., 
       0., 0.}, {5., 0., 5.}, {5., 5., 0.}, {5., 5., 5.}}, 1.36]}, 
     {RGBColor[0.752941, 0.752941, 0.752941], Opacity[1.], 
      SphereBox[{{13.75, 0., 0.}, {13.75, 0., 5.}, {13.75, 5., 0.}, {13.75, 
       5., 5.}}, 1.45]}},
    ControllerMethod -> Automatic,
    AlignmentPoint->Center,
    AspectRatio->Automatic,
    Axes->False,
    AxesEdge->Automatic,
    AxesLabel->None,
    AxesOrigin->Automatic,
    AxesStyle->{},
    Background->None,
    BaseStyle->{},
    BaselinePosition->Automatic,
    BoxRatios->Automatic,
    BoxStyle->{},
    Boxed->False,
    ClipPlanes->None,
    ClipPlanesStyle->Automatic,
    ColorOutput->Automatic,
    ContentSelectable->Automatic,
    ControllerLinking->False,
    ControllerPath->Automatic,
    CoordinatesToolOptions:>Automatic,
    DisplayFunction->Identity,
    Epilog->{},
    FaceGrids->None,
    FaceGridsStyle->{},
    FormatType->TraditionalForm,
    ImageMargins->0.,
    ImagePadding->All,
    ImageSize->Automatic,
    ImageSizeRaw->Automatic,
    LabelStyle->{},
    Lighting->"Neutral",
    Method->Automatic,
    PlotLabel->None,
    PlotRange->All,
    PlotRangePadding->Automatic,
    PlotRegion->Automatic,
    PreserveImageOptions->Automatic,
    Prolog->{},
    RotationAction->"Fit",
    SphericalRegion->True,
    Ticks->Automatic,
    TicksStyle->{},
    TouchscreenAutoZoom->False,
    ViewAngle->Automatic,
    ViewCenter->Automatic,
    ViewMatrix->Automatic,
    ViewPoint->Front,
    ViewProjection->Automatic,
    ViewRange->All,
    ViewVector->Automatic,
    ViewVertical->{0, 0, 1}]}], "}"}]], "Output",
 CellLabel->"Out[2]=",
 CellID->680349636]
}, Open  ]]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " code",
 "\[NonBreakingSpace]\[NonBreakingSpace]",
 Cell["(1)", "ExampleCount"]
}], "ExampleSection", "ExampleSection",
 WholeCellGroupOpener->True,
 CellID->422887447],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"EmbedStructure", "::", "InvalidGuestInput"}], "=", 
   "\"\<Invalid guest unit input.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"EmbedStructure", "::", "InvalidTargetPositions"}], "=", 
   "\"\<Invalid position input.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"EmbedStructure", "::", "InvalidProbabilities"}], "=", 
   "\"\<The probabilities must be numbers between 0 and 1.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"EmbedStructure", "::", "InvalidTrimming"}], "=", 
   "\"\<Invalid setting for \\\"TrimBoundary\\\".\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"EmbedStructure", "::", "InvalidAlteration"}], "=", 
   "\"\<Invalid input for \\\"Distortions\\\" or \\\"Rotations\\\".\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"EmbedStructure", "::", "InvalidAlterationValues"}], "=", 
   "\"\<Distortion/rotation amplitudes should be numeric and on the form \
\[Delta] or {\!\(\*SubscriptBox[\(\[Delta]\), \(min\)]\), \!\(\*SubscriptBox[\
\(\[Delta]\), \(max\)]\)}.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"EmbedStructure", "::", "InvalidDistortionType"}], "=", 
   "\"\<\\\"DistortionType\\\" must be set to either \\\"Crystallographic\\\" \
or \\\"Cartesian\\\".\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"EmbedStructure", "::", "InvalidOverlapRadius"}], "=", 
   "\"\<\\\"OverlapRadius\\\" must be numeric.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"EmbedStructure", "::", "InvalidAnchorReference"}], "=", 
    "\"\<Anchor reference type \[LeftGuillemet]`1`\[RightGuillemet] is \
invalid. Use either \\\"Host\\\" or \\\"Unit\\\".\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Options", "@", "EmbedStructure"}], "=", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\"\<DataFile\>\"", "\[Rule]", 
       RowBox[{"FileNameJoin", "[", 
        RowBox[{"{", 
         RowBox[{
         "$MaXrdPath", ",", "\"\<UserData\>\"", ",", 
          "\"\<CrystalData.m\>\""}], "}"}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<DistortionType\>\"", "\[Rule]", "\"\<Cartesian\>\""}], ",",
       "\[IndentingNewLine]", 
      RowBox[{"\"\<Distortions\>\"", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<MatchHostSize\>\"", "\[Rule]", "True"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<NewLabel\>\"", "\[Rule]", "\"\<\>\""}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<OverlapPrecedence\>\"", "\[Rule]", "\"\<\>\""}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<OverlapRadius\>\"", "\[Rule]", "1.0"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<RotationAnchorReference\>\"", "\[Rule]", "\"\<Unit\>\""}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{"\"\<RotationAnchorShift\>\"", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<RotationAxes\>\"", "\[Rule]", 
       RowBox[{"IdentityMatrix", "[", "3", "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<Rotations\>\"", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<ShowProgress\>\"", "\[Rule]", "False"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<TrimBoundary\>\"", "\[Rule]", "\"\<None\>\""}]}], 
     "\[IndentingNewLine]", "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SyntaxInformation", "@", "EmbedStructure"}], "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{"\"\<ArgumentsPattern\>\"", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"_", ",", "_", ",", "_", ",", 
       RowBox[{"OptionsPattern", "[", "]"}]}], "}"}]}], "\[IndentingNewLine]",
     "}"}]}], ";"}]}], "Input",
 InitializationCell->False,
 CellLabel->"In[1]:=",
 CellID->284595376],

Cell[BoxData[
 RowBox[{
  RowBox[{"EmbedStructure", "[", "\[IndentingNewLine]", 
   RowBox[{
   "guestUnitsInput_", ",", "\[IndentingNewLine]", 
    "targetPositionsInput_List", ",", "\[IndentingNewLine]", 
    "hostCrystal_String", ",", "\[IndentingNewLine]", 
    RowBox[{"OptionsPattern", "[", "]"}]}], "\[IndentingNewLine]", "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"newStructureLabel", "=", 
       RowBox[{"OptionValue", "[", "\"\<NewLabel\>\"", "]"}]}], ",", 
      "\[IndentingNewLine]", "invAbort", ",", 
      RowBox[{"conditionFilterQ", "=", "False"}], ",", "\[IndentingNewLine]", 
      
      RowBox[{"crystalDataOriginal", "=", "$CrystalData"}], ",", 
      RowBox[{"dataFile", "=", 
       RowBox[{"OptionValue", "[", "\"\<DataFile\>\"", "]"}]}], ",", 
      "\[IndentingNewLine]", "hostStructureSize", ",", "newSize", ",", 
      "\[IndentingNewLine]", "probabilities", ",", "units", ",", 
      "distributionList", ",", "i", ",", "\[IndentingNewLine]", "guestUnits", 
      ",", "guestCopies", ",", "crystalLabels", ",", "specialCrystalLabels", 
      ",", "nonVoidRange", ",", "\[IndentingNewLine]", "makeElementCrystal", 
      ",", "\[IndentingNewLine]", 
      RowBox[{"matchHostSizeQ", "=", 
       RowBox[{"TrueQ", "@", 
        RowBox[{"OptionValue", "[", "\"\<MatchHostSize\>\"", "]"}]}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"anchorShift", "=", 
       RowBox[{"OptionValue", "[", "\"\<RotationAnchorShift\>\"", "]"}]}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{"anchorReference", "=", 
       RowBox[{"OptionValue", "[", "\"\<RotationAnchorReference\>\"", "]"}]}],
       ",", "\[IndentingNewLine]", "R", ",", 
      RowBox[{"rotationAxes", "=", 
       RowBox[{"OptionValue", "[", "\"\<RotationAxes\>\"", "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"targetPositions", "=", "targetPositionsInput"}], ",", 
      "embedLength", ",", "latticeTargetPositions", ",", "hostCoordinates", 
      ",", "mid", ",", "\[IndentingNewLine]", "latticeParameters", ",", 
      "latticeParametersABC", ",", "hostM", ",", "hostMinverse", ",", 
      "targetPositionsCartesian", ",", "\[IndentingNewLine]", "completed", 
      ",", "M", ",", "T", ",", "p", ",", "P", ",", "CheckAndMakeRuleList", 
      ",", "\[IndentingNewLine]", "distortions", ",", "rotations", ",", 
      "performShift", ",", "performTwist", ",", "\[IndentingNewLine]", 
      "conditions", ",", "list", ",", "shift", ",", "twist", ",", 
      "\[IndentingNewLine]", "MakeAlteration", ",", "PrepareAlterationList", 
      ",", "\[IndentingNewLine]", 
      RowBox[{"conditionedDistortionsQ", "=", "False"}], ",", 
      RowBox[{"conditionedRotationsQ", "=", "False"}], ",", 
      "\[IndentingNewLine]", "coordinatesCrystal", ",", 
      "coordinatesCartesian", ",", "\[IndentingNewLine]", 
      "coordinatesCrystalEmbedded", ",", 
      "coordinatesCrystalEmbeddedTranslated", ",", "\[IndentingNewLine]", 
      "newCoordinates", ",", "newCoordinatesCartesian", ",", 
      "\[IndentingNewLine]", "atomDataHost", ",", "atomDataGuest", ",", 
      "joinedAtomData", ",", "boundary", ",", "hostCopy", ",", 
      "newUnitCellAtomCount", ",", "\[IndentingNewLine]", "findOverlap", ",", 
      "intervals", ",", "checks", ",", "atomData1", ",", "atomData2", ",", 
      "xyz1", ",", "xyz2", ",", "nearestList", ",", "overlappingCoordinates", 
      ",", "\[IndentingNewLine]", 
      RowBox[{"overlapPrecedence", "=", 
       RowBox[{"OptionValue", "[", "\"\<OverlapPrecedence\>\"", "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"overlapRadius", "=", 
       RowBox[{"OptionValue", "[", "\"\<OverlapRadius\>\"", "]"}]}]}], 
     "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{
       RowBox[{"--", 
        RowBox[{"-", " ", "Input"}]}], " ", 
       RowBox[{"checks", " ", "--"}]}], "-"}], "*)"}], "\[IndentingNewLine]", 
    
    RowBox[{
     RowBox[{"boundary", "=", 
      RowBox[{"OptionValue", "[", "\"\<TrimBoundary\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"MemberQ", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "\"\<Box\>\"", ",", "\"\<None\>\"", ",", "\"\<OuterEdges\>\""}], 
           "}"}], ",", "boundary"}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{"EmbedStructure", "::", "InvalidTrimming"}], "]"}], ";", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"NumericQ", "@", "overlapRadius"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{"EmbedStructure", "::", "InvalidOverlapRadius"}], "]"}], ";", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"invAbort", "[", "]"}], ":=", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{"EmbedStructure", "::", "InvalidGuestInput"}], "]"}], ";", 
        RowBox[{"Abort", "[", "]"}]}], ")"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Which", "[", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"A", ".", " ", "'"}], 
        RowBox[{"guestUnits", "'"}], " ", "as", " ", "list", " ", "of", " ", 
        "crystals", " ", "or", " ", "elements"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ListQ", "@", "guestUnitsInput"}], ",", "\[IndentingNewLine]", 
       "\t", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"guestUnitsInput", "===", 
           RowBox[{"{", "}"}]}], ",", 
          RowBox[{"invAbort", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]",
         "\t", 
        RowBox[{"Which", "[", "\[IndentingNewLine]", "\t", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"A", ".", "a", ".", " ", "Regular"}], " ", "crystal", " ", 
           "entries"}], " ", "*)"}], "\[IndentingNewLine]", "\t", 
         RowBox[{
          RowBox[{
           RowBox[{"AllTrue", "[", 
            RowBox[{"guestUnitsInput", ",", "StringQ"}], "]"}], "&&", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Depth", "@", "guestUnitsInput"}], "===", "2"}], ")"}]}],
           ",", "\[IndentingNewLine]", "\t", "Null", 
          RowBox[{"(*", " ", 
           RowBox[{"Check", " ", "complete"}], " ", "*)"}], ",", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{"A", ".", "b", ".", " ", "Conditional"}], " ", "rules"}], 
           " ", "*)"}], "\[IndentingNewLine]", "\t", 
          RowBox[{
           RowBox[{"AllTrue", "[", 
            RowBox[{"guestUnitsInput", ",", 
             RowBox[{
              RowBox[{
               RowBox[{"Head", "[", "#", "]"}], "===", "Rule"}], "&"}]}], 
            "]"}], "&&", "\[IndentingNewLine]", "\t", 
           RowBox[{"AllTrue", "[", 
            RowBox[{
             RowBox[{"guestUnitsInput", "\[LeftDoubleBracket]", 
              RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"Head", "[", "#", "]"}], "===", "Condition"}], "&"}]}],
             "]"}]}], ",", "\[IndentingNewLine]", "\t", 
          RowBox[{"conditionFilterQ", "=", "True"}], ",", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", "True", ",", 
          RowBox[{"invAbort", "[", "]"}]}], "\[IndentingNewLine]", "\t", 
         "]"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"B", ".", " ", "'"}], 
         RowBox[{"guestUnits", "'"}], " ", "as", " ", "list", " ", "paired", 
         " ", "with", " ", "probabilities"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Head", "@", "guestUnitsInput"}], "===", "Rule"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"!", 
           RowBox[{"MatchQ", "[", 
            RowBox[{
             RowBox[{"Length", "/@", "guestUnitsInput"}], ",", 
             RowBox[{"x_", "\[Rule]", 
              RowBox[{"x_", "/;", 
               RowBox[{"x", "\[Equal]", "x"}]}]}]}], "]"}]}], ",", 
          RowBox[{"invAbort", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"!", 
           RowBox[{"AllTrue", "[", 
            RowBox[{
             RowBox[{
             "guestUnitsInput", "\[LeftDoubleBracket]", "1", 
              "\[RightDoubleBracket]"}], ",", 
             RowBox[{
              RowBox[{"0.0", "\[LessEqual]", "#", "\[LessEqual]", "1.0"}], 
              "&"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Message", "[", 
            RowBox[{"EmbedStructure", "::", "InvalidProbabilities"}], "]"}], 
           ";", 
           RowBox[{"Abort", "[", "]"}]}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"Invalid", " ", "input"}], " ", "*)"}], "\[IndentingNewLine]",
        "True", ",", 
       RowBox[{"invAbort", "[", "]"}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"MatchQ", "[", 
         RowBox[{
          RowBox[{"Dimensions", "@", "targetPositionsInput"}], ",", 
          RowBox[{"{", 
           RowBox[{"_", ",", "3"}], "}"}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{"EmbedStructure", "::", "InvalidTargetPositions"}], "]"}], 
        ";", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"MemberQ", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\"\<Host\>\"", ",", "\"\<Unit\>\""}], "}"}], ",", 
          "anchorReference"}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"EmbedStructure", "::", "InvalidAnchorReference"}], ",", 
          "anchorReference"}], "]"}], ";", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
        RowBox[{"--", 
         RowBox[{"-", " ", "Checking"}]}], " ", "and", " ", "preparing", " ", 
        
        RowBox[{"embeddings", " ", "--"}]}], "-"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"crystalLabels", "=", 
      RowBox[{"DeleteDuplicates", "@", 
       RowBox[{"Cases", "[", 
        RowBox[{
         RowBox[{"Flatten", "[", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"hostCrystal", ",", "guestUnitsInput"}], "}"}], "]"}], ",",
          "_String", ",", "3"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Scan", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"InputCheck", "[", 
         RowBox[{"\"\<CrystalEntityQ\>\"", ",", "#"}], "]"}], "&"}], ",", 
       "crystalLabels"}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"specialCrystalLabels", "=", 
      RowBox[{"InputCheck", "[", 
       RowBox[{"\"\<HandleSpecialLabels\>\"", ",", "crystalLabels"}], "]"}]}],
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"overlapRadius", "=", 
      RowBox[{"overlapRadius", "/", 
       RowBox[{
        RowBox[{"GetLatticeParameters", "[", "\[IndentingNewLine]", 
         RowBox[{"hostCrystal", ",", 
          RowBox[{"\"\<Units\>\"", "\[Rule]", "False"}]}], "]"}], 
        "\[LeftDoubleBracket]", 
        RowBox[{"{", 
         RowBox[{"1", ",", "2", ",", "3"}], "}"}], 
        "\[RightDoubleBracket]"}]}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"hostCopy", "=", 
      RowBox[{"$CrystalData", "[", "hostCrystal", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"atomDataHost", "=", 
      RowBox[{"hostCopy", "[", "\"\<AtomData\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"hostCoordinates", "=", 
      RowBox[{"atomDataHost", "\[LeftDoubleBracket]", 
       RowBox[{"All", ",", "\"\<FractionalCoordinates\>\""}], 
       "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"hostStructureSize", "=", 
      RowBox[{
       RowBox[{"hostCopy", "[", "\"\<Notes\>\"", "]"}], "[", 
       "\"\<StructureSize\>\"", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"ListQ", "@", "hostStructureSize"}]}], ",", 
       RowBox[{"hostStructureSize", "=", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0"}], "}"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
        RowBox[{"--", 
         RowBox[{"-", " ", "Preparing"}]}], " ", "target", " ", 
        RowBox[{"positions", " ", "--"}]}], "-"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"matchHostSizeQ", "&&", 
        RowBox[{"hostStructureSize", "=!=", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}]}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"latticeTargetPositions", "=", 
         RowBox[{"InputCheck", "[", 
          RowBox[{
          "\"\<GenerateTargetPositions\>\"", ",", "hostStructureSize"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"targetPositions", "=", 
         RowBox[{"Flatten", "[", 
          RowBox[{
           RowBox[{"Outer", "[", 
            RowBox[{
            "Plus", ",", "\[IndentingNewLine]", "latticeTargetPositions", ",",
              "targetPositions", ",", "1"}], "]"}], ",", "1"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"targetPositions", "=", 
         RowBox[{"DeleteCases", "[", 
          RowBox[{"targetPositions", ",", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"x_", ",", "y_", ",", "z_"}], "}"}], "/;", 
            "\[IndentingNewLine]", 
            RowBox[{"Or", "@@", 
             RowBox[{"MapThread", "[", 
              RowBox[{"Greater", ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", 
                 "hostStructureSize"}], "}"}]}], "]"}]}]}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"If", " ", "any", " ", "negative", " ", "coordinates"}], 
          ",", " ", 
          RowBox[{
          "assume", " ", "host", " ", "is", " ", "centred", " ", "around", 
           " ", "origin"}]}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"AnyTrue", "[", 
           RowBox[{
            RowBox[{"Flatten", "@", "hostCoordinates"}], ",", 
            RowBox[{
             RowBox[{"#", "<", 
              RowBox[{"-", "1."}]}], "&"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"mid", "=", 
            RowBox[{"\[LeftFloor]", 
             RowBox[{"hostStructureSize", "/", "2."}], "\[RightFloor]"}]}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"targetPositions", "=", 
            RowBox[{
             RowBox[{
              RowBox[{"#", "-", "mid"}], "&"}], "/@", 
             "targetPositions"}]}]}]}], "\[IndentingNewLine]", "]"}]}]}], 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"embedLength", "=", 
      RowBox[{"Length", "@", "targetPositions"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Preparing", " ", "list", " ", "to", " ", "be", " ", "used"}], 
      " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"guestUnits", "=", 
      RowBox[{"Which", "[", "\[IndentingNewLine]", 
       RowBox[{"conditionFilterQ", ",", "\[IndentingNewLine]", 
        RowBox[{"targetPositions", "/.", 
         RowBox[{"Append", "[", 
          RowBox[{"guestUnitsInput", ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{"x_", ",", "y_", ",", "z_"}], "}"}], "/;", "True"}], 
            "\[Rule]", "\"\<Void\>\""}]}], "]"}]}], ",", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Head", "@", "guestUnitsInput"}], "===", "Rule"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"probabilities", ",", "units"}], "}"}], "=", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Keys", "@", "#"}], ",", 
              RowBox[{"Values", "@", "#"}]}], "}"}], "&"}], "@", 
           "guestUnitsInput"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"distributionList", "=", 
          RowBox[{"Round", "[", 
           RowBox[{"probabilities", "*", "embedLength"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Which", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"Total", "@", "distributionList"}], "<", "embedLength"}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{"While", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Total", "@", "distributionList"}], "<", 
              "embedLength"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"i", "=", 
               RowBox[{"RandomInteger", "[", 
                RowBox[{"{", 
                 RowBox[{"1", ",", 
                  RowBox[{"Length", "@", "distributionList"}]}], "}"}], 
                "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
               "distributionList", "\[LeftDoubleBracket]", "i", 
                "\[RightDoubleBracket]"}], "+=", "1"}]}]}], "]"}], ",", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Total", "@", "distributionList"}], ">", "embedLength"}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{"While", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Total", "@", "distributionList"}], ">", 
              "embedLength"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"i", "=", 
               RowBox[{"RandomInteger", "[", 
                RowBox[{"{", 
                 RowBox[{"1", ",", 
                  RowBox[{"Length", "@", "distributionList"}]}], "}"}], 
                "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
               "distributionList", "\[LeftDoubleBracket]", "i", 
                "\[RightDoubleBracket]"}], "-=", "1"}]}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"RandomSample", "@", 
          RowBox[{"Flatten", "@", 
           RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
            RowBox[{"ConstantArray", ",", 
             RowBox[{"{", 
              RowBox[{"units", ",", "distributionList"}], "}"}]}], 
            "]"}]}]}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        "True", ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"PadRight", "[", 
           RowBox[{"#", ",", "embedLength", ",", "#"}], "]"}], "&"}], "@", 
         "guestUnitsInput"}]}], "\[IndentingNewLine]", "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"guestCopies", "=", 
      RowBox[{"$CrystalData", "/@", "guestUnits"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"nonVoidRange", "=", 
      RowBox[{"Complement", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Range", "@", "embedLength"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Flatten", "@", 
         RowBox[{"Position", "[", 
          RowBox[{"guestUnits", ",", "\"\<Void\>\""}], "]"}]}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"nonVoidRange", "===", 
        RowBox[{"{", "}"}]}], ",", 
       RowBox[{"Goto", "[", "\"\<End\>\"", "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"latticeParameters", "=", 
      RowBox[{"GetLatticeParameters", "[", "\[IndentingNewLine]", 
       RowBox[{"hostCrystal", ",", 
        RowBox[{"\"\<Units\>\"", "\[Rule]", "False"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"latticeParametersABC", "=", 
      RowBox[{"latticeParameters", "\[LeftDoubleBracket]", 
       RowBox[{";;", "3"}], "\[RightDoubleBracket]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"hostM", "=", 
      RowBox[{"GetCrystalMetric", "[", "\[IndentingNewLine]", 
       RowBox[{"hostCrystal", ",", 
        RowBox[{"\"\<ToCartesian\>\"", "\[Rule]", "True"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"hostMinverse", "=", 
      RowBox[{"Inverse", "@", "hostM"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"targetPositionsCartesian", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"hostM", ".", "#"}], "&"}], "/@", "targetPositions"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
        RowBox[{"--", 
         RowBox[{"-", " ", "Distortions"}]}], " ", "and", " ", 
        RowBox[{"rotations", " ", "--"}], " ", "Checks", " ", "and", " ", 
        RowBox[{"preparations", " ", "--"}]}], "-"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"MakeAlteration", "[", "c_", "]"}], ":=", "c"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"MakeAlteration", "[", 
       RowBox[{"{", 
        RowBox[{"min_", ",", "max_"}], "}"}], "]"}], ":=", 
      RowBox[{"Hold", "@", 
       RowBox[{"RandomReal", "[", 
        RowBox[{"{", 
         RowBox[{"min", ",", "max"}], "}"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"MakeAlteration", "[", 
       RowBox[{"{", 
        RowBox[{"x_", ",", "y_", ",", "z_"}], "}"}], "]"}], ":=", 
      RowBox[{"MakeAlteration", "/@", 
       RowBox[{"{", 
        RowBox[{"x", ",", "y", ",", "z"}], "}"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"PrepareAlterationList", "[", 
       RowBox[{"conditionsQ_", ",", "ruleList_List"}], "]"}], ":=", 
      RowBox[{"If", "[", 
       RowBox[{"conditionsQ", ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"conditions", "=", 
          RowBox[{"Append", "[", 
           RowBox[{"ruleList", ",", 
            RowBox[{
             RowBox[{
              RowBox[{"{", 
               RowBox[{"x_", ",", "y_", ",", "z_"}], "}"}], "/;", "True"}], 
             "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"0.", ",", "0.", ",", "0."}], "}"}]}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"list", "=", 
          RowBox[{"Map", "[", 
           RowBox[{"MakeAlteration", ",", "conditions", ",", 
            RowBox[{"{", "2", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "/.", 
            RowBox[{"ReleaseHold", "@", "list"}]}], "&"}], "/@", 
          "targetPositions"}]}], ",", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"ReleaseHold", "@", 
         RowBox[{"ConstantArray", "[", 
          RowBox[{
           RowBox[{"MakeAlteration", "/@", "ruleList"}], ",", "embedLength"}],
           "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"distortions", "=", 
      RowBox[{"OptionValue", "[", "\"\<Distortions\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"performShift", "=", 
      RowBox[{"distortions", "=!=", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0"}], "}"}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"rotations", "=", 
      RowBox[{"OptionValue", "[", "\"\<Rotations\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"performTwist", "=", 
      RowBox[{"rotations", "=!=", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0"}], "}"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"rotations", "=", 
      RowBox[{"rotations", "/.", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"c_Condition", "\[Rule]", "r_List"}], ")"}], 
          "\[RuleDelayed]", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"N", "@", "c"}], "\[Rule]", 
            RowBox[{"N", "@", "r"}]}], ")"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"r1_", ",", "r2_", ",", "r3_"}], "}"}], "\[RuleDelayed]", 
          RowBox[{"N", "@", 
           RowBox[{"{", 
            RowBox[{"r1", ",", "r2", ",", "r3"}], "}"}]}]}]}], 
        "\[IndentingNewLine]", "}"}]}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"p", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"NumericQ", "[", "#", "]"}], ")"}], "&"}]}], ";", 
     RowBox[{
      RowBox[{"P", "[", "x_", "]"}], ":=", 
      RowBox[{"p", "[", "x", "]"}]}], ";", 
     RowBox[{
      RowBox[{"P", "[", 
       RowBox[{"{", 
        RowBox[{"x_", ",", "y_"}], "}"}], "]"}], ":=", 
      RowBox[{
       RowBox[{"p", "[", "x", "]"}], "&&", 
       RowBox[{"p", "[", "y", "]"}]}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"CheckAndMakeRuleList", "[", "input_", "]"}], ":=", 
      RowBox[{"Check", "[", 
       RowBox[{
        RowBox[{"Which", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"input", "===", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ")"}], "||", 
           RowBox[{"SubsetQ", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"Integer", ",", "Real", ",", "List"}], "}"}], ",", 
             RowBox[{"Head", "/@", "input"}]}], "]"}]}], ",", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{"{", 
           RowBox[{"False", ",", 
            RowBox[{"CheckAndMakeRuleList", "[", 
             RowBox[{
              RowBox[{"N", "@", "input"}], ",", "\"\<Numeric\>\""}], "]"}]}], 
           "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"AllTrue", "[", 
              RowBox[{"Input", ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"Head", "[", "#", "]"}], "===", "Rule"}], "&"}]}], 
              "]"}], "&&", "\[IndentingNewLine]", 
             RowBox[{"AllTrue", "[", 
              RowBox[{
               RowBox[{"input", "\[LeftDoubleBracket]", 
                RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"Head", "[", "#", "]"}], "===", "Condition"}], 
                "&"}]}], "]"}]}], ")"}], "||", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Head", "/@", "input"}], "===", 
             RowBox[{"{", 
              RowBox[{"Condition", ",", "List"}], "}"}]}], ")"}]}], ",", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{"{", 
           RowBox[{"True", ",", 
            RowBox[{"CheckAndMakeRuleList", "[", 
             RowBox[{
              RowBox[{"N", "@", "input"}], ",", "\"\<Conditions\>\""}], 
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", "True", ",", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{
           RowBox[{"Message", "[", 
            RowBox[{"EmbedStructure", "::", "InvalidAlteration"}], "]"}], ";",
            "\[IndentingNewLine]", "\t", 
           RowBox[{"Abort", "[", "]"}]}]}], "\[IndentingNewLine]", "]"}], ",", 
        RowBox[{"Abort", "[", "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{
      RowBox[{"CheckAndMakeRuleList", "[", 
       RowBox[{"input_", ",", "\"\<Conditions\>\""}], "]"}], ":=", 
      RowBox[{"(", "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"P", "/@", "#"}], ")"}], "=!=", 
             RowBox[{"{", 
              RowBox[{"True", ",", "True", ",", "True"}], "}"}]}], "&"}], "/@", 
           RowBox[{"input", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}]}], ",", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{
           RowBox[{"Message", "[", 
            RowBox[{"EmbedStructure", "::", "InvalidAlterationValues"}], 
            "]"}], ";", "\[IndentingNewLine]", "\t", 
           RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]",
         "\t", 
        RowBox[{"input", "/.", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"x_Condition", "\[Rule]", "y_"}], "}"}], "\[RuleDelayed]", 
          
          RowBox[{"{", 
           RowBox[{"x", "\[Rule]", 
            RowBox[{"N", "@", "y"}]}], "}"}]}]}]}], "\[IndentingNewLine]", 
       "\t", ")"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{
      RowBox[{"CheckAndMakeRuleList", "[", 
       RowBox[{"input_", ",", "\"\<Numeric\>\""}], "]"}], ":=", 
      RowBox[{"(", "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"P", "/@", "input"}], ")"}], "=!=", 
           RowBox[{"{", 
            RowBox[{"True", ",", "True", ",", "True"}], "}"}]}], ",", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{
           RowBox[{"Message", "[", 
            RowBox[{"EmbedStructure", "::", "InvalidAlterationValues"}], 
            "]"}], ";", "\[IndentingNewLine]", "\t", 
           RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]",
         "\t", "input"}], "\[IndentingNewLine]", "\t", ")"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"conditionedDistortionsQ", ",", "distortions"}], "}"}], "=", 
      RowBox[{"CheckAndMakeRuleList", "@", "distortions"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"distortions", "=", 
      RowBox[{"PrepareAlterationList", "[", 
       RowBox[{"conditionedDistortionsQ", ",", "distortions"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Which", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"OptionValue", "[", "\"\<DistortionType\>\"", "]"}], "===", 
        "\"\<Crystallographic\>\""}], ",", "\[IndentingNewLine]", "Null", ",",
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"OptionValue", "[", "\"\<DistortionType\>\"", "]"}], "===", 
        "\"\<Cartesian\>\""}], ",", "\[IndentingNewLine]", 
       RowBox[{"distortions", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"hostMinverse", ".", "#"}], "&"}], "/@", "distortions"}]}], 
       ",", "\[IndentingNewLine]", "\[IndentingNewLine]", "True", ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{"EmbedStructure", "::", "InvalidDistortionType"}], "]"}], 
        ";", 
        RowBox[{"Abort", "[", "]"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"conditionedRotationsQ", ",", "rotations"}], "}"}], "=", 
      RowBox[{"CheckAndMakeRuleList", "@", "rotations"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"rotations", "=", 
      RowBox[{"PrepareAlterationList", "[", 
       RowBox[{"conditionedRotationsQ", ",", "rotations"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
        RowBox[{"--", 
         RowBox[{"-", " ", "Actual"}]}], " ", 
        RowBox[{"tranformation", " ", "--"}], " ", "Loop", " ", "through", 
        " ", "each", " ", "guest", " ", 
        RowBox[{"unit", " ", "--"}]}], "-"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"R", "=", 
      RowBox[{"If", "[", 
       RowBox[{"performTwist", ",", "\[IndentingNewLine]", 
        RowBox[{"InputCheck", "[", 
         RowBox[{"\"\<RotationTransformation\>\"", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
            RowBox[{"{", "}"}]}], "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"anchorShift", ",", "anchorReference", ",", 
            RowBox[{"{", "}"}], ",", "rotationAxes"}], "}"}]}], "]"}]}], 
       "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"completed", "=", "0"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"TrueQ", "@", 
        RowBox[{"OptionValue", "[", "\"\<ShowProgress\>\"", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"PrintTemporary", "[", 
        RowBox[{"ProgressIndicator", "@", 
         RowBox[{"Dynamic", "[", 
          RowBox[{"completed", "/", "embedLength"}], "]"}]}], "]"}]}], "]"}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"M", "=", 
         RowBox[{"GetCrystalMetric", "[", 
          RowBox[{
           RowBox[{
           "guestUnits", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}], ",", 
           RowBox[{"\"\<ToCartesian\>\"", "\[Rule]", "True"}]}], "]"}]}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"T", "=", 
         RowBox[{"TranslationTransform", "[", 
          RowBox[{
          "targetPositions", "\[LeftDoubleBracket]", "i", 
           "\[RightDoubleBracket]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"coordinatesCrystal", "=", "\[IndentingNewLine]", 
         RowBox[{"guestCopies", "\[LeftDoubleBracket]", 
          RowBox[{
          "i", ",", "\"\<AtomData\>\"", ",", "All", ",", 
           "\"\<FractionalCoordinates\>\""}], "\[RightDoubleBracket]"}]}], 
        ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"coordinatesCartesian", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"M", ".", "#"}], "&"}], "/@", "coordinatesCrystal"}]}], 
        ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"coordinatesCrystalEmbedded", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"hostMinverse", ".", "#"}], "\[IndentingNewLine]", "&"}], "/@",
           "coordinatesCartesian"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"coordinatesCrystalEmbeddedTranslated", "=", 
         RowBox[{"T", "/@", "coordinatesCrystalEmbedded"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
        "newCoordinates", "=", "coordinatesCrystalEmbeddedTranslated"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"Optional", ":", " ", 
           RowBox[{"Perform", " ", "shifts"}]}], ",", " ", 
          RowBox[{"twists", " ", "or", " ", "transformations"}]}], " ", 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"performShift", "||", "performTwist"}], ",", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"Optional", ":", " ", "Rotations"}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{"performTwist", ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"twist", "=", 
               RowBox[{"R", "[", 
                RowBox[{
                 RowBox[{
                 "rotations", "\[LeftDoubleBracket]", "i", 
                  "\[RightDoubleBracket]"}], ",", 
                 RowBox[{
                 "targetPositionsCartesian", "\[LeftDoubleBracket]", "i", 
                  "\[RightDoubleBracket]"}]}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"newCoordinatesCartesian", "=", 
               RowBox[{
                RowBox[{
                 RowBox[{"hostM", ".", "#"}], "&"}], "/@", 
                "newCoordinates"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"newCoordinatesCartesian", "=", 
               RowBox[{"twist", "@", "newCoordinatesCartesian"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"newCoordinates", "=", 
               RowBox[{
                RowBox[{
                 RowBox[{"hostMinverse", ".", "#"}], "&"}], "/@", 
                "newCoordinatesCartesian"}]}]}]}], "\[IndentingNewLine]", 
            "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{"Optional", ":", " ", "Distortions"}], " ", "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{"performShift", ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"shift", "=", 
               RowBox[{
               "distortions", "\[LeftDoubleBracket]", "i", 
                "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"newCoordinates", "=", 
               RowBox[{
                RowBox[{
                 RowBox[{"#", "+", "shift"}], "&"}], "/@", 
                "newCoordinates"}]}]}]}], "]"}]}]}], "\[IndentingNewLine]", 
         "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"guestCopies", "\[LeftDoubleBracket]", 
          RowBox[{
          "i", ",", "\"\<AtomData\>\"", ",", "All", ",", 
           "\"\<FractionalCoordinates\>\""}], "\[RightDoubleBracket]"}], "=", 
         "newCoordinates"}], ";", "\[IndentingNewLine]", 
        RowBox[{"completed", "++"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"i", ",", "nonVoidRange"}], "}"}]}], "\[IndentingNewLine]", 
      "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
        RowBox[{"--", 
         RowBox[{"-", " ", "Merge"}]}], " ", "guest", " ", "units", " ", 
        "with", " ", "traget", " ", 
        RowBox[{"crystal", " ", "--"}]}], "-"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"atomDataHost", "===", 
        RowBox[{"{", 
         RowBox[{"\[LeftAssociation]", "\[RightAssociation]"}], "}"}]}], ",", 
       
       RowBox[{"atomDataHost", "=", 
        RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"atomDataHost", "=", 
         RowBox[{"$CrystalData", "[", 
          RowBox[{"hostCrystal", ",", "\"\<AtomData\>\""}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"atomDataHost", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Append", "[", 
            RowBox[{"#", ",", 
             RowBox[{"\"\<Component\>\"", "\[Rule]", "\"\<Host\>\""}]}], 
            "]"}], "&"}], "/@", "atomDataHost"}]}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"atomDataGuest", "=", 
      RowBox[{"Flatten", "@", 
       RowBox[{"guestCopies", "\[LeftDoubleBracket]", 
        RowBox[{"nonVoidRange", ",", "\"\<AtomData\>\""}], 
        "\[RightDoubleBracket]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"atomDataGuest", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Append", "[", 
         RowBox[{"#", ",", 
          RowBox[{"\"\<Component\>\"", "\[Rule]", "\"\<Guest\>\""}]}], "]"}], 
        "&"}], "/@", "atomDataGuest"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Optional", ":", " ", 
       RowBox[{
       "Remove", " ", "overlapping", " ", "target", " ", "positions"}]}], " ",
       "*)"}], "\[IndentingNewLine]", 
     RowBox[{"joinedAtomData", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"!", 
         RowBox[{"MemberQ", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"\"\<Host\>\"", ",", "\"\<Guest\>\""}], "}"}], ",", 
           "overlapPrecedence"}], "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"A", ".", " ", "No"}], " ", "measure", " ", "taken", " ", 
          "against", " ", "overlapping"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"Join", "[", 
         RowBox[{"atomDataHost", ",", "atomDataGuest"}], "]"}], ",", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"B", ".", " ", "Remove"}], " ", "superpositioned", " ", 
          "atoms"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"findOverlap", "[", 
           RowBox[{"point_", ",", "region_List"}], "]"}], ":=", 
          RowBox[{"(", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"region", "===", 
               RowBox[{"{", "}"}]}], ",", 
              RowBox[{"Return", "@", "Nothing"}]}], "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"intervals", "=", 
             RowBox[{"MapThread", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Interval", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"#1", "-", "#2"}], ",", 
                   RowBox[{"#1", "+", "#2"}]}], "}"}], "]"}], "&"}], ",", 
               RowBox[{"{", 
                RowBox[{"point", ",", "overlapRadius"}], "}"}]}], "]"}]}], 
            ";", "\[IndentingNewLine]", 
            RowBox[{"checks", "=", 
             RowBox[{"MapThread", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"IntervalMemberQ", "[", 
                 RowBox[{"#1", ",", "#2"}], "]"}], "&"}], ",", 
               RowBox[{"{", 
                RowBox[{"intervals", ",", 
                 RowBox[{"Transpose", "@", "region"}]}], "}"}]}], "]"}]}], 
            ";", "\[IndentingNewLine]", 
            RowBox[{"checks", "=", 
             RowBox[{"Position", "[", 
              RowBox[{
               RowBox[{"And", "@@@", 
                RowBox[{"Transpose", "@", "checks"}]}], ",", "True"}], 
              "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"checks", "=!=", 
               RowBox[{"{", "}"}]}], ",", 
              RowBox[{"Part", "[", 
               RowBox[{"region", ",", 
                RowBox[{"Flatten", "@", "checks"}]}], "]"}], ",", "Nothing"}],
              "]"}]}], "\[IndentingNewLine]", ")"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"atomData1", ",", "atomData2"}], "}"}], "=", 
          RowBox[{
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"overlapPrecedence", "===", "\"\<Host\>\""}], ",", 
              "\[IndentingNewLine]", "#", ",", 
              RowBox[{"Reverse", "@", "#"}]}], "]"}], "&"}], "@", 
           RowBox[{"{", 
            RowBox[{"atomDataHost", ",", "atomDataGuest"}], "}"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"xyz1", ",", "xyz2"}], "}"}], "=", 
          RowBox[{
           RowBox[{
            RowBox[{"Part", "[", 
             RowBox[{"#", ",", "All", ",", "\"\<FractionalCoordinates\>\""}], 
             "]"}], "&"}], "/@", 
           RowBox[{"{", 
            RowBox[{"atomData1", ",", "atomData2"}], "}"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"nearestList", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"Nearest", "[", 
             RowBox[{"xyz2", ",", "#", ",", "5"}], "]"}], "&"}], "/@", 
           "xyz1"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"overlappingCoordinates", "=", 
          RowBox[{"Flatten", "[", 
           RowBox[{
            RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
             RowBox[{"findOverlap", ",", 
              RowBox[{"{", 
               RowBox[{"xyz1", ",", "nearestList"}], "}"}]}], "]"}], ",", 
            "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"atomData2", "=", 
          RowBox[{"DeleteCases", "[", 
           RowBox[{"atomData2", ",", 
            RowBox[{"x_", "/;", 
             RowBox[{"MemberQ", "[", "\[IndentingNewLine]", 
              RowBox[{"overlappingCoordinates", ",", 
               RowBox[{"x", "[", "\"\<FractionalCoordinates\>\"", "]"}]}], 
              "]"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Join", "[", 
          RowBox[{"atomData1", ",", "atomData2"}], "]"}]}]}], 
       "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Optional", ":", " ", 
       RowBox[{"Trim", " ", "the", " ", "outer", " ", "boundary"}]}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"boundary", "=!=", "\"\<None\>\""}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Which", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"boundary", "===", "\"\<Box\>\""}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"joinedAtomData", "=", 
           RowBox[{"DeleteCases", "[", 
            RowBox[{"joinedAtomData", ",", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"x_", ",", "y_", ",", "z_"}], "}"}], "/;", 
              "\[IndentingNewLine]", 
              RowBox[{"Nand", "@@", 
               RowBox[{"MapThread", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"0", "\[LessEqual]", "#1", "<", "#2"}], "&"}], ",", 
                 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", 
                   "hostStructureSize"}], "}"}]}], "]"}]}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", "2", "}"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"boundary", "===", "\"\<OuterEdges\>\""}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"joinedAtomData", "=", 
           RowBox[{"DeleteCases", "[", 
            RowBox[{"joinedAtomData", ",", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"x_", ",", "y_", ",", "z_"}], "}"}], "/;", 
              "\[IndentingNewLine]", 
              RowBox[{"Nand", "@@", 
               RowBox[{"MapThread", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"0", "\[LessEqual]", "#1", "<", "#2"}], "&"}], ",", 
                 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"x", ",", "y"}], "}"}], ",", 
                   RowBox[{"hostStructureSize", "\[LeftDoubleBracket]", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "2"}], "}"}], 
                    "\[RightDoubleBracket]"}]}], "}"}]}], "]"}]}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", "2", "}"}]}], "]"}]}]}], "\[IndentingNewLine]", 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"joinedAtomData", "=", 
         RowBox[{"Select", "[", 
          RowBox[{"joinedAtomData", ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"KeyExistsQ", "[", 
             RowBox[{"#", ",", "\"\<FractionalCoordinates\>\""}], "]"}], 
            "&"}]}], "]"}]}]}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"joinedAtomData", "=", 
      RowBox[{"MapAt", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"N", "@", 
          RowBox[{"Chop", "[", 
           RowBox[{"#", ",", 
            RowBox[{"10.", "^", 
             RowBox[{"-", "6"}]}]}], "]"}]}], "&"}], ",", "joinedAtomData", 
        ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"All", ",", "\"\<FractionalCoordinates\>\""}], "}"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"hostCopy", "[", "\"\<AtomData\>\"", "]"}], "=", 
      "joinedAtomData"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Overwrite", " ", "host", " ", "or", " ", "create", " ", "new", " ", 
       "crystal", " ", "object"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Label", "[", "\"\<End\>\"", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Which", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"newStructureLabel", "===", "\"\<Void\>\""}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"newStructureLabel", "=", "\"\<CustomStructure\>\""}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"hostCrystal", "===", "\"\<Void\>\""}], "&&", 
        RowBox[{"newStructureLabel", "===", "\"\<\>\""}]}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"newStructureLabel", "=", "\"\<CustomStructure\>\""}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"newStructureLabel", "===", "\"\<\>\""}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"newStructureLabel", "=", "hostCrystal"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"$CrystalData", "=", "crystalDataOriginal"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"newSize", "=", 
      RowBox[{
       RowBox[{"hostCopy", "[", 
        RowBox[{"\"\<Notes\>\"", ",", "\"\<StructureSize\>\""}], "]"}], "/.", 
       
       RowBox[{"_Missing", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"1", ",", "1", ",", "1"}], "}"}]}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"newUnitCellAtomCount", "=", 
      RowBox[{"\[LeftCeiling]", 
       RowBox[{
        RowBox[{"Length", "@", "joinedAtomData"}], "/", 
        RowBox[{"Times", "@@", "newSize"}]}], "\[RightCeiling]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"KeyExistsQ", "[", 
         RowBox[{"hostCopy", ",", "\"\<Notes\>\""}], "]"}]}], ",", 
       RowBox[{"AppendTo", "[", 
        RowBox[{"hostCopy", ",", 
         RowBox[{"\"\<Notes\>\"", "\[Rule]", 
          RowBox[{"<|", "|>"}]}]}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"AppendTo", "[", 
      RowBox[{
       RowBox[{"hostCopy", "[", "\"\<Notes\>\"", "]"}], ",", 
       RowBox[{
       "\"\<UnitCellAtomsCount\>\"", "\[Rule]", "newUnitCellAtomCount"}]}], 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"AppendTo", "[", 
      RowBox[{
       RowBox[{"hostCopy", "[", "\"\<Notes\>\"", "]"}], ",", 
       RowBox[{"\"\<AsymmetricUnitAtomsCount\>\"", "\[Rule]", "Null"}]}], 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"AppendTo", "[", 
      RowBox[{
       RowBox[{"hostCopy", "[", "\"\<Notes\>\"", "]"}], ",", 
       RowBox[{"\"\<StructureSize\>\"", "\[Rule]", "newSize"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"InputCheck", "[", 
      RowBox[{
      "\"\<Update$CrystalDataFile\>\"", ",", "dataFile", ",", 
       "newStructureLabel", ",", "hostCopy"}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "newStructureLabel"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->False,
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->"In[2]:=",
 CellID->748402563]
}, Closed]],

Cell["", "SectionFooterSpacer"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  TemplateBox[{6},
   "Spacer1"]]],
 "See Also"
}], "SeeAlsoSection",
 WholeCellGroupOpener->True,
 CellID->1255426704],

Cell[TextData[{
 Cell[BoxData[
  TemplateBox[{
    Cell[
     TextData["$CrystalData"]], "paclet:MaXrd/ref/$CrystalData"},
   "RefLink",
   BaseStyle->{"InlineFormula", FontFamily -> "Verdana"}]], "InlineFormula"],
 "\[NonBreakingSpace]",
 StyleBox["\[MediumSpace]\[FilledVerySmallSquare]\[MediumSpace]", 
  "InlineSeparator"],
 " ",
 Cell[BoxData[
  TemplateBox[{
    Cell[
     TextData["CrystalPlot"]], "paclet:MaXrd/ref/CrystalPlot"},
   "RefLink",
   BaseStyle->{"InlineFormula", FontFamily -> "Verdana"}]], "InlineFormula"],
 "\[NonBreakingSpace]",
 StyleBox["\[MediumSpace]\[FilledVerySmallSquare]\[MediumSpace]", 
  "InlineSeparator"],
 " ",
 Cell[BoxData[
  TemplateBox[{
    Cell[
     TextData["ExpandCrystal"]], "paclet:MaXrd/ref/ExpandCrystal"},
   "RefLink",
   BaseStyle->{"InlineFormula", FontFamily -> "Verdana"}]], "InlineFormula"],
 "\[NonBreakingSpace]",
 StyleBox["\[MediumSpace]\[FilledVerySmallSquare]\[MediumSpace]", 
  "InlineSeparator"],
 " ",
 Cell[BoxData[
  TemplateBox[{
    Cell[
     TextData["DistortStructure"]], "paclet:MaXrd/ref/DistortStructure"},
   "RefLink",
   BaseStyle->{"InlineFormula", FontFamily -> "Verdana"}]], "InlineFormula"],
 "\[NonBreakingSpace]",
 StyleBox["\[MediumSpace]\[FilledVerySmallSquare]\[MediumSpace]", 
  "InlineSeparator"],
 " ",
 Cell[BoxData[
  TemplateBox[{
    Cell[
     TextData["SynthesiseStructure"]], "paclet:MaXrd/ref/SynthesiseStructure"},
   "RefLink",
   BaseStyle->{"InlineFormula", FontFamily -> "Verdana"}]], "InlineFormula"],
 "\[NonBreakingSpace]",
 StyleBox["\[MediumSpace]\[FilledVerySmallSquare]\[MediumSpace]", 
  "InlineSeparator"],
 " ",
 Cell[BoxData[
  TemplateBox[{
    Cell[
     TextData["SimulateDiffractionPattern"]], 
    "paclet:MaXrd/ref/SimulateDiffractionPattern"},
   "RefLink",
   BaseStyle->{"InlineFormula", FontFamily -> "Verdana"}]], "InlineFormula"],
 "\[NonBreakingSpace]",
 StyleBox["\[MediumSpace]\[FilledVerySmallSquare]\[MediumSpace]", 
  "InlineSeparator"],
 " ",
 Cell[BoxData[
  TemplateBox[{
    Cell[
     TextData["GetCrystalMetric"]], "paclet:MaXrd/ref/GetCrystalMetric"},
   "RefLink",
   BaseStyle->{"InlineFormula", FontFamily -> "Verdana"}]], "InlineFormula"],
 "\[NonBreakingSpace]",
 StyleBox["\[MediumSpace]\[FilledVerySmallSquare]\[MediumSpace]", 
  "InlineSeparator"],
 " ",
 Cell[BoxData[
  TemplateBox[{
    Cell[
     TextData["GetLatticeParameters"]], 
    "paclet:MaXrd/ref/GetLatticeParameters"},
   "RefLink",
   BaseStyle->{"InlineFormula", FontFamily -> "Verdana"}]], "InlineFormula"],
 "\[NonBreakingSpace]",
 StyleBox["\[MediumSpace]\[FilledVerySmallSquare]\[MediumSpace]", 
  "InlineSeparator"],
 " ",
 Cell[BoxData[
  TemplateBox[{
    Cell[
     TextData["InputCheck"]], "paclet:MaXrd/ref/InputCheck"},
   "RefLink",
   BaseStyle->{"InlineFormula", FontFamily -> "Verdana"}]], "InlineFormula"],
 "\[NonBreakingSpace]",
 StyleBox["\[MediumSpace]\[FilledVerySmallSquare]\[MediumSpace]", 
  "InlineSeparator"],
 " ",
 Cell[BoxData[
  TemplateBox[{
    Cell[
     TextData["ToStandardSetting"]], "paclet:MaXrd/ref/ToStandardSetting"},
   "RefLink",
   BaseStyle->{"InlineFormula", FontFamily -> "Verdana"}]], "InlineFormula"],
 "\[NonBreakingSpace]",
 StyleBox["\[MediumSpace]\[FilledVerySmallSquare]\[MediumSpace]", 
  "InlineSeparator"],
 " ",
 Cell[BoxData[
  TemplateBox[{
    Cell[
     TextData["CrystalFormulaUnits"]], "paclet:MaXrd/ref/CrystalFormulaUnits"},
   "RefLink",
   BaseStyle->{"InlineFormula", FontFamily -> "Verdana"}]], "InlineFormula"],
 "\[NonBreakingSpace]",
 StyleBox["\[MediumSpace]\[FilledVerySmallSquare]\[MediumSpace]", 
  "InlineSeparator"],
 " ",
 Cell[BoxData[
  TemplateBox[{
    Cell[
     TextData["ExportCrystalData"]], "paclet:MaXrd/ref/ExportCrystalData"},
   "RefLink",
   BaseStyle->{"InlineFormula", FontFamily -> "Verdana"}]], "InlineFormula"]
}], "SeeAlso",
 CellID->929782353]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  TemplateBox[{6},
   "Spacer1"]]],
 "Tutorials"
}], "TutorialsSection",
 WholeCellGroupOpener->True,
 CellID->250839057],

Cell["", "SectionHeaderSpacer"],

Cell[BoxData[
 TemplateBox[{
   Cell[
    TextData["Using the rotation options"]], 
   "paclet:MaXrd/tutorial/UsingRotationMaps"},
  "RefLink",
  BaseStyle->"Tutorials"]], "Tutorials",
 CellID->131883350],

Cell["", "SectionFooterSpacer"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  TemplateBox[{6},
   "Spacer1"]]],
 "Related Guides"
}], "MoreAboutSection",
 WholeCellGroupOpener->True,
 CellID->38303248],

Cell["", "SectionHeaderSpacer"],

Cell[BoxData[
 TemplateBox[{
   Cell[
    TextData["MaXrd: Mathematica X-ray diffraction package"]], 
   "paclet:MaXrd/guide/MaXrd"},
  "RefLink",
  BaseStyle->"MoreAbout"]], "MoreAbout",
 CellID->1039426961]
}, Open  ]],

Cell[" ", "FooterCell"]
},
Saveable->False,
ScreenStyleEnvironment->"Working",
WindowSize->{725, 750},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
WindowTitle->"EmbedStructure",
TaggingRules->{
 "ModificationHighlight" -> False, "ColorType" -> "SymbolColor", "LinkTrails" -> 
  GridBox[{{
      RowBox[{
        ButtonBox[
        "MaXrd: Mathematica X-ray diffraction package", ButtonData -> 
         "paclet:MaXrd/guide/MaXrd", 
         BaseStyle -> {"Link", "DockedLinkTrail"}]}]}}, ColumnAlignments -> 
    Left], "HasOptions" -> True, "ExampleCounter" -> 1, "NeedPlatMsgIn" -> 
  None, "RootCaptions" -> "", 
  "Metadata" -> {
   "built" -> "{2020, 9, 3, 23, 14, 42.116526}", 
    "history" -> {"1.2", "2.4.0", "", ""}, "context" -> "MaXrd`", 
    "keywords" -> {}, "specialkeywords" -> {}, 
    "tutorialcollectionlinks" -> {}, "index" -> True, "label" -> 
    "MaXrd Symbol", "language" -> "en", "paclet" -> "MaXrd", "status" -> 
    "None", "summary" -> 
    "EmbedStructure[guestUnits, targetPositions, hostCrystal] embeds \
guestUnits at targetPositions into hostCrystal.", "synonyms" -> {}, 
    "tabletags" -> {}, "title" -> "EmbedStructure", "titlemodifier" -> "", 
    "windowtitle" -> "EmbedStructure", "type" -> "Symbol", "uri" -> 
    "MaXrd/ref/EmbedStructure", "WorkflowDockedCell" -> ""}, 
  "SearchTextTranslated" -> "", "NewStyles" -> False},
CellContext->"Global`",
FrontEndVersion->"12.1 for Mac OS X x86 (64-bit) (June 19, 2020)",
StyleDefinitions->Notebook[{
   Cell[
    StyleData[
    StyleDefinitions -> FrontEnd`FileName[{"Wolfram"}, "Reference.nb"]]], 
   Cell[
    StyleData["Input"], CellContext -> "Global`"], 
   Cell[
    StyleData["Output"], CellContext -> "Global`"]}, Visible -> False, 
  FrontEndVersion -> "12.1 for Mac OS X x86 (64-bit) (June 19, 2020)", 
  StyleDefinitions -> "Default.nb"]
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{
 "PrimaryExamplesSection"->{
  Cell[22431, 655, 269, 10, 70, "PrimaryExamplesSection",ExpressionUUID->"89eabf35-d6f6-4aea-9760-107b7ad2856d",
   CellTags->"PrimaryExamplesSection",
   CellID->1676403356]}
 }
*)
(*CellTagsIndex
CellTagsIndex->{
 {"PrimaryExamplesSection", 222058, 5902}
 }
*)
(*NotebookFileOutline
Notebook[{
Cell[586, 21, 5464, 131, 70, "AnchorBarGrid",ExpressionUUID->"e7899d56-d079-4be8-8f63-7ec7adf33a7d",
 CellID->1],
Cell[CellGroupData[{
Cell[6075, 156, 171, 6, 70, "ObjectNameGrid",ExpressionUUID->"4f1e743d-c9d6-487e-92ef-50a080b54190"],
Cell[6249, 164, 859, 27, 70, "Usage",ExpressionUUID->"8bdb1c5f-c753-4e88-9d17-b991a1bfdddc",
 CellID->982511436]
}, Open  ]],
Cell[CellGroupData[{
Cell[7145, 196, 642, 19, 70, "NotesSection",ExpressionUUID->"d2545fca-07fe-41d9-a4d1-f326dcfe54b6",
 CellGroupingRules->{"SectionGrouping", 50},
 CellID->1971639738],
Cell[7790, 217, 31, 0, 70, "SectionHeaderSpacer",ExpressionUUID->"498cd68f-5f68-453f-9c4d-1ae9ca5bb661"],
Cell[7824, 219, 265, 8, 70, "Notes",ExpressionUUID->"621f130a-794d-4dd5-bdd5-f74f5e394ea6",
 CellID->924159584],
Cell[8092, 229, 836, 30, 70, "Notes",ExpressionUUID->"9efa2197-a480-4143-bd3e-336619378b93",
 CellID->1990679746],
Cell[8931, 261, 2289, 70, 70, "2ColumnTableMod",ExpressionUUID->"51f511ab-dd74-4f7b-abf3-07264dc25dbe",
 CellID->2028755750],
Cell[11223, 333, 548, 17, 70, "Notes",ExpressionUUID->"e9b36776-1457-437d-a272-38268cfea09a",
 CellID->37393551],
Cell[11774, 352, 179, 5, 70, "Notes",ExpressionUUID->"98a98c35-bd89-4995-8556-4f4d4479af67",
 CellID->1605903337],
Cell[11956, 359, 237, 6, 70, "Notes",ExpressionUUID->"1c6123df-d19d-4b10-8783-b3f8b97c55ad",
 CellID->178674951],
Cell[12196, 367, 179, 5, 70, "Notes",ExpressionUUID->"53b2b1f5-ac0a-4f69-81c0-2eb27dce0535",
 CellID->255599014],
Cell[12378, 374, 46, 1, 70, "Notes",ExpressionUUID->"54d28419-2ef5-4261-8273-a0514398a681",
 CellID->1067943069],
Cell[12427, 377, 2845, 71, 70, "3ColumnTableMod",ExpressionUUID->"baf30ab5-1f99-4635-b33e-677c9634267d",
 CellID->1917123225],
Cell[15275, 450, 252, 8, 70, "Notes",ExpressionUUID->"c7f47189-d346-4f52-be7b-0fecb228f6d7",
 CellID->956015342],
Cell[15530, 460, 1184, 27, 70, "3ColumnTableMod",ExpressionUUID->"02490889-4d62-4f31-ae76-72c2cc51cbbf",
 CellID->1566765895],
Cell[16717, 489, 1053, 19, 70, "Notes",ExpressionUUID->"9362b9e2-3e30-485e-8c90-03d90a190219",
 CellID->128330510],
Cell[17773, 510, 421, 9, 70, "Notes",ExpressionUUID->"6f79e65a-78b6-4e51-8943-58ffe3cb0768",
 CellID->323180187],
Cell[18197, 521, 2143, 61, 70, "2ColumnTableMod",ExpressionUUID->"5df6b22d-acab-468f-ab20-bc997a65448d",
 CellID->1854789889],
Cell[20343, 584, 255, 5, 70, "Notes",ExpressionUUID->"2fdce960-9ed5-4338-b5ab-c90dbd732b05",
 CellID->700200527],
Cell[20601, 591, 156, 5, 70, "Notes",ExpressionUUID->"29a2252f-3e86-4105-8c88-fd7393b5999a",
 CellID->633941708],
Cell[20760, 598, 829, 19, 70, "2ColumnTableMod",ExpressionUUID->"8de52fe2-f027-4d5d-b457-435785d1ab4f",
 CellID->837998243],
Cell[21592, 619, 394, 13, 70, "Notes",ExpressionUUID->"44a366a1-79db-4503-b2a4-ca1f5c9cada8",
 CellID->1920663168],
Cell[21989, 634, 371, 14, 70, "Notes",ExpressionUUID->"6f72163f-0fff-49b4-8b5a-242e49f6ce55",
 CellID->991443164],
Cell[22363, 650, 31, 0, 70, "SectionFooterSpacer",ExpressionUUID->"c913eadc-f57f-474a-9f1e-523177117972"]
}, Closed]],
Cell[CellGroupData[{
Cell[22431, 655, 269, 10, 70, "PrimaryExamplesSection",ExpressionUUID->"89eabf35-d6f6-4aea-9760-107b7ad2856d",
 CellTags->"PrimaryExamplesSection",
 CellID->1676403356],
Cell[CellGroupData[{
Cell[22725, 669, 195, 6, 70, "ExampleSection",ExpressionUUID->"2becca4b-52bd-4a11-b812-93aae8c3319d",
 CellID->325755652],
Cell[22923, 677, 335, 12, 70, "ExampleText",ExpressionUUID->"85472dd4-c608-47f4-9666-2968c55016ee",
 CellID->1912593623],
Cell[CellGroupData[{
Cell[23283, 693, 468, 11, 70, "Input",ExpressionUUID->"38b00b8f-ad4c-43f1-8a6f-9ffc923972d3",
 CellID->133271135],
Cell[23754, 706, 85, 2, 70, "Output",ExpressionUUID->"9219ca1c-7b29-490d-861c-749a9dfeea4e",
 CellID->210866368]
}, Open  ]],
Cell[23854, 711, 278, 10, 70, "ExampleText",ExpressionUUID->"8ad898ef-a062-42b3-94e4-ab76b632fdf2",
 CellID->404399049],
Cell[CellGroupData[{
Cell[24157, 725, 272, 8, 70, "Input",ExpressionUUID->"75eda755-932a-494e-9371-e856618bbb49",
 CellID->1617847216],
Cell[24432, 735, 2789, 85, 70, "Output",ExpressionUUID->"3517686c-2d82-41f2-ac7e-d273131fb798",
 CellID->2003036261]
}, Open  ]],
Cell[27236, 823, 510, 17, 70, "ExampleText",ExpressionUUID->"06e799cb-0569-46fb-94ab-4758dc2918c3",
 CellID->1488703067],
Cell[CellGroupData[{
Cell[27771, 844, 126, 3, 70, "ExampleDelimiter",ExpressionUUID->"87ed36a0-013a-4ada-9165-2512ba415e83",
 CellID->1314178903],
Cell[CellGroupData[{
Cell[27922, 851, 468, 12, 70, "Input",ExpressionUUID->"7205c90e-aafc-442d-a541-92ada16d4e1e",
 CellID->1530433439],
Cell[28393, 865, 2972, 81, 70, "Output",ExpressionUUID->"7f99667a-c25e-426d-84de-0bb2599fb8d3",
 CellID->1920323709]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[31414, 952, 124, 3, 70, "ExampleDelimiter",ExpressionUUID->"8d0c2265-cd91-4a1a-8dc1-e3201e3ae384",
 CellID->80019424],
Cell[CellGroupData[{
Cell[31563, 959, 824, 22, 70, "Input",ExpressionUUID->"9821c3f7-a146-4de5-9514-470304cb808a",
 CellID->995987951],
Cell[32390, 983, 4759, 110, 70, "Output",ExpressionUUID->"d191d702-82e2-4236-b9fc-4b8453f8e940",
 CellID->1737701996]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[37198, 1099, 125, 3, 70, "ExampleDelimiter",ExpressionUUID->"ac725a3c-cee4-4551-9bc0-0371b0483e50",
 CellID->962783331],
Cell[37326, 1104, 238, 7, 70, "ExampleText",ExpressionUUID->"22c64e88-db83-4686-9b29-72cb6cce8248",
 CellID->1283129296],
Cell[CellGroupData[{
Cell[37589, 1115, 184, 5, 70, "Input",ExpressionUUID->"d109bb7d-3b47-40d2-9e8c-70f9ada560f4",
 CellID->36276483],
Cell[37776, 1122, 125, 3, 70, "Output",ExpressionUUID->"8cb29071-81c0-4f1e-9e80-f55e35f27f8c",
 CellID->268131607]
}, Open  ]],
Cell[CellGroupData[{
Cell[37938, 1130, 247, 7, 70, "Input",ExpressionUUID->"cba45a7c-a2b6-4af5-80a4-28fd13bbb016",
 CellID->1467962770],
Cell[38188, 1139, 1081, 31, 70, "Output",ExpressionUUID->"43aa1b7f-ad68-4bf6-80c9-4404a8e20d89",
 CellID->639750468]
}, Open  ]],
Cell[39284, 1173, 707, 22, 70, "ExampleText",ExpressionUUID->"b2db03b6-0174-47eb-97e2-f48549fcb18f",
 CellID->1308050109],
Cell[CellGroupData[{
Cell[40016, 1199, 788, 22, 70, "Input",ExpressionUUID->"893a016d-80a6-4063-bc1f-4149181f0ec4",
 CellID->1668268251],
Cell[40807, 1223, 6453, 141, 70, "Output",ExpressionUUID->"db6bc856-96ee-438d-8df3-98f43510f0b3",
 CellID->1068509038]
}, Open  ]],
Cell[47275, 1367, 148, 4, 70, "ExampleText",ExpressionUUID->"1c757742-f96a-4a64-81bb-629341d8a668",
 CellID->29711224],
Cell[CellGroupData[{
Cell[47448, 1375, 947, 27, 70, "Input",ExpressionUUID->"283d3c14-62cd-4ee2-831f-32e15b4161ac",
 CellID->873180837],
Cell[48398, 1404, 6526, 143, 70, "Output",ExpressionUUID->"9582cefa-a212-48d9-affa-e77406b63730",
 CellID->1989203369]
}, Open  ]],
Cell[54939, 1550, 163, 5, 70, "ExampleText",ExpressionUUID->"986bc921-b6d0-40f0-87a3-f80deca39f5a",
 CellID->905425084],
Cell[CellGroupData[{
Cell[55127, 1559, 950, 27, 70, "Input",ExpressionUUID->"8728fe3c-5bee-4c2d-9029-0543f1f3a5bc",
 CellID->1958277478],
Cell[56080, 1588, 6324, 139, 70, "Output",ExpressionUUID->"cdd142ed-2beb-49f4-8cd4-6a97e98605fe",
 CellID->1169714093]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[62453, 1733, 126, 3, 70, "ExampleDelimiter",ExpressionUUID->"761d41b8-8cfb-4eb7-bb06-0f36d57d0d35",
 CellID->2052281161],
Cell[62582, 1738, 122, 3, 70, "ExampleText",ExpressionUUID->"e674d838-1b8f-42ce-8bab-51c356ffea27",
 CellID->54428597],
Cell[CellGroupData[{
Cell[62729, 1745, 1346, 38, 70, "Input",ExpressionUUID->"e105f3d6-15c5-4107-b6ae-5b0efbcbc79c",
 CellID->1126111909],
Cell[64078, 1785, 8888, 181, 70, "Output",ExpressionUUID->"b9a55bad-bbf7-45aa-a84a-4df564ac8c5d",
 CellID->85427334]
}, Open  ]],
Cell[72981, 1969, 141, 4, 70, "ExampleText",ExpressionUUID->"bf541a0e-95a5-4104-92a3-d5d73552c6d1",
 CellID->1049835416],
Cell[CellGroupData[{
Cell[73147, 1977, 2010, 53, 70, "Input",ExpressionUUID->"9234a8c9-7e4c-4259-9d1d-4e0b644aa8db",
 CellID->402317813],
Cell[75160, 2032, 8850, 180, 70, "Output",ExpressionUUID->"76077560-76f6-4042-834b-ad262a92dbb2",
 CellID->496783226]
}, Open  ]],
Cell[84025, 2215, 157, 4, 70, "ExampleText",ExpressionUUID->"fa042f4d-6bc0-40e7-bad4-b9efeec0760d",
 CellID->1116149821],
Cell[CellGroupData[{
Cell[84207, 2223, 2052, 54, 70, "Input",ExpressionUUID->"6780884d-b456-40bc-bc80-3bc1b0ec6910",
 CellID->3218086],
Cell[86262, 2279, 9013, 183, 70, "Output",ExpressionUUID->"2a1a9423-c994-4fe3-8e29-a5c9f6a0947c",
 CellID->1165692795]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[95336, 2469, 187, 6, 70, "ExampleSection",ExpressionUUID->"b7e2f0ef-8470-4195-b790-9c3fb3cb95d5",
 CellID->1293636265],
Cell[95526, 2477, 257, 5, 70, "ExampleText",ExpressionUUID->"f957aba4-c899-4eb7-a2b5-4a66ddc47dee",
 CellID->1995082805],
Cell[CellGroupData[{
Cell[95808, 2486, 309, 8, 70, "Input",ExpressionUUID->"9cb89ead-092f-42bc-95d7-a37a2ad746bc",
 CellID->1727420408],
Cell[96120, 2496, 1679, 44, 70, "Output",ExpressionUUID->"e848657a-62b6-48b4-bfe5-a17591a9fa9e",
 CellID->969876993]
}, Open  ]],
Cell[97814, 2543, 358, 11, 70, "ExampleText",ExpressionUUID->"c35ced6f-60dd-421e-ae89-6231297d22d0",
 CellID->1784098739],
Cell[98175, 2556, 718, 23, 70, "Input",ExpressionUUID->"20fa5e4d-55fd-48f0-87eb-99615dd00f39",
 CellID->1872692722],
Cell[98896, 2581, 81, 1, 70, "ExampleText",ExpressionUUID->"d81daa21-b766-4c94-8b19-76a5807c71dc",
 CellID->612503584],
Cell[CellGroupData[{
Cell[99002, 2586, 118, 3, 70, "Input",ExpressionUUID->"3a7998f4-ddc6-46ec-a3ca-2bdd0f3f85a2",
 CellID->713162879],
Cell[99123, 2591, 2374, 71, 70, "Output",ExpressionUUID->"c50c21c8-1c7e-438d-869e-2466f4ed09ee",
 CellID->1321740621]
}, Open  ]],
Cell[101512, 2665, 138, 4, 70, "ExampleText",ExpressionUUID->"30b9e135-b164-494b-b923-2dde3f56b647",
 CellID->414983949],
Cell[CellGroupData[{
Cell[101675, 2673, 157, 5, 70, "Input",ExpressionUUID->"525197fa-ef10-405c-855c-5b7edfb0806e",
 CellID->958470616],
Cell[101835, 2680, 2563, 77, 70, "Output",ExpressionUUID->"a8404610-8275-4e48-8cec-ceb2408cfbad",
 CellID->923772579]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[104447, 2763, 189, 6, 70, "ExampleSection",ExpressionUUID->"48578ae4-9196-43fa-9de5-7972ad491bad",
 CellID->2061341341],
Cell[CellGroupData[{
Cell[104661, 2773, 205, 6, 70, "ExampleSubsection",ExpressionUUID->"88f46881-a1bb-4061-875a-8320c40b8116",
 CellID->1757724783],
Cell[104869, 2781, 535, 17, 70, "ExampleText",ExpressionUUID->"49c942b0-2024-4671-a887-bdf4ba78c7e1",
 CellID->1268678943],
Cell[CellGroupData[{
Cell[105429, 2802, 1194, 30, 70, "Input",ExpressionUUID->"0ec2e8f6-c129-426c-866a-80e4577a3f91",
 CellID->532886137],
Cell[106626, 2834, 6651, 176, 70, "Output",ExpressionUUID->"f7fff552-2eee-4380-b72c-8cd014ec1448",
 CellID->234672469]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[113326, 3016, 203, 6, 70, "ExampleSubsection",ExpressionUUID->"b8f587c3-2725-4140-a2e5-9ecfbef5c6e3",
 CellID->166498975],
Cell[CellGroupData[{
Cell[113554, 3026, 1029, 27, 70, "Input",ExpressionUUID->"74f35242-699a-4461-9386-7504eca1b3c6",
 CellID->1769743483],
Cell[114586, 3055, 11901, 306, 70, "Output",ExpressionUUID->"7abeae0a-3c6b-420c-8afb-d8a9bed5dbd8",
 CellID->1859385844]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[126536, 3367, 203, 6, 70, "ExampleSubsection",ExpressionUUID->"ebfb1663-cfd8-4645-98d5-4fe67646b1d4",
 CellID->1688597095],
Cell[126742, 3375, 604, 19, 70, "ExampleText",ExpressionUUID->"aab94bb4-9cbd-40d2-b92d-d19583f47fcb",
 CellID->1376607065],
Cell[CellGroupData[{
Cell[127371, 3398, 808, 22, 70, "Input",ExpressionUUID->"8b13865c-83bb-4495-96f8-0b40af908d4c",
 CellID->695241421],
Cell[128182, 3422, 2815, 78, 70, "Output",ExpressionUUID->"9dd5715c-6a58-4362-bf1e-6fea209ce337",
 CellID->1014062251]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[131046, 3506, 201, 6, 70, "ExampleSubsection",ExpressionUUID->"c88984e2-1bf9-48fa-b12e-3a2eaa43a71a",
 CellID->1020562723],
Cell[131250, 3514, 199, 4, 70, "ExampleText",ExpressionUUID->"f88c6241-c612-4b85-b43c-6489c94fbc96",
 CellID->1678722922],
Cell[131452, 3520, 1362, 37, 70, "Input",ExpressionUUID->"8eff2593-fb4a-4a89-b9a1-d4bcf316563f",
 CellID->425114609]
}, Closed]],
Cell[CellGroupData[{
Cell[132851, 3562, 208, 6, 70, "ExampleSubsection",ExpressionUUID->"1829e0ed-369c-4a5b-af3e-ed66060f1681",
 CellID->854869796],
Cell[133062, 3570, 144, 4, 70, "ExampleText",ExpressionUUID->"d7aa10d1-a7b7-400b-a13b-a22ede31b967",
 CellID->1974495011],
Cell[CellGroupData[{
Cell[133231, 3578, 559, 18, 70, "Input",ExpressionUUID->"ccd32997-ffd5-49b5-b2a0-a8bbedbdb28c",
 CellID->272852786],
Cell[133793, 3598, 4844, 140, 70, "Output",ExpressionUUID->"bf2b528c-a649-4598-8a28-fb6aa3d95929",
 CellID->911939435]
}, Open  ]],
Cell[138652, 3741, 465, 12, 70, "ExampleText",ExpressionUUID->"63d0f7a4-90a0-44d8-b6ec-86afe4bf9b69",
 CellID->1233617734],
Cell[CellGroupData[{
Cell[139142, 3757, 709, 20, 70, "Input",ExpressionUUID->"cff419af-f053-4f23-849c-b240ae82ae2e",
 CellID->1852596485],
Cell[139854, 3779, 5213, 146, 70, "Output",ExpressionUUID->"2fed02ba-dbf4-4138-a7f5-03fe9975325b",
 CellID->1300369125]
}, Open  ]],
Cell[145082, 3928, 246, 6, 70, "ExampleText",ExpressionUUID->"bf8221f4-06a6-49a7-b2f5-46270f10ea53",
 CellID->971695640]
}, Closed]],
Cell[CellGroupData[{
Cell[145365, 3939, 205, 6, 70, "ExampleSubsection",ExpressionUUID->"ef64eeac-e4bb-46cc-a758-84015dd61ef9",
 CellID->1131062942],
Cell[145573, 3947, 144, 4, 70, "ExampleText",ExpressionUUID->"4d4ef0b2-110c-496c-ae39-9c13a28f2f16",
 CellID->1151418045],
Cell[CellGroupData[{
Cell[145742, 3955, 559, 18, 70, "Input",ExpressionUUID->"b2aaab95-c852-44eb-8d7f-6fcb272c96a8",
 CellID->907939198],
Cell[146304, 3975, 4844, 140, 70, "Output",ExpressionUUID->"3fc044ea-ef72-4fc1-bfb5-97e2d4891f89",
 CellID->249104515]
}, Open  ]],
Cell[151163, 4118, 759, 21, 70, "ExampleText",ExpressionUUID->"07642840-e4bc-4583-b0d9-d8b0429cc507",
 CellID->229062906],
Cell[CellGroupData[{
Cell[151947, 4143, 940, 25, 70, "Input",ExpressionUUID->"7b1d1fbe-4d3d-4148-9b5f-9113b8b6f41b",
 CellID->88304206],
Cell[152890, 4170, 5216, 147, 70, "Output",ExpressionUUID->"83638b38-602d-4f05-8f27-2a820c5a9462",
 CellID->680349636]
}, Open  ]]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[158167, 4324, 235, 8, 70, "ExampleSection",ExpressionUUID->"80ff1e4f-5bd5-4d56-9744-f00a0977a757",
 CellID->422887447],
Cell[158405, 4334, 4227, 103, 70, "Input",ExpressionUUID->"ca79c79b-ec67-418e-9b33-f985aaaa174d",
 InitializationCell->False,
 CellID->284595376],
Cell[162635, 4439, 52441, 1227, 70, "Input",ExpressionUUID->"3192b5c0-4d33-4445-aa06-7b35bd51cc2b",
 InitializationCell->False,
 CellID->748402563]
}, Closed]],
Cell[215091, 5669, 31, 0, 70, "SectionFooterSpacer",ExpressionUUID->"05c0f7b8-5613-4b5f-ae87-ae43edc58a4d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[215159, 5674, 150, 7, 70, "SeeAlsoSection",ExpressionUUID->"d6e9920e-6a80-486f-ab92-b3cb25120b36",
 CellID->1255426704],
Cell[215312, 5683, 3860, 120, 70, "SeeAlso",ExpressionUUID->"fff172c2-1052-4b43-9e22-c4c258ca3a78",
 CellID->929782353]
}, Open  ]],
Cell[CellGroupData[{
Cell[219209, 5808, 152, 7, 70, "TutorialsSection",ExpressionUUID->"fa76f58b-4e0f-4f1d-a1ff-9eb1922a3c6d",
 CellID->250839057],
Cell[219364, 5817, 31, 0, 70, "SectionHeaderSpacer",ExpressionUUID->"8cf9f6f7-060b-49e5-96c0-57df6f550024"],
Cell[219398, 5819, 204, 7, 70, "Tutorials",ExpressionUUID->"24499b76-c238-40b1-a1e9-3e24b7810486",
 CellID->131883350],
Cell[219605, 5828, 31, 0, 70, "SectionFooterSpacer",ExpressionUUID->"b9724206-d107-47b6-965a-4bfe4e28c74a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[219673, 5833, 156, 7, 70, "MoreAboutSection",ExpressionUUID->"a8539395-8b2b-4995-94ac-f392befd003d",
 CellID->38303248],
Cell[219832, 5842, 31, 0, 70, "SectionHeaderSpacer",ExpressionUUID->"e20f4154-2cce-40ff-8a3d-75a0fac2c76d"],
Cell[219866, 5844, 208, 7, 70, "MoreAbout",ExpressionUUID->"fe5df3fd-897f-4fd2-9852-95031b7a961a",
 CellID->1039426961]
}, Open  ]],
Cell[220089, 5854, 23, 0, 70, "FooterCell",ExpressionUUID->"acb06d2f-bbb8-473c-86b3-64d353885e49"]
}
]
*)

(* End of internal cache information *)
